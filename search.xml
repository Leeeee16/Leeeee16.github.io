<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å‰‘æŒ‡Offer16-æ•°å€¼çš„æ•´æ•°æ¬¡æ–¹</title>
      <link href="/2022/06/07/%E5%89%91%E6%8C%87Offer16-%E6%95%B0%E5%80%BC%E7%9A%84%E6%95%B4%E6%95%B0%E6%AC%A1%E6%96%B9/"/>
      <url>/2022/06/07/%E5%89%91%E6%8C%87Offer16-%E6%95%B0%E5%80%BC%E7%9A%84%E6%95%B4%E6%95%B0%E6%AC%A1%E6%96%B9/</url>
      
        <content type="html"><![CDATA[<h4 id="å‰‘æŒ‡-Offer-16-æ•°å€¼çš„æ•´æ•°æ¬¡æ–¹"><a href="https://leetcode.cn/problems/shu-zhi-de-zheng-shu-ci-fang-lcof/">å‰‘æŒ‡ Offer 16. æ•°å€¼çš„æ•´æ•°æ¬¡æ–¹</a></h4><p>å®ç° <a href="https://www.cplusplus.com/reference/valarray/pow/">pow(<em>x</em>, <em>n</em>)</a> ï¼Œå³è®¡ç®— x çš„ n æ¬¡å¹‚å‡½æ•°ï¼ˆå³ï¼Œxnï¼‰ã€‚ä¸å¾—ä½¿ç”¨åº“å‡½æ•°ï¼ŒåŒæ—¶ä¸éœ€è¦è€ƒè™‘å¤§æ•°é—®é¢˜ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong><br>è¾“å…¥ï¼šx = 2.00000, n = 10<br>è¾“å‡ºï¼š1024.00000</p><hr><p>æ€è·¯å‚è€ƒé¢˜è§£ï¼š<a href="https://leetcode.cn/problems/shu-zhi-de-zheng-shu-ci-fang-lcof/solution/mian-shi-ti-16-shu-zhi-de-zheng-shu-ci-fang-kuai-s/">https://leetcode.cn/problems/shu-zhi-de-zheng-shu-ci-fang-lcof/solution/mian-shi-ti-16-shu-zhi-de-zheng-shu-ci-fang-kuai-s/</a></p><p>æ€è·¯æ˜¯ä½¿ç”¨å¿«é€Ÿå¹‚ã€‚ç®€å•æ¥è¯´å°±æ˜¯å°†æŒ‡æ•°æ”¹å†™ä¸ºäºŒè¿›åˆ¶ã€‚ç„¶åé€šè¿‡å¾ªç¯å¤åˆ¶<code>x *= x</code>ï¼Œåœ¨æŒ‡æ•°äºŒè¿›åˆ¶ä¸º1çš„ä½ç½®ï¼Œå°†ç»“æœä¹˜ä¸Šxå³<code>res *= x</code>ã€‚è¯¦ç»†çš„æè¿°å¯ä»¥çœ‹å‚è€ƒé¢˜è§£ã€‚</p><p>å¯¹äºæŒ‡æ•°ä¸ºè´Ÿæ•°çš„å¤„ç†ï¼Œå¦‚æœæŒ‡æ•°ä¸ºè´Ÿæ•°ï¼Œ<code>x = 1 / x</code>å¹¶å°†æŒ‡æ•°å†è®¾ç½®ä¸ºæ­£æ•°å³å¯ã€‚æ¯”å¦‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">2^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>å¯ä»¥è½¬åŒ–ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mo stretchy="false">)</mo><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">(\frac12)^1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">myPow</span><span class="params">(<span class="type">double</span> x, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="number">0</span> || x == <span class="number">1</span>) <span class="keyword">return</span> x;</span><br><span class="line">        <span class="type">long</span> <span class="variable">nn</span> <span class="operator">=</span> n;</span><br><span class="line">        <span class="keyword">if</span> (n &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            x = <span class="number">1</span> / x;</span><br><span class="line">            nn = -nn;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">double</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">1.0</span>;</span><br><span class="line">        <span class="keyword">while</span> (nn &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> ((nn &amp; <span class="number">1</span>) == <span class="number">1</span>) &#123;</span><br><span class="line">                res *= x;</span><br><span class="line">            &#125;</span><br><span class="line">            x *= x;</span><br><span class="line">            nn &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
            <tag> æ•°å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCode236-äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ</title>
      <link href="/2022/06/06/LeetCode236-%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88/"/>
      <url>/2022/06/06/LeetCode236-%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88/</url>
      
        <content type="html"><![CDATA[<h4 id="236-äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ"><a href="https://leetcode.cn/problems/lowest-common-ancestor-of-a-binary-tree/">236. äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ</a></h4><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘, æ‰¾åˆ°è¯¥æ ‘ä¸­ä¸¤ä¸ªæŒ‡å®šèŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆã€‚</p><p>ç™¾åº¦ç™¾ç§‘ä¸­æœ€è¿‘å…¬å…±ç¥–å…ˆçš„å®šä¹‰ä¸ºï¼šâ€œå¯¹äºæœ‰æ ¹æ ‘ T çš„ä¸¤ä¸ªèŠ‚ç‚¹ pã€qï¼Œæœ€è¿‘å…¬å…±ç¥–å…ˆè¡¨ç¤ºä¸ºä¸€ä¸ªèŠ‚ç‚¹ xï¼Œæ»¡è¶³ x æ˜¯ pã€q çš„ç¥–å…ˆä¸” x çš„æ·±åº¦å°½å¯èƒ½å¤§ï¼ˆä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿå¯ä»¥æ˜¯å®ƒè‡ªå·±çš„ç¥–å…ˆï¼‰ã€‚â€</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://lqy-blog-pic.oss-cn-shanghai.aliyuncs.com/blogImg/LeetCode236-binarytree.png" alt=""></p><p>è¾“å…¥ï¼šroot = [3,5,1,6,2,0,8,null,null,7,4], p = 5, q = 1<br>è¾“å‡ºï¼š3<br>è§£é‡Šï¼šèŠ‚ç‚¹ 5 å’ŒèŠ‚ç‚¹ 1 çš„æœ€è¿‘å…¬å…±ç¥–å…ˆæ˜¯èŠ‚ç‚¹ 3 ã€‚</p><hr><p>æ€è·¯ï¼šå¦‚æœrootä¸ºpå’Œqçš„æœ€è¿‘å…¬å…±ç¥–å…ˆï¼Œåˆ™ä¸€å…±æœ‰ä¸‰ç§æƒ…å†µï¼š</p><ol><li><code>p</code>å’Œ<code>q</code>åœ¨<code>root</code>çš„ä¸¤ä¾§</li><li><code>p = root</code>ï¼Œä¸”<code>q</code>åœ¨<code>root</code>çš„å·¦å­æ ‘æˆ–è€…å³å­æ ‘ä¸­ï¼›</li><li><code>q = root</code>ï¼Œä¸”<code>p</code>åœ¨<code>root</code>çš„å·¦å­æ ‘æˆ–è€…å³å­æ ‘ä¸­ï¼›</li></ol><p>è€ƒè™‘ä½¿ç”¨å…ˆåºéå†ï¼Œé‡åˆ°pæˆ–è€…qæ—¶è¿”å›ã€‚ä»ä¸‹å¾€ä¸Šå›æº¯ï¼Œå½“på’Œqåœ¨rootå¼‚ä¾§æ—¶ï¼Œè¿”å›rootã€‚</p><p>è¯¦è§ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * public class TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     TreeNode left;</span></span><br><span class="line"><span class="comment"> *     TreeNode right;</span></span><br><span class="line"><span class="comment"> *     TreeNode(int x) &#123; val = x; &#125;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> TreeNode <span class="title function_">lowestCommonAncestor</span><span class="params">(TreeNode root, TreeNode p, TreeNode q)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">null</span> || root == p || root == q) &#123;</span><br><span class="line">            <span class="keyword">return</span> root;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">left</span> <span class="operator">=</span> lowestCommonAncestor(root.left, p, q);</span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">right</span> <span class="operator">=</span> lowestCommonAncestor(root.right, p, q);</span><br><span class="line">        <span class="comment">// på’Œqåœ¨rootä¸¤ä¾§ï¼Œåˆ™æœ€è¿‘å…¬å…±ç¥–å…ˆä¸ºroot</span></span><br><span class="line">        <span class="keyword">if</span> (left != <span class="literal">null</span> &amp;&amp; right != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> root;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// på’Œqåœ¨rootå³å­æ ‘ï¼Œåˆ™æœ€è¿‘å…¬å…±ç¥–å…ˆä¸ºright</span></span><br><span class="line">        <span class="keyword">if</span> (left == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> right;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> left;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‚è€ƒé¢˜è§£ï¼š<a href="https://leetcode.cn/problems/lowest-common-ancestor-of-a-binary-tree/solution/236-er-cha-shu-de-zui-jin-gong-gong-zu-xian-hou-xu/">https://leetcode.cn/problems/lowest-common-ancestor-of-a-binary-tree/solution/236-er-cha-shu-de-zui-jin-gong-gong-zu-xian-hou-xu/</a></p>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
            <tag> äºŒå‰æ ‘ </tag>
            
            <tag> å‰‘æŒ‡Offer </tag>
            
            <tag> é€’å½’ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰‘æŒ‡Offer54-äºŒå‰æœç´¢æ ‘çš„ç¬¬kå¤§èŠ‚ç‚¹</title>
      <link href="/2022/06/04/%E5%89%91%E6%8C%87Offer54-%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%E7%9A%84%E7%AC%ACk%E5%A4%A7%E8%8A%82%E7%82%B9/"/>
      <url>/2022/06/04/%E5%89%91%E6%8C%87Offer54-%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%E7%9A%84%E7%AC%ACk%E5%A4%A7%E8%8A%82%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h4 id="å‰‘æŒ‡-Offer-54-äºŒå‰æœç´¢æ ‘çš„ç¬¬kå¤§èŠ‚ç‚¹"><a href="https://leetcode.cn/problems/er-cha-sou-suo-shu-de-di-kda-jie-dian-lcof/">å‰‘æŒ‡ Offer 54. äºŒå‰æœç´¢æ ‘çš„ç¬¬kå¤§èŠ‚ç‚¹</a></h4><p>ç»™å®šä¸€æ£µäºŒå‰æœç´¢æ ‘ï¼Œè¯·æ‰¾å‡ºå…¶ä¸­ç¬¬ <code>k</code> å¤§çš„èŠ‚ç‚¹çš„å€¼ã€‚</p><hr><p>æ€è·¯ï¼šå¯¹äºäºŒå‰æœç´¢æ ‘ï¼Œ<strong>ä¸­åºéå†çš„å€’åº</strong>æ˜¯<strong>é€’å‡</strong>çš„ã€‚é¢˜ç›®ä¸­æ±‚ç¬¬Kæ‰“èŠ‚ç‚¹ï¼Œå¯ä»¥è½¬åŒ–ä¸ºä¸­åºéå†å€’åºçš„ç¬¬kä¸ªèŠ‚ç‚¹ã€‚</p><p>ä¸­åºéå†è¿‡ç¨‹ä¸­ï¼Œå¦‚æœâ€“kä¹‹åï¼Œkçš„å€¼ä¸º0ï¼Œåˆ™è¡¨ç¤ºéå†åˆ°ç¬¬kä¸ªèŠ‚ç‚¹äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * public class TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     TreeNode left;</span></span><br><span class="line"><span class="comment"> *     TreeNode right;</span></span><br><span class="line"><span class="comment"> *     TreeNode(int x) &#123; val = x; &#125;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> k;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> ans;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">kthLargest</span><span class="params">(TreeNode root, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.k = k;</span><br><span class="line">        dfs(root);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">dfs</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">null</span> || k == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        dfs(root.right);</span><br><span class="line">        <span class="comment">// å…ˆ--ï¼Œå†åˆ¤æ–­</span></span><br><span class="line">        <span class="keyword">if</span> (--k == <span class="number">0</span>) &#123;</span><br><span class="line">            ans = root.val;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        dfs(root.left);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
            <tag> å‰‘æŒ‡Offer </tag>
            
            <tag> äºŒå‰æœç´¢æ ‘ </tag>
            
            <tag> æ·±åº¦ä¼˜å…ˆéå† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCode113-è·¯å¾„æ€»å’ŒII</title>
      <link href="/2022/06/04/LeetCode113-%E8%B7%AF%E5%BE%84%E6%80%BB%E5%92%8CII/"/>
      <url>/2022/06/04/LeetCode113-%E8%B7%AF%E5%BE%84%E6%80%BB%E5%92%8CII/</url>
      
        <content type="html"><![CDATA[<h4 id="113-è·¯å¾„æ€»å’Œ-II"><a href="https://leetcode.cn/problems/path-sum-ii/">113. è·¯å¾„æ€»å’Œ II</a></h4><p>ç»™ä½ äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ root å’Œä¸€ä¸ªæ•´æ•°ç›®æ ‡å’Œ targetSum ï¼Œæ‰¾å‡ºæ‰€æœ‰ ä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹ è·¯å¾„æ€»å’Œç­‰äºç»™å®šç›®æ ‡å’Œçš„è·¯å¾„ã€‚</p><p>å¶å­èŠ‚ç‚¹ æ˜¯æŒ‡æ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p><img src="https://lqy-blog-pic.oss-cn-shanghai.aliyuncs.com/blogImg/LeetCode113.jpg" alt=""></p><p>è¾“å…¥ï¼šroot = [5,4,8,11,null,13,4,7,2,null,null,5,1], targetSum = 22<br>è¾“å‡ºï¼š[[5,4,11,2],[5,8,4,5]]</p><hr><p>æ€è·¯ï¼šå›æº¯æ€æƒ³+DFSå®ç°ï¼Œå› ä¸ºè¦è¿”å›æ‰€æœ‰çš„è·¯å¾„ï¼Œå› æ­¤ç”¨pathè®°å½•å½“å‰éå†çš„è·¯å¾„ã€‚å½“éå†åˆ°å¶èŠ‚ç‚¹å¹¶ä¸”èŠ‚ç‚¹çš„å€¼ç­‰äºtargetSumæ—¶ï¼Œå³æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„è·¯å¾„ã€‚</p><p>éå†æ—¶æ›´æ–°targetSumä¸º<code>targetSum - å½“å‰èŠ‚ç‚¹çš„value</code></p><p>æ³¨æ„å›æº¯æ—¶å°†è·¯å¾„pathä¸­æœ€åä¸€ä¸ªèŠ‚ç‚¹ç§»é™¤ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * public class TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     TreeNode left;</span></span><br><span class="line"><span class="comment"> *     TreeNode right;</span></span><br><span class="line"><span class="comment"> *     TreeNode() &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     TreeNode(int val) &#123; this.val = val; &#125;</span></span><br><span class="line"><span class="comment"> *     TreeNode(int val, TreeNode left, TreeNode right) &#123;</span></span><br><span class="line"><span class="comment"> *         this.val = val;</span></span><br><span class="line"><span class="comment"> *         this.left = left;</span></span><br><span class="line"><span class="comment"> *         this.right = right;</span></span><br><span class="line"><span class="comment"> *     &#125;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">pathSum</span><span class="params">(TreeNode root, <span class="type">int</span> targetSum)</span> &#123;</span><br><span class="line">        List&lt;List&lt;Integer&gt;&gt; ans = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;</span><br><span class="line">        Deque&lt;Integer&gt; path = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        dfs(root, ans, path, targetSum);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">dfs</span><span class="params">(TreeNode root, List&lt;List&lt;Integer&gt;&gt; ans, Deque&lt;Integer&gt; path, <span class="type">int</span> targetSum)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ‰¾åˆ°ä¸€æ¡ç¬¦åˆçš„è·¯å¾„</span></span><br><span class="line">        <span class="keyword">if</span> (root.left == <span class="literal">null</span> &amp;&amp; root.right == <span class="literal">null</span> &amp;&amp; root.val == targetSum) &#123;</span><br><span class="line">            path.addLast(root.val);</span><br><span class="line">            ans.add(<span class="keyword">new</span> <span class="title class_">ArrayList</span>(path));</span><br><span class="line">            path.removeLast();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        path.addLast(root.val);</span><br><span class="line">        dfs(root.left, ans, path, targetSum - root.val);</span><br><span class="line">        dfs(root.right, ans, path, targetSum - root.val);</span><br><span class="line">        <span class="comment">// å›æº¯</span></span><br><span class="line">        path.removeLast();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
            <tag> å›æº¯ </tag>
            
            <tag> äºŒå‰æ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCode79.å•è¯æœç´¢</title>
      <link href="/2022/06/03/LeetCode79-%E5%8D%95%E8%AF%8D%E6%90%9C%E7%B4%A2/"/>
      <url>/2022/06/03/LeetCode79-%E5%8D%95%E8%AF%8D%E6%90%9C%E7%B4%A2/</url>
      
        <content type="html"><![CDATA[<h4 id="79-å•è¯æœç´¢"><a href="https://leetcode.cn/problems/word-search/">79. å•è¯æœç´¢</a></h4><p>ç»™å®šä¸€ä¸ª m x n äºŒç»´å­—ç¬¦ç½‘æ ¼ board å’Œä¸€ä¸ªå­—ç¬¦ä¸²å•è¯ word ã€‚å¦‚æœ word å­˜åœ¨äºç½‘æ ¼ä¸­ï¼Œè¿”å› true ï¼›å¦åˆ™ï¼Œè¿”å› false ã€‚</p><p>å•è¯å¿…é¡»æŒ‰ç…§å­—æ¯é¡ºåºï¼Œé€šè¿‡ç›¸é‚»çš„å•å…ƒæ ¼å†…çš„å­—æ¯æ„æˆï¼Œå…¶ä¸­â€œç›¸é‚»â€å•å…ƒæ ¼æ˜¯é‚£äº›æ°´å¹³ç›¸é‚»æˆ–å‚ç›´ç›¸é‚»çš„å•å…ƒæ ¼ã€‚åŒä¸€ä¸ªå•å…ƒæ ¼å†…çš„å­—æ¯ä¸å…è®¸è¢«é‡å¤ä½¿ç”¨ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://lqy-blog-pic.oss-cn-shanghai.aliyuncs.com/blogImg/LeetCode-79.jpg" alt=""></p><p>è¾“å…¥ï¼šboard = [[â€œAâ€,â€œBâ€,â€œCâ€,â€œEâ€],[â€œSâ€,â€œFâ€,â€œCâ€,â€œSâ€],[â€œAâ€,â€œDâ€,â€œEâ€,â€œEâ€]], word = â€œABCCEDâ€<br>è¾“å‡ºï¼štrue</p><hr><p>æ€è·¯ï¼šé‡‡ç”¨æ·±åº¦ä¼˜å…ˆå’Œå›æº¯çš„æ€è·¯ã€‚æ˜¯ä¸€é“æ¯”è¾ƒå…¸å‹çš„å›æº¯é¢˜ã€‚</p><p>å®šä¹‰äº†ä¸€ä¸ªæ–¹å‘æ•°ç»„ç”¨äºæ·±åº¦éå†æ—¶ç¡®å®šæ–¹å‘ã€‚</p><p>å®šä¹‰visitedæ•°ç»„ç”¨äºè®°å½•å…ƒç´ æ˜¯å¦å·²ç»è®¿é—®è¿‡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">int</span>[] DIRECTIONS = <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;-<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> rows;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> cols;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> len;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">char</span>[][] board;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">char</span>[] toCharArray;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span>[][] visited;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">exist</span><span class="params">(<span class="type">char</span>[][] board, String word)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.rows = board.length;</span><br><span class="line">        <span class="keyword">if</span> (rows == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.cols = board[<span class="number">0</span>].length;</span><br><span class="line">        <span class="built_in">this</span>.board = board;</span><br><span class="line">        <span class="built_in">this</span>.len = word.length();</span><br><span class="line">        <span class="built_in">this</span>.visited = <span class="keyword">new</span> <span class="title class_">boolean</span>[rows][cols];</span><br><span class="line">        <span class="built_in">this</span>.toCharArray = word.toCharArray();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; rows; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; cols; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (dfs(i, j, <span class="number">0</span>)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">dfs</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> begin)</span> &#123;</span><br><span class="line">        <span class="comment">// é€€å‡ºæ¡ä»¶ï¼Œéå†åˆ°æœ€åä¸€ä¸ªå­—æ¯</span></span><br><span class="line">        <span class="keyword">if</span> (begin == len - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> toCharArray[begin] == board[x][y];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å½“å‰å­—æ¯ä¸å•è¯å¯¹åº”ä¸‹æ ‡çš„å­—æ¯ä¸€è‡´ï¼Œåˆ™ç»§ç»­å‘å››å‘¨æœç´¢</span></span><br><span class="line">        <span class="keyword">if</span> (toCharArray[begin] == board[x][y]) &#123;</span><br><span class="line">            visited[x][y] = <span class="literal">true</span>;</span><br><span class="line">            <span class="comment">// å‘å››å‘¨å¯»æ‰¾</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">newX</span> <span class="operator">=</span> x + DIRECTIONS[i];</span><br><span class="line">                <span class="type">int</span> <span class="variable">newY</span> <span class="operator">=</span> y + DIRECTIONS[i + <span class="number">1</span>];</span><br><span class="line">                <span class="comment">// æ–°åæ ‡åœ¨çŸ©é˜µèŒƒå›´å†…å¹¶ä¸”æ²¡æœ‰è®¿é—®è¿‡</span></span><br><span class="line">                <span class="keyword">if</span> (isInArea(newX, newY) &amp;&amp; !visited[newX][newY]) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (dfs(newX, newY, begin + <span class="number">1</span>)) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å›æº¯</span></span><br><span class="line">            visited[x][y] = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">isInArea</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x &gt;= <span class="number">0</span> &amp;&amp; x &lt; rows &amp;&amp; y &gt;= <span class="number">0</span> &amp;&amp; y &lt; cols;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
            <tag> å›æº¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰‘æŒ‡ Offer 52. ä¸¤ä¸ªé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…¬å…±èŠ‚ç‚¹</title>
      <link href="/2022/06/01/%E5%89%91%E6%8C%87%20Offer52-%E4%B8%A4%E4%B8%AA%E9%93%BE%E8%A1%A8%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%85%AC%E5%85%B1%E8%8A%82%E7%82%B9/"/>
      <url>/2022/06/01/%E5%89%91%E6%8C%87%20Offer52-%E4%B8%A4%E4%B8%AA%E9%93%BE%E8%A1%A8%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%85%AC%E5%85%B1%E8%8A%82%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h4 id="å‰‘æŒ‡-Offer-52-ä¸¤ä¸ªé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…¬å…±èŠ‚ç‚¹"><a href="https://leetcode.cn/problems/liang-ge-lian-biao-de-di-yi-ge-gong-gong-jie-dian-lcof/">å‰‘æŒ‡ Offer 52. ä¸¤ä¸ªé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…¬å…±èŠ‚ç‚¹</a></h4><p>è¾“å…¥ä¸¤ä¸ªé“¾è¡¨ï¼Œæ‰¾å‡ºå®ƒä»¬çš„ç¬¬ä¸€ä¸ªå…¬å…±èŠ‚ç‚¹ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://lqy-blog-pic.oss-cn-shanghai.aliyuncs.com/blogImg/LeetCode160.png" alt=""></p><p>è¾“å…¥ï¼šintersectVal = 8, listA = [4,1,8,4,5], listB = [5,0,1,8,4,5], skipA = 2, skipB = 3<br>è¾“å‡ºï¼šReference of the node with value = 8<br>è¾“å…¥è§£é‡Šï¼šç›¸äº¤èŠ‚ç‚¹çš„å€¼ä¸º 8 ï¼ˆæ³¨æ„ï¼Œå¦‚æœä¸¤ä¸ªåˆ—è¡¨ç›¸äº¤åˆ™ä¸èƒ½ä¸º 0ï¼‰ã€‚ä»å„è‡ªçš„è¡¨å¤´å¼€å§‹ç®—èµ·ï¼Œé“¾è¡¨ A ä¸º [4,1,8,4,5]ï¼Œé“¾è¡¨ B ä¸º [5,0,1,8,4,5]ã€‚åœ¨ A ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ 2 ä¸ªèŠ‚ç‚¹ï¼›åœ¨ B ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ 3 ä¸ªèŠ‚ç‚¹ã€‚</p><hr><p>æ€è·¯ï¼šå¦‚æœAä¸ºNullæˆ–è€…Bä¸ºNUllï¼Œåˆ™ä¸ä¼šç›¸äº¤ï¼›</p><p>å®šä¹‰ä¸¤ä¸ªæŒ‡é’ˆåˆ†åˆ«ä»Aå’ŒBå¼€å§‹åŒæ—¶å‘åèµ°ï¼Œå‡è®¾Aåˆ°ç›¸äº¤èŠ‚ç‚¹çš„è·ç¦»ä¸ºaï¼ˆç¤ºä¾‹ä¸­åˆ™ä¸º2ï¼‰ï¼ŒBåˆ°ç›¸äº¤èŠ‚ç‚¹çš„è·ç¦»ä¸ºbï¼ˆç¤ºä¾‹ä¸­åˆ™ä¸º3ï¼‰ï¼Œé‡åˆéƒ¨åˆ†é•¿åº¦ä¸ºcï¼ˆç¤ºä¾‹ä¸­åˆ™ä¸º3ï¼‰ã€‚</p><p>å¦‚æœæŒ‡é’ˆAå®Œï¼Œå³Aä¸ºNullåï¼Œç»§ç»­ä»Bå¼€å§‹å‘åéå†ï¼›åŒç†Bèµ°å®Œåä»Aç»§ç»­éå†ï¼›ä¸¤ä¸ªæŒ‡é’ˆç›¸é‡æ—¶ï¼Œå³åœ¨ç›¸äº¤èŠ‚ç‚¹ã€‚</p><p>ç›¸äº¤æ˜¯æŒ‡é’ˆAèµ°çš„è·ç¦»ä¸ºa+c+bï¼›æŒ‡é’ˆBèµ°çš„è·ç¦»ä¸ºb+c+aã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">getIntersectionNode</span><span class="params">(ListNode headA, ListNode headB)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (headA == <span class="literal">null</span> || headB == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">a</span> <span class="operator">=</span> headA;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">b</span> <span class="operator">=</span> headB;</span><br><span class="line">        <span class="keyword">while</span> (a != b) &#123;</span><br><span class="line">            a = a == <span class="literal">null</span> ? headB : a.next;</span><br><span class="line">            b = b == <span class="literal">null</span> ? headA : b.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://leetcode.cn/problems/liang-ge-lian-biao-de-di-yi-ge-gong-gong-jie-dian-lcof/solution/shuang-zhi-zhen-fa-lang-man-xiang-yu-by-ml-zimingm/">å‚è€ƒé¢˜è§£</a></p><blockquote><p>ä½ å˜æˆæˆ‘ï¼Œèµ°è¿‡æˆ‘èµ°è¿‡çš„è·¯ã€‚<br>æˆ‘å˜æˆä½ ï¼Œèµ°è¿‡ä½ èµ°è¿‡çš„è·¯ã€‚<br>ç„¶åæˆ‘ä»¬ä¾¿ç›¸é‡äº†â€¦        ğŸ˜„</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
            <tag> åŒæŒ‡é’ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCode3.æœ€é•¿ä¸å«é‡å¤å­—ç¬¦çš„å­å­—ç¬¦ä¸²</title>
      <link href="/2022/06/01/LeetCode3-%E6%9C%80%E9%95%BF%E4%B8%8D%E5%90%AB%E9%87%8D%E5%A4%8D%E5%AD%97%E7%AC%A6%E7%9A%84%E5%AD%90%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
      <url>/2022/06/01/LeetCode3-%E6%9C%80%E9%95%BF%E4%B8%8D%E5%90%AB%E9%87%8D%E5%A4%8D%E5%AD%97%E7%AC%A6%E7%9A%84%E5%AD%90%E5%AD%97%E7%AC%A6%E4%B8%B2/</url>
      
        <content type="html"><![CDATA[<h4 id="3-æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²"><a href="https://leetcode.cn/problems/longest-substring-without-repeating-characters/">3. æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²</a></h4><p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² <code>s</code> ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­ä¸å«æœ‰é‡å¤å­—ç¬¦çš„ <strong>æœ€é•¿å­ä¸²</strong> çš„é•¿åº¦ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><blockquote><p>è¾“å…¥: s = â€œabcabcbbâ€<br>è¾“å‡º: 3<br>è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ â€œabcâ€ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚</p></blockquote><p><strong>ç¤ºä¾‹ 2:</strong></p><blockquote><p>è¾“å…¥: s = â€œbbbbbâ€<br>è¾“å‡º: 1<br>è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ â€œbâ€ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 1ã€‚</p></blockquote><p><strong>ç¤ºä¾‹ 3:</strong></p><blockquote><p>è¾“å…¥: s = â€œpwwkewâ€<br>è¾“å‡º: 3<br>è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ â€œwkeâ€ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚<br>è¯·æ³¨æ„ï¼Œä½ çš„ç­”æ¡ˆå¿…é¡»æ˜¯ å­ä¸² çš„é•¿åº¦ï¼Œâ€œpwkeâ€ æ˜¯ä¸€ä¸ªå­åºåˆ—ï¼Œä¸æ˜¯å­ä¸²ã€‚</p></blockquote><p><strong>æç¤ºï¼š</strong></p><ul><li><code>0 &lt;= s.length &lt;= 5 * 104</code></li><li><code>s</code> ç”±è‹±æ–‡å­—æ¯ã€æ•°å­—ã€ç¬¦å·å’Œç©ºæ ¼ç»„æˆ</li></ul><hr><p>æ€è·¯ï¼šé‡‡ç”¨æ»‘åŠ¨çª—å£çš„æ€è·¯ï¼Œä¿è¯çª—å£å†…çš„å­—ç¬¦ä¸é‡å¤ã€‚é‡‡ç”¨HashMapè®°å½•å­—ç¬¦æœ€åä¸€æ¬¡å‡ºç°çš„ä¸‹æ ‡ã€‚å³æŒ‡é’ˆå‘å³éå†çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœé‡åˆ°é‡å¤å­—ç¬¦ï¼Œåˆ™æ›´æ–°å·¦æŒ‡é’ˆï¼Œè®°å½•å­—ç¬¦åœ¨mapä¸­çš„ä¸‹æ ‡ï¼Œå¹¶æ›´æ–°è¿”å›å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">lengthOfLongestSubstring</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> s.length();</span><br><span class="line">        <span class="keyword">if</span> (len == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        Map&lt;Character, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (map.containsKey(s.charAt(i))) &#123;</span><br><span class="line">                left = Math.max(left, map.get(s.charAt(i)) + <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ›´æ–°mapä¸­çš„ä¸‹æ ‡</span></span><br><span class="line">            map.put(s.charAt(i), i);</span><br><span class="line">            ans = Math.max(ans, i - left + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>13è¡Œä¸­ï¼ŒleftæŒ‡é’ˆéœ€è¦å–leftå’Œ<code>map.get(s.charAt(i)) + 1</code>çš„è¾ƒå¤§è€…ã€‚</p><p>æ¯”å¦‚ï¼š&quot;abba&quot;è¿™ä¸ªç”¨ä¾‹ï¼Œåœ¨iéå†åˆ°ç¬¬äºŒä¸ªbçš„æ—¶å€™ï¼Œleftå–2ã€‚iç»§ç»­å¾€åèµ°ï¼Œèµ°åˆ°ä¸‹ä¸€ä¸ªaçš„æ—¶å€™ï¼Œå¦‚æœåªå–<code>map.get(s.charAt(i)) + 1</code>ï¼Œleftåˆ™å¾€å‰é€€äº†ï¼Œå› æ­¤éœ€è¦å–ä¸¤è€…çš„è¾ƒå¤§è€…~</p><blockquote><p>è¿˜æœ‰ä¸€ä¸ª<a href="https://leetcode.cn/problems/zui-chang-bu-han-zhong-fu-zi-fu-de-zi-zi-fu-chuan-lcof/solution/mian-shi-ti-48-zui-chang-bu-han-zhong-fu-zi-fu-d-9/">åŠ¨æ€è§„åˆ’è§£</a>ï¼Œæ„Ÿè§‰æ²¡æœ‰æ»‘åŠ¨çª—å£çš„æ€è·¯å¥½ç†è§£ï¼Œå› æ­¤åªè®°å½•æ»‘åŠ¨çª—å£è§£</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
            <tag> æ»‘åŠ¨çª—å£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰‘æŒ‡Offer46-æŠŠæ•°å­—ç¿»è¯‘æˆå­—ç¬¦ä¸²</title>
      <link href="/2022/05/31/%E5%89%91%E6%8C%87Offer46-%E6%8A%8A%E6%95%B0%E5%AD%97%E7%BF%BB%E8%AF%91%E6%88%90%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
      <url>/2022/05/31/%E5%89%91%E6%8C%87Offer46-%E6%8A%8A%E6%95%B0%E5%AD%97%E7%BF%BB%E8%AF%91%E6%88%90%E5%AD%97%E7%AC%A6%E4%B8%B2/</url>
      
        <content type="html"><![CDATA[<h4 id="å‰‘æŒ‡-Offer-46-æŠŠæ•°å­—ç¿»è¯‘æˆå­—ç¬¦ä¸²"><a href="https://leetcode.cn/problems/ba-shu-zi-fan-yi-cheng-zi-fu-chuan-lcof/">å‰‘æŒ‡ Offer 46. æŠŠæ•°å­—ç¿»è¯‘æˆå­—ç¬¦ä¸²</a></h4><p>é¢˜ç›®ï¼šç»™å®šä¸€ä¸ªæ•°å­—ï¼Œæˆ‘ä»¬æŒ‰ç…§å¦‚ä¸‹è§„åˆ™æŠŠå®ƒç¿»è¯‘ä¸ºå­—ç¬¦ä¸²ï¼š0 ç¿»è¯‘æˆ â€œaâ€ ï¼Œ1 ç¿»è¯‘æˆ â€œbâ€ï¼Œâ€¦â€¦ï¼Œ11 ç¿»è¯‘æˆ â€œlâ€ï¼Œâ€¦â€¦ï¼Œ25 ç¿»è¯‘æˆ â€œzâ€ã€‚ä¸€ä¸ªæ•°å­—å¯èƒ½æœ‰å¤šä¸ªç¿»è¯‘ã€‚è¯·ç¼–ç¨‹å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥è®¡ç®—ä¸€ä¸ªæ•°å­—æœ‰å¤šå°‘ç§ä¸åŒçš„ç¿»è¯‘æ–¹æ³•ã€‚</p><p>æ ·ä¾‹ï¼š</p><blockquote><p>è¾“å…¥: 12258<br>è¾“å‡º: 5<br>è§£é‡Š: 12258æœ‰5ç§ä¸åŒçš„ç¿»è¯‘ï¼Œåˆ†åˆ«æ˜¯&quot;bccfi&quot;, â€œbwfiâ€, â€œbcziâ€, â€œmcfi&quot;å’Œ&quot;mziâ€</p><p>å…¶ä¸­ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>â‰¤</mo><mi>n</mi><mi>u</mi><mi>m</mi><mo>&lt;</mo><msup><mn>2</mn><mn>31</mn></msup></mrow><annotation encoding="application/x-tex">0 \leq num &lt; 2^{31}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">31</span></span></span></span></span></span></span></span></span></span></span></span></p></blockquote><p>æ€è·¯ï¼šåŠ¨æ€è§„åˆ’é¢˜çš„æ ¸å¿ƒæ˜¯æ‰¾åˆ°çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼Œä»¥åŠå®šä¹‰å¥½åˆå§‹çŠ¶æ€ã€‚</p><p>å®šä¹‰ï¼šdp[i]è¡¨ç¤ºç¬¬iä¸ªæ•°å­—ç»“å°¾çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆè½¬ç§»æ–¹ç¨‹æœ‰ä¸¤ç§æƒ…å†µï¼š</p><ol><li>å½“<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">x_{i-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>ä¸¤ä¸ªæ•°å­—å¯ä»¥è¢«ç¿»è¯‘ï¼Œå³åœ¨[10, 25]åŒºé—´å†…ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo>+</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>2</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i] = dp[i - 1] + dp[i - 2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">]</span></span></span></span></li><li>å½“<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">x_{i-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>ä¸¤ä¸ªæ•°å­—ä¸èƒ½è¢«ç¿»è¯‘ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i] = dp[i - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></li></ol><p>å¯ä»¥çœ‹åˆ°dp[i]çš„å€¼ä»…å’Œå‰ä¸¤ä¸ªdpå€¼æœ‰å…³ï¼Œå› æ­¤å¯ä»¥ä¼˜åŒ–ç©ºé—´æ•°ç»„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">translateNum</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> String.valueOf(num);</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> str.length();</span><br><span class="line">        <span class="keyword">if</span> (n &lt; <span class="number">2</span>) <span class="keyword">return</span> n;</span><br><span class="line">        <span class="type">char</span>[] c = str.toCharArray();</span><br><span class="line">        <span class="type">int</span> <span class="variable">dp1</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">dp2</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> (c[i - <span class="number">2</span>] - <span class="string">&#x27;0&#x27;</span>) * <span class="number">10</span> + (c[i - <span class="number">1</span>] - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">            ans = <span class="number">10</span> &lt;= a &amp;&amp; a &lt;= <span class="number">25</span> ? dp1 + dp2 : dp2;</span><br><span class="line">            dp1 = dp2;</span><br><span class="line">            dp2 = ans;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
            <tag> åŠ¨æ€è§„åˆ’ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RedisåŸºç¡€</title>
      <link href="/2021/04/10/Redis%E5%9F%BA%E7%A1%80/"/>
      <url>/2021/04/10/Redis%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h4 id="Redis">Redis</h4><blockquote><p>é¢ç»æ•´ç†ï¼Œä¸»è¦æ˜¯ç†è®ºçŸ¥è¯†</p></blockquote><h5 id="RedisåŸºæœ¬æ•°æ®ç±»å‹">RedisåŸºæœ¬æ•°æ®ç±»å‹</h5><p>keyæ˜¯å­—ç¬¦ä¸²ï¼Œvalueæ˜¯5ç§ï¼šStringã€Listã€Hashã€Setã€Zset</p><p><strong>String</strong>ï¼šæ˜¯SDS(Simple Dynamic String)ï¼ŒåŠ¨æ€å­—ç¬¦ä¸²ï¼Œå¯ä¿®æ”¹ï¼Œæœ€é•¿512Mã€‚</p><blockquote><p>æ‰©å±•ï¼šä¸ºä»€ä¹ˆä¸ç”¨cè¯­è¨€çš„å­—ç¬¦ä¸²ï¼ŸRediså¦‚ä½•è§£å†³</p><ul><li><p>å¤šå¢åŠ äº†å­—ç¬¦ä¸²é•¿åº¦å±æ€§lenï¼šcè¯­éŸ³ä¸­çš„å­—ç¬¦ä¸²æœ«å°¾æœ‰â€™\0â€™ï¼Œå¹¶ä¸”è·å–é•¿åº¦æ˜¯O(N)çº§åˆ«çš„ã€‚SDSåªéœ€O(1)</p></li><li><p>è‡ªåŠ¨æ‰©å±•ç©ºé—´ï¼šç”±äºå­—ç¬¦ä¸²ç»å¸¸ä¼šè¿›è¡Œæ‹¼æ¥æ“ä½œï¼Œæ‰€ä»¥æ²¡æœ‰æå–è·å–é•¿åº¦ï¼Œå¯èƒ½ä¼šé€ æˆç¼“å­˜åŒºæº¢å‡ºã€‚å½“ SDS éœ€è¦å¯¹å­—ç¬¦ä¸²è¿›è¡Œä¿®æ”¹æ—¶ï¼Œé¦–å…ˆå€ŸåŠ©äº <code>len</code> å’Œ <code>alloc</code> æ£€æŸ¥ç©ºé—´æ˜¯å¦æ»¡è¶³ä¿®æ”¹æ‰€éœ€çš„è¦æ±‚ï¼Œå¦‚æœç©ºé—´ä¸å¤Ÿçš„è¯ï¼ŒSDS ä¼šè‡ªåŠ¨æ‰©å±•ç©ºé—´ï¼Œé¿å…äº†åƒ C å­—ç¬¦ä¸²æ“ä½œä¸­çš„è¦†ç›–æƒ…å†µï¼›</p></li><li><p>æœ‰æ•ˆé™ä½å†…å­˜åˆ†é…æ¬¡æ•°ï¼šSDSä¼˜åŒ–äº†ä¿®æ”¹å­—ç¬¦ä¸²å¸¦æ¥çš„å†…å­˜é‡åˆ†é…çš„æ¬¡æ•°ï¼Œé‡‡ç”¨<strong>ç©ºé—´é¢„åˆ†é…(ä¼šåˆ†é…å¤šä½™çš„freeç©ºé—´)å’Œæƒ°æ€§ç©ºé—´é‡Šæ”¾(ç¼©å‡å­—ç¬¦ä¸²åä¸ä¼šé©¬ä¸Šé‡Šæ”¾ç©ºé—´)</strong></p></li><li><p>äºŒè¿›åˆ¶å®‰å…¨ï¼šå› ä¸ºå­˜äº†é•¿åº¦ï¼Œä¸ç”¨å»åˆ¤æ–­ç©ºå­—ç¬¦<code>\0</code></p></li></ul></blockquote><p><strong>List</strong>ï¼šç›¸å½“äºJavaçš„LinkedListï¼Œæ’å…¥åˆ é™¤O(1)ï¼Œç´¢å¼•å®šä½O(n)</p><p>â€‹lrangeï¼šè¾“å‡ºlistæŒ‡å®šèŒƒå›´çš„å…ƒç´ <code>lrange mylist 0 -1</code></p><p><strong>Hash</strong>ï¼šæ•°ç»„+é“¾è¡¨ è§£å†³å“ˆå¸Œå†²çªï¼Œå®é™…ä¸Šå­—å…¸ç»“æ„å†…éƒ¨åŒ…å«ä¸¤ä¸ªHashTableï¼Œç”¨äºæ‰©å®¹æ—¶çš„<strong>æ¸è¿›å¼æ¬è¿</strong>ã€‚å½“hashè¡¨ä¸­çš„<strong>å…ƒç´ ä¸ªæ•°ç­‰äºç¬¬ä¸€ä½æ•°ç»„çš„é•¿åº¦</strong>æ—¶ï¼Œæ‰©å®¹ä¸ºåŸæ•°ç»„çš„ä¸¤å€ã€‚å¦‚æœRedisæ­£åœ¨åš <code>bgsave(æŒä¹…åŒ–å‘½ä»¤)</code>ï¼Œä¸ºäº†å‡å°‘å†…å­˜ä¹Ÿå¾—è¿‡å¤šåˆ†ç¦»ï¼ŒRedis å°½é‡ä¸å»æ‰©å®¹ï¼Œä½†æ˜¯å¦‚æœ hash è¡¨éå¸¸æ»¡äº†ï¼Œ<strong>è¾¾åˆ°äº†ç¬¬ä¸€ç»´æ•°ç»„é•¿åº¦çš„ 5 å€äº†</strong>ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼š <strong>å¼ºåˆ¶æ‰©å®¹</strong>ã€‚</p><p>å½“ hash è¡¨å› ä¸ºå…ƒç´ é€æ¸è¢«åˆ é™¤å˜å¾—è¶Šæ¥è¶Šç¨€ç–æ—¶ï¼ŒRedis ä¼šå¯¹ hash è¡¨è¿›è¡Œç¼©å®¹æ¥å‡å°‘ hash è¡¨çš„ç¬¬ä¸€ç»´æ•°ç»„ç©ºé—´å ç”¨ã€‚æ‰€ç”¨çš„æ¡ä»¶æ˜¯ <strong>å…ƒç´ ä¸ªæ•°ä½äºæ•°ç»„é•¿åº¦çš„ 10%</strong>ï¼Œç¼©å®¹ä¸ä¼šè€ƒè™‘ Redis æ˜¯å¦åœ¨åš <code>bgsave</code>ã€‚</p><blockquote><p><strong>æ¸è¿›å¼rehash</strong>ï¼šå¤§å­—å…¸æ‰©å®¹éœ€è¦ç”³è¯·æ–°æ•°ç»„ï¼Œå¹¶å°†åŸæ•°ç»„æ‰€æœ‰å…ƒç´ é‡æ–°æŒ‚æ¥åˆ°æ–°æ•°ç»„ä¸­ï¼Œç”±äºå•çº¿ç¨‹ï¼Œæ‰€ä»¥é‡‡ç”¨æ¸è¿›å¼rehashï¼Œè¿™ä¼šåœ¨rehashçš„è¿‡ç¨‹ä¸­ï¼Œä¿ç•™æ–°æ—§ä¸¤ä¸ªhashç»“æ„ï¼ŒæŸ¥è¯¢æ—¶åŒæ—¶æŸ¥ä¸¤ä¸ªï¼Œå½“å…¨éƒ¨è¿ç§»å®Œæˆåï¼Œä½¿ç”¨æ–°çš„hashç»“æ„å–è€Œä»£ä¹‹</p></blockquote><p><strong>Set</strong>ï¼šæ— åºã€å”¯ä¸€ã€‚</p><h5 id="Redisçš„zsetçš„åº•å±‚æ•°æ®ç»“æ„ï¼Ÿ">Redisçš„zsetçš„åº•å±‚æ•°æ®ç»“æ„ï¼Ÿ</h5><p>zsetï¼šå”¯ä¸€æ€§ï¼Œå¹¶ä¸ºæ¯ä¸ªvalueèµ‹äºˆä¸€ä¸ªscoreå€¼ï¼Œä»£è¡¨æ’åºæƒé‡</p><p>è·³è·ƒè¡¨ï¼šæœ‰åºåˆ—è¡¨zsetçš„æ•°æ®ç»“æ„ï¼Œé“¾è¡¨æŒ‰ç…§scoreæ’åºï¼Œé“¾è¡¨åˆ†å±‚ï¼Œä¸Šå±‚çš„é“¾è¡¨æ ‘çº¦ä¸ºä¸‹å±‚çš„1/2ï¼ŒæŸ¥è¯¢çš„æ—¶å€™ä»ä¸Šå±‚å¼€å§‹æŸ¥ï¼ŒæŸ¥è¯¢æ•ˆç‡O(logN)</p><blockquote><p>ä¸ºä»€ä¹ˆä¸ç”¨çº¢é»‘æ ‘/å¹³è¡¡æ ‘ï¼Ÿæ€§èƒ½å’Œå®ç°è€ƒè™‘</p></blockquote><p>æ’å…¥èŠ‚ç‚¹ï¼Œæ ¹æ®éšæœºç®—æ³•æ¥åˆ†é…åˆç†çš„å±‚æ•°ï¼Œä»æœŸæœ›ä¸Šæ¥çœ‹ï¼Œ50%çš„æ¦‚ç‡è¢«åˆ†åˆ°ç¬¬ä¸€å±‚ï¼Œ25%çš„æ¦‚ç‡è¢«åˆ†åˆ°ç¬¬äºŒå±‚ï¼Œ1/4ç¬¬ä¸‰å±‚â€¦</p><p>è·³è¡¨é»˜è®¤æœ€å¤§çš„å±‚æ•°ä¸º32å±‚</p><p>æ’å…¥çš„å¤§è‡´æµç¨‹ï¼šå£°æ˜å­˜å‚¨å˜é‡ã€æœç´¢å½“å‰èŠ‚ç‚¹æ’å…¥çš„ä½ç½®ã€ç”Ÿæˆæ’å…¥èŠ‚ç‚¹ã€é‡æ’å‰å‘æŒ‡é’ˆã€é‡æ’åå‘æŒ‡é’ˆå¹¶è¿”å›</p><img src="https://mmbiz.qpic.cn/mmbiz_png/ia1kbU3RS1H5ZLiaicqeR9mzkQuQLwvtFfQ5qUqf8c0vC3bfbc710Tz6iadcOlDYb39pApOUP9pCaUDQtuicUn9Jibvg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡" style="zoom:50%;" /><img src="https://mmbiz.qpic.cn/mmbiz_png/ia1kbU3RS1H5ZLiaicqeR9mzkQuQLwvtFfQclc3x7f7KuQtUMpfn1rP3I7mGVuOyydQjyhujAgTzo9z8XiacD0oJmA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡" style="zoom:50%;" /><p>å…ƒç´ æ’åï¼šè·³è·ƒè¡¨åœ¨å‰å‘æŒ‡é’ˆä¸Šå¢åŠ äº†ä¸€ä¸ª<code>span</code>å±æ€§ï¼Œ<strong>ç”¨æ¥è¡¨ç¤ºä»å‰ä¸€ä¸ªèŠ‚ç‚¹æ²¿ç€å½“å‰å±‚çš„forwardæŒ‡é’ˆè·³åˆ°å½“å‰èŠ‚ç‚¹ä¸­é—´è·³è¿‡äº†å¤šå°‘èŠ‚ç‚¹</strong>ã€‚å› æ­¤å¯ä»¥æ²¿ç€æœç´¢è·¯å¾„ï¼Œå°†æ‰€æœ‰ç»è¿‡çš„èŠ‚ç‚¹çš„è·¨åº¦<code>span</code>å€¼åŠ èµ·æ¥å°±èƒ½å¾—åˆ°æœ€ç»ˆçš„<code>rank</code>å€¼</p><p>æ‰©å±•ï¼š</p><p>Bitmapï¼šå¸ƒéš†è¿‡æ»¤å™¨</p><p>HyperLogLogï¼šä¸ç²¾ç¡®çš„å»é‡è®¡æ•°åŠŸèƒ½ï¼Œé€‚åˆå¤§è§„æ¨¡å»é‡ç»Ÿè®¡</p><p>Geospatialï¼šä¿å­˜åœ°ç†ä½ç½®</p><p>pub/subï¼šè®¢é˜…åŠŸèƒ½ï¼Œç®€å•çš„æ¶ˆæ¯é˜Ÿåˆ—</p><p>Pipelineï¼šæ‰¹é‡æ‰§è¡Œä¸€ç»„æŒ‡ä»¤ï¼Œä¸€æ¬¡æ€§è¿”å›ç»“æœï¼Œå¯ä»¥å‡å°‘é¢‘ç¹çš„è¯·æ±‚åº”ç­”</p><p>Luaï¼šæ”¯æŒLuaè„šæœ¬æ‰§è¡Œä¸€ç³»åˆ—çš„åŠŸèƒ½ã€‚å…·æœ‰åŸå­æ€§</p><p>äº‹åŠ¡ï¼šåªä¿è¯ä¸²è¡Œæ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ä¿è¯å…¨éƒ¨æ‰§è¡Œï¼Œä½†æ‰§è¡Œå‘½ä»¤å¤±è´¥ä¸ä¼šå›æ»šï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œ</p><h5 id="Redis-å’Œ-Memcached-çš„åŒºåˆ«å’Œå…±åŒç‚¹">Redis å’Œ Memcached çš„åŒºåˆ«å’Œå…±åŒç‚¹</h5><p>MCï¼šå¤šçº¿ç¨‹å¼‚æ­¥IOï¼Œåªæ”¯æŒK-Vï¼Œæœ€å¤§å¤±æ•ˆæ—¶é—´30å¤©ï¼Œkeyå’Œvalueå¤§å°æœ‰é™åˆ¶</p><p>Redisï¼šå•çº¿ç¨‹ï¼Œé‡‡ç”¨éé˜»å¡çš„å¼‚æ­¥äº‹ä»¶å¤„ç†æœºåˆ¶ï¼Œé¿å…çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„ä»£ä»·ï¼›æ”¯æŒæŒä¹…åŒ–ï¼›æ”¯æŒ<strong>å¤šç§æ•°æ®ç»“æ„</strong>ï¼›ä¸»ä»åŒæ­¥æœºåˆ¶ã€é›†ç¾¤</p><h5 id="Rediså¦‚ä½•æ”¯æŒé«˜å¹¶å‘">Rediså¦‚ä½•æ”¯æŒé«˜å¹¶å‘</h5><p>ä¸»ä»æ¶æ„ + è¯»å†™åˆ†ç¦»</p><p>ä¸€ä¸»å¤šä»ï¼Œä¸»è´Ÿè´£å†™ï¼Œå¹¶è´Ÿè´£å°†æ•°æ®åŒæ­¥åˆ°å…¶ä»–slaveèŠ‚ç‚¹ä¸Šï¼Œä»è´Ÿè´£è¯»</p><h5 id="ä¸ºä»€ä¹ˆRedisç”¨å•çº¿ç¨‹è€Œä¸æ˜¯å¤šçº¿ç¨‹">ä¸ºä»€ä¹ˆRedisç”¨å•çº¿ç¨‹è€Œä¸æ˜¯å¤šçº¿ç¨‹</h5><p><a href="https://draveness.me/whys-the-design-redis-single-thread">https://draveness.me/whys-the-design-redis-single-thread</a></p><p>CPUä¸æ˜¯Redisçš„ç“¶é¢ˆï¼ŒRedisçš„ç“¶é¢ˆæ˜¯å†…å­˜å¤§å°å’Œç½‘ç»œå¸¦å®½ï¼Œæ•°æ®éƒ½åœ¨å†…å­˜ä¸­</p><p>å•çº¿ç¨‹å¸¦æ¥æ›´é«˜çš„å¯ç»´æŠ¤æ€§ï¼Œæ–¹ä¾¿å¼€å‘</p><p>å•çº¿ç¨‹ä¹Ÿå¯ä»¥å¹¶å‘å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ï¼ŒIOå¤šè·¯å¤ç”¨</p><blockquote><p>4.0åå¼•å…¥å¤šçº¿ç¨‹ï¼Ÿåªæ˜¯åœ¨éƒ¨åˆ†å‘½ä»¤ä¸Šå¼•å…¥(å¤šä¸ªéé˜»å¡çš„åˆ é™¤æ“ä½œ)ï¼Œåœ¨æ•´ä½“æ¶æ„ä¸Šè¿˜æ˜¯å•çº¿ç¨‹æ¨¡å‹</p></blockquote><h5 id="Redisçš„äº‹åŠ¡æ˜¯æ€ä¹ˆå®ç°çš„">Redisçš„äº‹åŠ¡æ˜¯æ€ä¹ˆå®ç°çš„</h5><p>redisäº‹åŠ¡æ˜¯é€šè¿‡multi,exec,discard,watch/unwatchæŒ‡ä»¤ç”¨æ¥æ“ä½œäº‹åŠ¡ã€‚</p><ul><li><p>mutilï¼šå¼€å¯äº‹åŠ¡ï¼Œæ­¤åæ‰€æœ‰çš„æ“ä½œå°†ä¼šæ·»åŠ åˆ°å½“å‰é“¾æ¥çš„äº‹åŠ¡â€œæ“ä½œé˜Ÿåˆ—â€ä¸­ã€‚</p></li><li><p>execï¼šæäº¤äº‹åŠ¡</p></li><li><p>discardï¼šå–æ¶ˆäº‹åŠ¡ï¼Œè®°ä½ï¼Œæ­¤æŒ‡ä»¤ä¸æ˜¯ä¸¥æ ¼æ„ä¹‰ä¸Šçš„â€œäº‹åŠ¡å›æ»šâ€ï¼Œåªæ˜¯è¡¨è¾¾äº†â€œäº‹åŠ¡æ“ä½œè¢«å–æ¶ˆâ€çš„è¯­ä¹‰ï¼Œå°†ä¼šå¯¼è‡´äº‹åŠ¡çš„æ“ä½œé˜Ÿåˆ—ä¸­çš„æ“ä½œä¸ä¼šè¢«æ‰§è¡Œï¼Œä¸”äº‹åŠ¡å…³é—­ã€‚</p></li><li><p>watch/unwatchï¼šâ€œè§‚å¯Ÿâ€ï¼Œè¢«watchçš„keyå¦‚æœè¢«å…¶ä»–å®¢æˆ·ç«¯ä¿®æ”¹ï¼Œä¼šdiscardï¼›äº‹åŠ¡æ‰§è¡ŒæˆåŠŸæˆ–discardä¼šå¯¼è‡´è¢«watchçš„keyå˜ä¸ºunwatch</p><blockquote><p>è¿™é‡Œçš„watchå…¶å®å®ç°äº†ä¸€ä¸ªCASä¹è§‚é”ï¼Œåªæœ‰è¢«watchçš„keyæ²¡æœ‰æ”¹å˜æ—¶ï¼Œæ‰ä¼šexecæ‰§è¡Œäº‹åŠ¡</p></blockquote></li></ul><p>åŸç†ï¼šEXECæŒ‡ä»¤å°†ä¼šè§¦å‘äº‹åŠ¡ä¸­æ‰€æœ‰çš„æ“ä½œè¢«<strong>å†™å…¥AOFæ–‡ä»¶</strong>ï¼ˆå¦‚æœå¼€å¯äº†AOFï¼‰ï¼Œç„¶åå¼€å§‹åœ¨å†…å­˜ä¸­å®æ–½è¿™äº›æ•°æ®å˜æ›´æ“ä½œ<br>å¦‚æœåœ¨EXECæŒ‡ä»¤è¢«<strong>æäº¤ä¹‹å‰</strong>ï¼ŒRedis-serverå³æ£€æµ‹åˆ°æäº¤çš„æŸä¸ªæŒ‡ä»¤å­˜åœ¨<strong>è¯­æ³•é”™è¯¯</strong>ï¼Œé‚£ä¹ˆæ­¤äº‹åŠ¡å°†ä¼šè¢«æå‰æ ‡è®°<strong>DISCARD</strong>ï¼Œæ­¤åäº‹åŠ¡æäº¤ä¹Ÿå°†<strong>ç›´æ¥è¢«é©³å›</strong>ï¼›ä½†æ˜¯å¦‚æœåœ¨<strong>EXECæäº¤å</strong>ï¼Œåœ¨å®æ–½æ•°æ®å˜æ›´æ—¶ï¼ˆRediså°†ä¸ä¼šé¢„æ£€æµ‹æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚ä½ å¯¹ä¸€ä¸ªâ€œéæ•°å­—â€ç±»å‹çš„keyæ‰§è¡ŒINCRæ“ä½œï¼‰ï¼ŒæŸä¸ªæ“ä½œå¯¼è‡´äº†<strong>ERROR</strong>ï¼Œé‚£ä¹ˆredisä»ç„¶<strong>ä¸ä¼šå›æ»š</strong>æ­¤å‰<strong>å·²ç»æ‰§è¡ŒæˆåŠŸçš„æ“ä½œ</strong>ï¼Œè€Œä¸”ä¹Ÿä¸ä¼šä¸­æ–­ERRORä¹‹åçš„å…¶ä»–æ“ä½œ<strong>ç»§ç»­æ‰§è¡Œ</strong>ã€‚</p><p>å¯¹äºå¼€å‘è€…è€Œè¨€ï¼Œä½ åŠ¡å¿…å…³æ³¨äº‹åŠ¡æ‰§è¡Œåè¿”å›çš„ç»“æœï¼ˆç»“æœå°†æ˜¯ä¸€ä¸ªé›†åˆï¼ŒæŒ‰ç…§æ“ä½œæäº¤çš„é¡ºåºæ’åˆ—ï¼Œå¯¹äºæ‰§è¡Œå¤±è´¥çš„æ“ä½œï¼Œç»“æœå°†æ˜¯ä¸€ä¸ªERRORï¼‰ã€‚</p><h5 id="ç¼“å­˜çš„æ›´æ–°æ–¹å¼">ç¼“å­˜çš„æ›´æ–°æ–¹å¼</h5><p>å¯ä»¥åœ¨æ›´æ–°å®ŒDBåç›´æ¥æ›´æ–°ç¼“å­˜ï¼›è®¾ç½®å¤±æ•ˆæ—¶é—´ï¼Œå¯ä»¥çœ‹åšæ•°æ®ä¸ä¸€è‡´çš„æœ€å¤§å®¹å¿æ—¶é—´ï¼Œå¯ä»¥åœ¨keyå¤±æ•ˆæ—¶è¯·æ±‚æ•°æ®æºè·å–æ–°æ•°æ®ï¼Œé‡ç½®å¤±æ•ˆæ—¶é—´ï¼›å¤±æ•ˆæ—¶ï¼Œå¼‚æ­¥æ›´æ–°ï¼Œé˜²æ­¢æ•°æ®æºæ›´æ–°æ—¶å‡ºé”™</p><h5 id="ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜">ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜</h5><ol><li><p>å…ˆåˆ é™¤ç¼“å­˜ï¼Œåæ›´æ–°æ•°æ®åº“</p><p>å¦‚æœåˆ é™¤ç¼“å­˜åï¼Œæ›´æ–°æ•°æ®åº“çš„è¿‡ç¨‹ä¸­ï¼Œæœ‰çº¿ç¨‹è¿›è¡Œè¯»ï¼Œç¼“å­˜è¢«åˆ äº†ï¼Œè¯»æ•°æ®åº“ï¼Œè¯»åˆ°æ—§æ•°æ®ï¼Œå†™å…¥ç¼“å­˜ï¼Œä¸ä¸€è‡´</p><p>è§£å†³ï¼šå»¶æ—¶åŒåˆ ï¼šæ›´æ–°æ•°æ®åº“çš„çº¿ç¨‹åœ¨æ›´æ–°å®Œåï¼Œsleepä¸€æ®µæ—¶é—´ï¼Œç„¶åå†åˆ é™¤ä¸€æ¬¡ç¼“å­˜</p></li><li><p>å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜</p><p>å¦‚æœæ›´æ–°æˆåŠŸï¼Œç¼“å­˜åˆ é™¤å¤±è´¥ï¼Œä¸ä¸€è‡´</p><p>è§£å†³ï¼šé€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ï¼Œåˆ©ç”¨æ¶ˆæ¯é˜Ÿåˆ—çš„é‡è¯•æœºåˆ¶ï¼Œä¿è¯æ¶ˆæ¯çš„<strong>æœ€ç»ˆä¸€è‡´æ€§</strong></p></li><li><p>å…¶ä»–ï¼šè®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´ã€‚</p></li></ol><h5 id="å¦‚æœåœ¨æ›´æ–°Redisæ—¶æœåŠ¡å™¨å®•æœºï¼Œæ€ä¹ˆåŠï¼Ÿ">å¦‚æœåœ¨æ›´æ–°Redisæ—¶æœåŠ¡å™¨å®•æœºï¼Œæ€ä¹ˆåŠï¼Ÿ</h5><p>æŒä¹…åŒ–ã€ä¸»ä»ã€</p><h5 id="Redisçš„éƒ¨ç½²æ¶æ„æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ">Redisçš„éƒ¨ç½²æ¶æ„æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</h5><p>å•æœºã€ä¸»ä»ã€é›†ç¾¤</p><h5 id="Rediså†…å­˜æ·˜æ±°æœºåˆ¶ã€å‡ ç§æ·˜æ±°ç­–ç•¥">Rediså†…å­˜æ·˜æ±°æœºåˆ¶ã€å‡ ç§æ·˜æ±°ç­–ç•¥</h5><p>è®¾ç½®æœ‰æ•ˆæœŸ</p><p>åˆ é™¤è¿‡æœŸé”®çš„ç­–ç•¥ï¼šå®šæ—¶åˆ é™¤ã€æƒ°æ€§åˆ é™¤ã€å®šæ—¶æ‰«æ</p><ul><li><strong>å®šæ—¶åˆ é™¤</strong> ï¼šä¸ºæ¯ä¸ªé”®è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œä¸€æ—¦è¿‡æœŸæ—¶é—´åˆ°äº†ï¼Œåˆ™å°†é”®åˆ é™¤ã€‚è¿™ç§ç­–ç•¥å¯¹å†…å­˜å¾ˆå‹å¥½ï¼Œä½†æ˜¯å¯¹ <code>CPU</code> ä¸å‹å¥½ï¼Œå› ä¸ºæ¯ä¸ªå®šæ—¶å™¨éƒ½ä¼šå ç”¨ä¸€å®šçš„ <code>CPU</code> èµ„æºã€‚</li><li><strong>æƒ°æ€§åˆ é™¤</strong> ï¼šä¸ç®¡é”®æœ‰æ²¡æœ‰è¿‡æœŸéƒ½ä¸ä¸»åŠ¨åˆ é™¤ï¼Œç­‰åˆ°æ¯æ¬¡å»è·å–é”®æ—¶å†åˆ¤æ–­æ˜¯å¦è¿‡æœŸï¼Œå¦‚æœè¿‡æœŸå°±åˆ é™¤è¯¥é”®ï¼Œå¦åˆ™è¿”å›é”®å¯¹åº”çš„å€¼ã€‚è¿™ç§ç­–ç•¥å¯¹å†…å­˜ä¸å¤Ÿå‹å¥½ï¼Œå¯èƒ½ä¼šæµªè´¹å¾ˆå¤šå†…å­˜ã€‚</li><li><strong>å®šæœŸæ‰«æ</strong> ï¼šç³»ç»Ÿæ¯éš”ä¸€æ®µæ—¶é—´å°±å®šæœŸæ‰«æä¸€æ¬¡ï¼Œå‘ç°è¿‡æœŸçš„é”®å°±è¿›è¡Œåˆ é™¤ã€‚è¿™ç§ç­–ç•¥ç›¸å¯¹æ¥è¯´æ˜¯ä¸Šé¢ä¸¤ç§ç­–ç•¥çš„æŠ˜ä¸­æ–¹æ¡ˆï¼Œéœ€è¦æ³¨æ„çš„æ˜¯è¿™ä¸ªå®šæœŸçš„é¢‘ç‡è¦ç»“åˆå®é™…æƒ…å†µæŒæ§å¥½ï¼Œä½¿ç”¨è¿™ç§æ–¹æ¡ˆæœ‰ä¸€ä¸ªç¼ºé™·å°±æ˜¯å¯èƒ½ä¼šå‡ºç°å·²ç»è¿‡æœŸçš„é”®ä¹Ÿè¢«è¿”å›ã€‚</li></ul><p>æ·˜æ±°æ²¡è¿‡æœŸé”®çš„ç­–ç•¥</p><table><thead><tr><th style="text-align:left">æ·˜æ±°ç­–ç•¥</th><th style="text-align:left">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left">volatile-lru</td><td style="text-align:left">æ ¹æ® LRU ç®—æ³•åˆ é™¤è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ï¼Œç›´åˆ°è…¾å‡ºå¯ç”¨ç©ºé—´ã€‚å¦‚æœæ²¡æœ‰å¯åˆ é™¤çš„é”®å¯¹è±¡ï¼Œä¸”å†…å­˜è¿˜æ˜¯ä¸å¤Ÿç”¨æ—¶ï¼Œåˆ™æŠ¥é”™</td></tr><tr><td style="text-align:left">allkeys-lru</td><td style="text-align:left">æ ¹æ® LRU ç®—æ³•åˆ é™¤æ‰€æœ‰çš„é”®ï¼Œç›´åˆ°è…¾å‡ºå¯ç”¨ç©ºé—´ã€‚å¦‚æœæ²¡æœ‰å¯åˆ é™¤çš„é”®å¯¹è±¡ï¼Œä¸”å†…å­˜è¿˜æ˜¯ä¸å¤Ÿç”¨æ—¶ï¼Œåˆ™æŠ¥é”™</td></tr><tr><td style="text-align:left">volatile-lfu</td><td style="text-align:left">æ ¹æ® LFU ç®—æ³•åˆ é™¤è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ï¼Œç›´åˆ°è…¾å‡ºå¯ç”¨ç©ºé—´ã€‚å¦‚æœæ²¡æœ‰å¯åˆ é™¤çš„é”®å¯¹è±¡ï¼Œä¸”å†…å­˜è¿˜æ˜¯ä¸å¤Ÿç”¨æ—¶ï¼Œåˆ™æŠ¥é”™</td></tr><tr><td style="text-align:left">allkeys-lfu</td><td style="text-align:left">æ ¹æ® LFU ç®—æ³•åˆ é™¤æ‰€æœ‰çš„é”®ï¼Œç›´åˆ°è…¾å‡ºå¯ç”¨ç©ºé—´ã€‚å¦‚æœæ²¡æœ‰å¯åˆ é™¤çš„é”®å¯¹è±¡ï¼Œä¸”å†…å­˜è¿˜æ˜¯ä¸å¤Ÿç”¨æ—¶ï¼Œåˆ™æŠ¥é”™</td></tr><tr><td style="text-align:left">volatile-random</td><td style="text-align:left">éšæœºåˆ é™¤è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ï¼Œç›´åˆ°è…¾å‡ºå¯ç”¨ç©ºé—´ã€‚å¦‚æœæ²¡æœ‰å¯åˆ é™¤çš„é”®å¯¹è±¡ï¼Œä¸”å†…å­˜è¿˜æ˜¯ä¸å¤Ÿç”¨æ—¶ï¼Œåˆ™æŠ¥é”™</td></tr><tr><td style="text-align:left">allkeys-random</td><td style="text-align:left">éšæœºåˆ é™¤æ‰€æœ‰é”®ï¼Œç›´åˆ°è…¾å‡ºå¯ç”¨ç©ºé—´ã€‚å¦‚æœæ²¡æœ‰å¯åˆ é™¤çš„é”®å¯¹è±¡ï¼Œä¸”å†…å­˜è¿˜æ˜¯ä¸å¤Ÿç”¨æ—¶ï¼Œåˆ™æŠ¥é”™</td></tr><tr><td style="text-align:left">volatile-ttl</td><td style="text-align:left">æ ¹æ®é”®å€¼å¯¹è±¡çš„ ttl å±æ€§ï¼Œ åˆ é™¤æœ€è¿‘å°†è¦è¿‡æœŸæ•°æ®ã€‚å¦‚æœæ²¡æœ‰ï¼Œåˆ™ç›´æ¥æŠ¥é”™</td></tr><tr><td style="text-align:left">noeviction</td><td style="text-align:left">é»˜è®¤ç­–ç•¥ï¼Œä¸ä½œä»»ä½•å¤„ç†ï¼Œç›´æ¥æŠ¥é”™</td></tr></tbody></table><blockquote><p>è¡ç”Ÿï¼šRediså¯¹LRUç®—æ³•çš„æ”¹è¿›ï¼Œè§£å†³ä¼ ç»ŸLRUçš„ä»€ä¹ˆç¼ºç‚¹ï¼Ÿæ€ä¹ˆæ”¹è¿›çš„ï¼ŸæŠ½æ ·åˆ é™¤</p></blockquote><p>Redisçƒ­åº¦æ•°æ®ç®¡ç†ï¼šLRUï¼šlruå±æ€§24ä½ã€å…¨å±€å±æ€§lru_clockï¼›LFUï¼šlruå±æ€§é«˜16ä½æ—¶é’Ÿä½8ä½é¢‘æ•°ã€é¢‘æ¬¡é€’å¢(éšæœºæ•°ã€æ¦‚ç‡på…¬å¼ã€å¯¹æ•°å› å­)ã€é¢‘æ¬¡é€’å‡(<code>lfu-decay-time</code>ã€è®¡ç®—å·®å€¼ã€é™¤ä»¥<code>lfu-decay-time</code>)</p><h5 id="Redisç¼“å­˜ç©¿é€å’Œç¼“å­˜é›ªå´©ï¼Ÿ">Redisç¼“å­˜ç©¿é€å’Œç¼“å­˜é›ªå´©ï¼Ÿ</h5><p><strong>ç¼“å­˜é›ªå´©</strong>ï¼šRedisä¸­çš„ç¼“å­˜å¤§é¢ç§¯å¤±æ•ˆï¼Œæ‰€æœ‰çš„æµé‡ç›´æ¥æ‰“åœ¨æ•°æ®åº“ä¸Šï¼Œæ•°æ®åº“äºšå†å±±å¤§å•Š</p><p>è§£å†³æ–¹æ¡ˆï¼šåœ¨å¾€Redisä¸­å­˜æ•°æ®çš„æ—¶å€™ï¼Œè®¾ç½®éšæœºçš„å¤±æ•ˆæ—¶é—´ï¼›æˆ–è€…è€ƒè™‘çƒ­ç‚¹æ•°æ®æ°¸ä¸å¤±æ•ˆï¼Œæœ‰æ›´æ–°æ“ä½œçš„æ—¶å€™æ›´æ–°ä¸€ä¸‹ç¼“å­˜</p><p><strong>ç¼“å­˜ç©¿é€</strong>ï¼šç¼“å­˜å’Œæ•°æ®åº“éƒ½æ²¡æœ‰çš„æ•°æ®ï¼Œè€ŒæŸä¸ªä¸è‰¯ç”¨æˆ·ä¸æ–­åœ°å‘èµ·è¯·æ±‚ï¼Œæ¯”å¦‚æ•°æ®åº“ä¸­çš„idéƒ½å¤§äº0ï¼Œæˆ‘ä¸€ç›´ç”¨å°äº0çš„idå»è¯·æ±‚ï¼Œæ¯æ¬¡éƒ½èƒ½é¿å¼€Redisï¼Œç›´æ¥æ‰“åœ¨æ•°æ®åº“ä¸Šï¼Œé€ æˆæ•°æ®åº“å‹åŠ›è¿‡å¤§</p><p>è§£å†³æ–¹æ¡ˆ1ï¼šåœ¨æ¥å£å±‚å¢åŠ æ ¡éªŒï¼Œå¦‚ç”¨æˆ·æƒé™æ ¡éªŒã€å‚æ•°æ ¡éªŒã€ä¸åˆæ³•çš„ç›´æ¥è¿”å›Nullç»™å‰ç«¯ã€‚æ¯”å¦‚idæ ¡éªŒid&lt;=0ç›´æ¥æ‹¦æˆªã€‚</p><p>è§£å†³æ–¹æ¡ˆ2ï¼šç¼“å­˜å’Œæ•°æ®åº“éƒ½å–ä¸åˆ°çš„keyï¼Œå¯ä»¥å°†å¯¹åº”keyçš„valueè®¾ç½®ä¸ºnullã€é”™è¯¯æç¤ºç­‰ï¼Œå…·ä½“çœ‹åœºæ™¯ï¼Œè®¾ç½®ä¸ªå¤±æ•ˆæ—¶é—´30ç§’ã€‚</p><p>è§£å†³æ–¹æ¡ˆ3ï¼š<strong>å¸ƒéš†è¿‡æ»¤å™¨</strong></p><p><strong>ç¼“å­˜å‡»ç©¿</strong>ï¼šæ˜¯æŒ‡æŸä¸ªçƒ­ç‚¹keyï¼Œä¸åœåœ°æ‰›ç€å¤§å¹¶å‘ï¼Œå½“è¿™ä¸ªkeyå¤±æ•ˆçš„ç¬é—´ï¼ŒæŒç»­çš„å¤§å¹¶å‘å°±ä¼šå‡»ç©¿ç¼“å­˜ï¼Œç›´æ¥è¯·æ±‚æ•°æ®åº“ã€‚</p><p>è§£å†³æ–¹æ¡ˆï¼šè®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸ä¸è¿‡æœŸï¼Œæ•°æ®æœ‰æ›´æ–°æ—¶ï¼ŒåŒæ—¶æ›´æ–°ç¼“å­˜å³å¯</p><p><strong>æ€»ç»“</strong>ï¼šä¸Šè¿°ä¸‰ä¸ªé—®é¢˜ï¼Œä¹‹å‰ï¼šRedisé«˜å¯ç”¨ï¼Œä¸»ä»+å“¨å…µï¼ŒRedisé›†ç¾¤ï¼Œé¿å…å…¨ç›˜å´©æºƒ</p><p>è‹¥è¿˜æ˜¯å‘ç”Ÿäº†ä¸Šè¿°é—®é¢˜ï¼Œé‡‡ç”¨æœ¬åœ°ç¼“å­˜ã€é™æµã€é™çº§ç­‰æ–¹æ³•ï¼Œé¿å…MySQLæŒ‚æ‰</p><p>å‘ç”Ÿé—®é¢˜ä¹‹åï¼ŒRedisæŒä¹…åŒ–RDB+AOFï¼Œä¸€æ—¦é‡å¯ï¼Œè‡ªåŠ¨ä»ç£ç›˜åŠ è½½æ•°æ®ï¼Œå¿«é€Ÿæ¢å¤ç¼“å­˜æ•°æ®</p><p>å“ªæ€•é™æµï¼Œä¹Ÿä¸èƒ½è®©æ•°æ®åº“æŒ‚æ‰ï¼Œå¯¹ç”¨æˆ·æ¥è¯´å¤šåˆ·å‡ æ¬¡è€Œå·²~</p><h5 id="å¸ƒéš†è¿‡æ»¤å™¨">å¸ƒéš†è¿‡æ»¤å™¨</h5><p>æ¦‚å¿µï¼šç”¨äºæ£€ç´¢ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨ä¸€ä¸ªé›†åˆä¸­ã€‚</p><p>åŸç†ï¼šå½“å…ƒç´ è¢«åŠ å…¥é›†åˆæ—¶ï¼Œé€šè¿‡kä¸ªæ•£åˆ—å‡½æ•°å°†è¿™ä¸ªå…ƒç´ æ˜ å°„æˆä¸€ä¸ªä½(bit)æ•°ç»„ä¸­çš„kä¸ªç‚¹ï¼ŒæŠŠä»–ä»¬ç½®æˆ1ã€‚æ£€ç´¢æ—¶ï¼Œåªè¦çœ‹å¯¹åº”çš„è¿™äº›ç‚¹æ˜¯å¦ä¸º1ï¼Œå°±å¤§æ¦‚ç‡çŸ¥é“è¯¥é›†åˆä¸­æ˜¯å¦æœ‰è¯¥å…ƒç´ ã€‚</p><p>ç¼ºç‚¹ï¼šæœ‰å¯èƒ½è¯¯åˆ¤ï¼Œå¯èƒ½å…ƒç´ ä¸åœ¨é›†åˆä¸­ï¼Œä½†kä¸ªbitä½éƒ½ä¸º1ï¼›åˆ é™¤å›°éš¾</p><h5 id="RedisæŒä¹…åŒ–çš„æ–¹å¼">RedisæŒä¹…åŒ–çš„æ–¹å¼</h5><p>ä¸¤ç§æŒä¹…åŒ–æ–¹å¼ï¼šRDBå’ŒAOF</p><h6 id="RDB"><strong>RDB</strong></h6><p>å¿«ç…§æ˜¯ä¸€æ¬¡å…¨é‡å¤‡ä»½ï¼Œå¿«ç…§ä½œä¸ºåŒ…å«æ•´ä¸ªæ•°æ®é›†çš„å•ä¸ª.rdbæ–‡ä»¶ç”Ÿæˆï¼Œå¿«ç…§æ˜¯å†…å­˜æ•°æ®çš„äºŒè¿›åˆ¶åºåˆ—åŒ–å½¢å¼ï¼Œåœ¨å­˜å‚¨ä¸Šéå¸¸ç´§å‡‘ã€‚</p><p>ä½¿ç”¨ç³»ç»Ÿå¤šè¿›ç¨‹<code>COW(Copy On Write)</code>æœºåˆ¶çš„<code>fork</code>å‡½æ•°ï¼Œäº§ç”Ÿä¸€ä¸ª<strong>å­è¿›ç¨‹</strong>ï¼Œ<strong>å­è¿›ç¨‹</strong>ä¼šæ‹·è´<strong>çˆ¶è¿›ç¨‹</strong>çš„éƒ¨åˆ†<strong>ä»£ç æ®µå’Œæ•°æ®æ®µ</strong>ï¼Œ<strong>å¿«ç…§æŒä¹…</strong>åŒ–å¯ä»¥å®Œå…¨ç”±<strong>å­è¿›ç¨‹</strong>å®Œæˆï¼Œ<strong>çˆ¶è¿›ç¨‹</strong>ç»§ç»­<strong>å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚</strong>ã€‚æ•°æ®æ®µç”±æ“ä½œç³»ç»Ÿçš„<strong>é¡µé¢</strong>ç»„åˆè€Œæˆï¼Œä¸»è¿›ç¨‹åœ¨å¯¹æŸä¸ªé¡µé¢è¿›è¡Œä¿®æ”¹æ—¶ï¼Œä¼šå¾—åˆ°è¯¥é¡µé¢çš„ä¸€ä»½å¤åˆ¶ï¼Œç„¶å<strong>åœ¨å¤åˆ¶é¡µä¸Šè¿›è¡Œä¿®æ”¹</strong>ï¼Œè€Œ<strong>å­è¿›ç¨‹</strong>ç›¸åº”çš„<strong>é¡µé¢æ˜¯æ²¡æœ‰å˜åŒ–</strong>çš„ï¼Œå­è¿›ç¨‹åªéœ€è¦éå†æ•°æ®è¿›è¡Œåºåˆ—åŒ–å†™ç£ç›˜å°±è¡Œäº†ã€‚</p><p><strong>è§¦å‘æœºåˆ¶</strong>ï¼šæ‰‹åŠ¨ã€è‡ªåŠ¨</p><p>è‡ªåŠ¨è§¦å‘ï¼š</p><ol><li>åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®è§¦å‘æ¡ä»¶</li></ol><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å½“åœ¨è§„å®šçš„æ—¶é—´å†…ï¼ŒRediså‘ç”Ÿäº†å†™æ“ä½œçš„ä¸ªæ•°æ»¡è¶³æ¡ä»¶ï¼Œä¼šè§¦å‘å‘ç”ŸBGSAVEå‘½ä»¤ã€‚</span></span><br><span class="line"><span class="comment"># save &lt;seconds&gt; &lt;changes&gt;</span></span><br><span class="line"><span class="comment"># å½“ç”¨æˆ·è®¾ç½®äº†å¤šä¸ªsaveçš„é€‰é¡¹é…ç½®ï¼Œåªè¦å…¶ä¸­ä»»ä¸€æ¡æ»¡è¶³ï¼ŒRediséƒ½ä¼šè§¦å‘ä¸€æ¬¡BGSAVEæ“ä½œ</span></span><br><span class="line"><span class="attr">save</span> <span class="string">900 1 </span></span><br><span class="line"><span class="attr">save</span> <span class="string">300 10 </span></span><br><span class="line"><span class="attr">save</span> <span class="string">60 10000</span></span><br><span class="line"><span class="comment"># ä»¥ä¸Šé…ç½®çš„å«ä¹‰ï¼š900ç§’ä¹‹å†…è‡³å°‘ä¸€æ¬¡å†™æ“ä½œã€300ç§’ä¹‹å†…è‡³å°‘å‘ç”Ÿ10æ¬¡å†™æ“ä½œã€</span></span><br><span class="line"><span class="comment"># 60ç§’ä¹‹å†…å‘ç”Ÿè‡³å°‘10000æ¬¡å†™æ“ä½œï¼Œåªè¦æ»¡è¶³ä»»ä¸€æ¡ä»¶ï¼Œå‡ä¼šè§¦å‘bgsave</span></span><br></pre></td></tr></table></figure><ol start="2"><li><p>æ‰§è¡Œshutdownå‘½ä»¤å…³é—­æœåŠ¡å™¨æ—¶ï¼Œå¦‚æœæ²¡æœ‰å¼€å¯AOFï¼Œåˆ™ä¼šè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡<code>bgsave</code></p></li><li><p>ä¸»ä»åŒæ­¥ï¼šmasteræ‰§è¡Œ<code>bgsave</code>ï¼Œå¹¶ç¼“å­˜è¯¥æ—¶é—´æ®µçš„å†™æ“ä½œï¼Œå°†rdbå‘é€ç»™slaveï¼ŒslaveåŒæ­¥æ•°æ®ï¼Œæœ€åmasterå‘æ‰€æœ‰slaveå‘é€ç¼“å­˜ä¸­çš„å†™æ“ä½œï¼Œå®ŒæˆåŒæ­¥</p></li></ol><p><strong>æ‰§è¡Œæµç¨‹</strong>ï¼šä½¿ç”¨æ“ä½œç³»ç»Ÿå¤šè¿›ç¨‹çš„COWæœºåˆ¶</p><ol><li>æ‰§è¡Œ<code>bgsave</code>æ—¶ï¼Œå…ˆçœ‹æœ‰ä¸æœ‰å­è¿›ç¨‹æ­£åœ¨æ‰§è¡ŒRDB/AOFæŒä¹…åŒ–ä»»åŠ¡ï¼Œæœ‰åˆ™è¿”å›</li><li>ä¸»è¿›ç¨‹<code>fork</code>ä¸€ä¸ªå­è¿›ç¨‹æ¥æ‰§è¡ŒRDFï¼Œ<code>fork</code>æ“ä½œä¼šå¯¹ä¸»è¿›ç¨‹é€ æˆé˜»å¡ï¼Œåªæ˜¯<code>fork</code>æœŸé—´é˜»å¡ï¼Œä¹‹åå°±ä¸é˜»å¡äº†</li><li>å­è¿›ç¨‹æ ¹æ®ä¸»è¿›ç¨‹çš„å†…å­˜ç”Ÿæˆä¸´æ—¶å¿«ç…§æ–‡ä»¶ï¼ŒæŒä¹…åŒ–å®Œæˆåç”¨ä¸´æ—¶å¿«ç…§æ–‡ä»¶æ›¿æ¢åŸæ¥çš„RDFæ–‡ä»¶ã€‚æ­¤è¿‡ç¨‹ä¸»è¿›ç¨‹ä»ç„¶å¯ä»¥å“åº”å†™æ“ä½œï¼Œä½†æ˜¯æ˜¯åœ¨å†…å­˜é¡µé¢çš„å‰¯æœ¬è¿›è¡Œï¼Œä¸ä¼šå½±å“å­è¿›ç¨‹æŒä¹…åŒ–å·¥ä½œ</li><li>å­è¿›ç¨‹å®Œæˆåå‘æ¶ˆæ¯ç»™ä¸»è¿›ç¨‹</li></ol><p><strong>RDBçš„ä¼˜ç¼ºç‚¹</strong></p><p>ä¼˜ç‚¹</p><ul><li>RDBæ–‡ä»¶å°ï¼Œé€‚åˆå®šæ—¶å¤‡ä»½ï¼Œç”¨äºå®¹ç¾</li><li>RedisåŠ è½½RDBæ–‡ä»¶é€Ÿåº¦æ¯”AOFæ—¥å¿—å¿«å¾ˆå¤šï¼Œå› ä¸ºRDBå­˜çš„æ˜¯å†…å­˜ä¸­çš„æ•°æ®ï¼Œè€ŒAOFæ—¥å¿—è®°å½•çš„æ˜¯æŒ‡ä»¤ï¼Œéœ€è¦é¡ºåºæ‰§è¡Œæ‰€æœ‰æŒ‡ä»¤æ¥æ¢å¤</li></ul><p>ç¼ºç‚¹</p><ul><li>æ— æ³•å®æ—¶æŒä¹…åŒ–ï¼Œä¸¤æ¬¡<code>bgsave</code>è¿‡ç¨‹ä¸­çš„æ•°æ®å¯èƒ½ä¸¢å¤±</li><li><code>fork</code>å­è¿›ç¨‹ä¼šé˜»å¡Redisä¸»è¿›ç¨‹</li><li>è€ç‰ˆæœ¬çš„Rediså¯èƒ½ä¸å…¼å®¹æ–°ç‰ˆæœ¬RDBæ ¼å¼æ–‡ä»¶</li></ul><h6 id="AOF"><strong>AOF</strong></h6><p>Append Only Fileï¼Œä»…è¿½åŠ æ–‡ä»¶ï¼ŒAOF æ—¥å¿—æ˜¯è¿ç»­çš„å¢é‡å¤‡ä»½ã€‚æ¯æ¬¡æ‰§è¡Œ<strong>ä¿®æ”¹å†…å­˜</strong>ä¸­æ•°æ®é›†çš„å†™æ“ä½œæ—¶ï¼Œéƒ½ä¼š<strong>è®°å½•</strong>è¯¥æ“ä½œã€‚å‡è®¾AOFè®°å½•äº†è‡ªRediså®ä¾‹åˆ›å»ºä»¥æ¥<strong>æ‰€æœ‰çš„ä¿®æ”¹æ€§æŒ‡ä»¤</strong>ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡å¯¹ä¸€ä¸ªç©ºçš„Rediså®ä¾‹<strong>é¡ºåºæ‰§è¡Œæ‰€æœ‰æŒ‡ä»¤</strong>ï¼Œå³<strong>é‡æ”¾</strong>ï¼Œæ¥æ¢å¤Rediså½“å‰å®ä¾‹çš„å†…å­˜æ•°æ®ç»“æ„çš„çŠ¶æ€</p><p>AOFä¼šåœ¨æŒç»­è¿è¡Œä¸­æŒç»­å¢å¤§ï¼Œå› æ­¤éœ€è¦å®šæœŸè¿›è¡ŒAOFé‡å†™ï¼Œå¯¹AOFæ—¥å¿—è¿›è¡Œç˜¦èº«</p><p>å¼€å¯æ–¹å¼</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## æ­¤é€‰é¡¹ä¸ºaofåŠŸèƒ½çš„å¼€å…³ï¼Œé»˜è®¤ä¸ºâ€œnoâ€ï¼Œå¯ä»¥é€šè¿‡â€œyesâ€æ¥å¼€å¯aofåŠŸèƒ½  </span></span><br><span class="line"><span class="comment">## åªæœ‰åœ¨â€œyesâ€ä¸‹ï¼Œaofé‡å†™/æ–‡ä»¶åŒæ­¥ç­‰ç‰¹æ€§æ‰ä¼šç”Ÿæ•ˆ  </span></span><br><span class="line"><span class="attr">appendonly</span> <span class="string">yes  </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">## æŒ‡å®šaofæ–‡ä»¶åç§°  </span></span><br><span class="line"><span class="attr">appendfilename</span> <span class="string">appendonly.aof  </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">## æŒ‡å®šaofæ“ä½œä¸­æ–‡ä»¶åŒæ­¥ç­–ç•¥ï¼Œæœ‰ä¸‰ä¸ªåˆæ³•å€¼ï¼šalways everysec no,é»˜è®¤ä¸ºeverysec  </span></span><br><span class="line"><span class="attr">appendfsync</span> <span class="string">everysec  </span></span><br><span class="line"><span class="comment">## åœ¨aof-rewriteæœŸé—´ï¼Œappendfsyncæ˜¯å¦æš‚ç¼“æ–‡ä»¶åŒæ­¥ï¼Œ&quot;no&quot;è¡¨ç¤ºâ€œä¸æš‚ç¼“â€ï¼Œâ€œyesâ€è¡¨ç¤ºâ€œæš‚ç¼“â€ï¼Œé»˜è®¤ä¸ºâ€œnoâ€  </span></span><br><span class="line"><span class="attr">no-appendfsync-on-rewrite</span> <span class="string">no  </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">## aofæ–‡ä»¶rewriteè§¦å‘çš„æœ€å°æ–‡ä»¶å°ºå¯¸(mb,gb),åªæœ‰å¤§äºæ­¤aofæ–‡ä»¶å¤§äºæ­¤å°ºå¯¸æ˜¯æ‰ä¼šè§¦å‘rewriteï¼Œé»˜è®¤â€œ64mbâ€ï¼Œå»ºè®®â€œ512mbâ€  </span></span><br><span class="line"><span class="attr">auto-aof-rewrite-min-size</span> <span class="string">64mb  </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">## ç›¸å¯¹äºâ€œä¸Šä¸€æ¬¡â€rewriteï¼Œæœ¬æ¬¡rewriteè§¦å‘æ—¶aofæ–‡ä»¶åº”è¯¥å¢é•¿çš„ç™¾åˆ†æ¯”  </span></span><br><span class="line"><span class="comment">## æ¯ä¸€æ¬¡rewriteä¹‹åï¼Œrediséƒ½ä¼šè®°å½•ä¸‹æ­¤æ—¶â€œæ–°aofâ€æ–‡ä»¶çš„å¤§å°(ä¾‹å¦‚A)</span></span><br><span class="line"><span class="comment">## aofæ–‡ä»¶å¢é•¿åˆ°A*(1 + p)ä¹‹åï¼Œè§¦å‘ä¸‹ä¸€æ¬¡rewriteï¼Œæ¯ä¸€æ¬¡aofè®°å½•çš„æ·»åŠ ï¼Œéƒ½ä¼šæ£€æµ‹å½“å‰aofæ–‡ä»¶çš„å°ºå¯¸ã€‚  </span></span><br><span class="line"><span class="attr">auto-aof-rewrite-percentage</span> <span class="string">100</span></span><br></pre></td></tr></table></figure><p>Linuxå¯¹æ–‡ä»¶é‡‡ç”¨å»¶è¿Ÿå†™å…¥ï¼Œå³æ¯æ¬¡å†™å…¥å…ˆè¿›ç¼“å­˜ï¼Œåˆ°äº†å·²å®šæ—¶æœºå†å†™å…¥ç£ç›˜ã€‚</p><p>Linuxæä¾›äº†<code>fsync(int fd)</code>å‡½æ•°ï¼Œå¯ä»¥å°†æŒ‡å®šæ–‡ä»¶çš„å†…å®¹å¼ºåˆ¶ä»å†…æ ¸ç¼“å­˜åˆ·åˆ°ç£ç›˜ï¼Œä½†æ˜¯æ˜¯ä¸€ä¸ªç£ç›˜IOæ“ä½œï¼Œéå¸¸è€—æ—¶ã€‚å› æ­¤<strong>Redisæä¾›äº†3ç§AOFåŒæ­¥ç­–ç•¥</strong>ï¼š</p><ul><li>alwaysï¼šæ¯æ¡AOFéƒ½ç«‹å³åŒæ­¥ï¼Œæ€§èƒ½ä½ï¼Œå®‰å…¨</li><li>everysecï¼šæ¯ç§’åŒæ­¥ï¼Œé»˜è®¤çš„æ–¹å¼ï¼Œæ€§èƒ½å®‰å…¨è¾ƒå¹³è¡¡</li><li>noï¼šæ°¸ä¸ç›´æ¥åŒæ­¥ï¼Œå…¨ç”±æ“ä½œç³»ç»Ÿå†³å®šã€‚æ€§èƒ½å¥½ä½†éå¸¸ä¸å®‰å…¨</li></ul><p><strong>é‡å†™(Rewrite)æœºåˆ¶</strong></p><p>ä¸æ˜¯åŸºäºæºAOFæ–‡ä»¶ï¼Œè€Œæ˜¯åŸºäºå½“å‰å†…å­˜æ•°æ®ï¼Œç±»ä¼¼äºRDBå¿«ç…§çš„æ–¹å¼ï¼Œä½¿ç”¨æ›´å°‘çš„æŒ‡ä»¤æ¥è®°å½•å†…å­˜ä¸­æ•°æ®çš„çŠ¶æ€ã€‚å…ˆå­˜å½“å‰å†…å­˜çŠ¶æ€ï¼Œå†å°†é‡å†™æœŸé—´çš„å†™æ“ä½œä»ç¼“å­˜å†™å…¥AOFã€‚</p><p><strong>è§¦å‘æœºåˆ¶</strong>ï¼šæ‰‹åŠ¨å’Œè‡ªåŠ¨</p><p>æ‰‹åŠ¨ï¼š<code>bgrewriteaof</code>å‘½ä»¤ï¼š<code>redis-cli -h ip -p port bgrewriteaof</code></p><p>è‡ªåŠ¨</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">auto-aof-rewrite-min-size</span>:<span class="string">è¡¨ç¤ºè¿è¡ŒAOFé‡å†™æ—¶æ–‡ä»¶æœ€å°ä½“ç§¯ï¼Œé»˜è®¤ä¸º64MBï¼ˆæˆ‘ä»¬çº¿ä¸Šæ˜¯512MBï¼‰ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="attr">auto-aof-rewrite-percentage</span>:<span class="string">ä»£è¡¨å½“å‰AOFæ–‡ä»¶ç©ºé—´ï¼ˆaof_current_sizeï¼‰å’Œä¸Šä¸€æ¬¡é‡å†™åAOFæ–‡ä»¶ç©ºé—´ï¼ˆaof_base_sizeï¼‰</span></span><br></pre></td></tr></table></figure><p><strong>AOFçš„ä¼˜ç¼ºç‚¹</strong></p><p>ä¼˜ç‚¹ï¼šåªæ˜¯è¿½åŠ å†™æ—¥å¿—ï¼Œå†™å¢é‡ä¿¡æ¯ï¼Œå¯¹æœåŠ¡å™¨æ€§èƒ½å½±å“å°ï¼Œé€Ÿåº¦æ¯”RDBå¿«ï¼Œå†…å­˜æ¶ˆè€—å°‘</p><p>ç¼ºç‚¹</p><ul><li>æ—¥å¿—æ–‡ä»¶å¤ªå¤§ï¼Œéœ€è¦ä¸æ–­é‡å†™ç˜¦èº«ï¼Œä½†å’ŒRDBæ–‡ä»¶æ¯”è¿˜æ˜¯å¾ˆå¤§</li><li>ä½¿ç”¨AOFæ¢å¤æ•°æ®æ—¶ï¼Œæ¯”RDBæ…¢</li></ul><h6 id="Redis4-0æ··åˆæŒä¹…åŒ–">Redis4.0æ··åˆæŒä¹…åŒ–</h6><p>RDBæ–‡ä»¶å’ŒAOFæ—¥å¿—ç»“åˆï¼ŒAOFæ—¥å¿—è®°å½•è‡ªRDBæŒä¹…åŒ–å¼€å§‹åˆ°å½“å‰è¿™æ®µæ—¶é—´å‘ç”Ÿçš„å¢é‡æ•°æ®ã€‚</p><p>å¤§é‡æ•°æ®ä½¿ç”¨RDBï¼Œæ€§èƒ½é«˜ï¼Œæ¢å¤å¿«ï¼›å¢é‡æ•°æ®ä½¿ç”¨AOFï¼Œå°½é‡ä¿è¯æ•°æ®ä¸ä¸¢å¤±</p><h5 id="Redisä¸»ä»å¤åˆ¶æ€ä¹ˆå®ç°çš„">Redisä¸»ä»å¤åˆ¶æ€ä¹ˆå®ç°çš„</h5><p>ä½œç”¨</p><ul><li>æ•°æ®å†—ä½™ï¼šä¸»ä»å¤åˆ¶å®ç°æ•°æ®çš„çƒ­å¤‡ä»½</li><li>æ•…éšœæ¢å¤ï¼šä¸»èŠ‚ç‚¹æŒ‚äº†ï¼Œä»èŠ‚ç‚¹å¯ä»¥æä¾›æœåŠ¡ï¼Œå®ç°å¿«é€Ÿæ•…éšœæ¢å¤</li><li>è´Ÿè½½å‡è¡¡ï¼šä¸»ä»å¤åˆ¶ã€è¯»å†™åˆ†ç¦»ï¼Œä¸»æä¾›å†™ï¼Œä»æä¾›è¯»</li></ul><p>å®ç°åŸç†</p><p><strong>å‡†å¤‡é˜¶æ®µ - &gt; æ•°æ®åŒæ­¥é˜¶æ®µ - &gt; å‘½ä»¤ä¼ æ’­é˜¶æ®µ</strong></p><p>slaveç¬¬ä¸€æ¬¡è¿æ¥åˆ°masteræ—¶ï¼Œmasterä¼šå¯åŠ¨å­è¿›ç¨‹ç”ŸæˆRDBå¿«ç…§ï¼Œå¹¶æŠŠè¿‡ç¨‹ä¸­çš„å†™è¯·æ±‚å­˜åˆ°ç¼“å­˜ï¼ŒRDBæ–‡ä»¶ç”Ÿæˆåï¼Œå°†RDBæ–‡ä»¶å‘ç»™slaveï¼Œå¹¶æŠŠç¼“å­˜ä¸­çš„å†™æ“ä½œä¹Ÿå‘ç»™slave</p><p>ä¹‹åçš„æ•°æ®é€šè¿‡AOFæ—¥å¿—åŒæ­¥</p><h5 id="Redisä¸­çš„å“¨å…µæ˜¯å¹²å•¥çš„">Redisä¸­çš„å“¨å…µæ˜¯å¹²å•¥çš„</h5><p>æ¶æ„</p><p>å“¨å…µèŠ‚ç‚¹ï¼šå“¨å…µç³»ç»Ÿç”±ä¸€ä¸ªæˆ–å¤šä¸ªå“¨å…µèŠ‚ç‚¹ç»„æˆï¼Œä¸å­˜å‚¨æ•°æ®</p><p>æ•°æ®èŠ‚ç‚¹ï¼šä¸»ã€ä»éƒ½æ˜¯æ•°æ®èŠ‚ç‚¹</p><p>åŠŸèƒ½</p><ul><li><strong>ç›‘æ§ï¼ˆMonitoringï¼‰ï¼š</strong> å“¨å…µä¼šä¸æ–­åœ°æ£€æŸ¥ä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹æ˜¯å¦è¿ä½œæ­£å¸¸ã€‚</li><li><strong>è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼ˆAutomatic failoverï¼‰ï¼š</strong> å½“ <strong>ä¸»èŠ‚ç‚¹</strong> ä¸èƒ½æ­£å¸¸å·¥ä½œæ—¶ï¼Œå“¨å…µä¼šå¼€å§‹ <strong>è‡ªåŠ¨æ•…éšœè½¬ç§»æ“ä½œ</strong>ï¼Œå®ƒä¼šå°†å¤±æ•ˆä¸»èŠ‚ç‚¹çš„å…¶ä¸­ä¸€ä¸ª <strong>ä»èŠ‚ç‚¹å‡çº§ä¸ºæ–°çš„ä¸»èŠ‚ç‚¹</strong>ï¼Œå¹¶è®©å…¶ä»–ä»èŠ‚ç‚¹æ”¹ä¸ºå¤åˆ¶æ–°çš„ä¸»èŠ‚ç‚¹ã€‚<ol><li>åœ¨å¤±æ•ˆä¸»æœåŠ¡å™¨å±ä¸‹çš„ä»æœåŠ¡å™¨å½“ä¸­ï¼Œ é‚£äº›è¢«æ ‡è®°ä¸ºä¸»è§‚ä¸‹çº¿ã€å·²æ–­çº¿ã€æˆ–è€…æœ€åä¸€æ¬¡å›å¤ PING å‘½ä»¤çš„æ—¶é—´å¤§äºäº”ç§’é’Ÿçš„ä»æœåŠ¡å™¨éƒ½ä¼šè¢« <strong>æ·˜æ±°</strong>ã€‚</li><li>åœ¨å¤±æ•ˆä¸»æœåŠ¡å™¨å±ä¸‹çš„ä»æœåŠ¡å™¨å½“ä¸­ï¼Œ é‚£äº›ä¸å¤±æ•ˆä¸»æœåŠ¡å™¨è¿æ¥æ–­å¼€çš„æ—¶é•¿è¶…è¿‡ down-after é€‰é¡¹æŒ‡å®šçš„æ—¶é•¿åå€çš„ä»æœåŠ¡å™¨éƒ½ä¼šè¢« <strong>æ·˜æ±°</strong>ã€‚</li><li>åœ¨ <strong>ç»å†äº†ä»¥ä¸Šä¸¤è½®æ·˜æ±°ä¹‹å</strong> å‰©ä¸‹æ¥çš„ä»æœåŠ¡å™¨ä¸­ï¼Œ æˆ‘ä»¬é€‰å‡º <strong>å¤åˆ¶åç§»é‡ï¼ˆreplication offsetï¼‰æœ€å¤§</strong> çš„é‚£ä¸ª <strong>ä»æœåŠ¡å™¨</strong> ä½œä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ï¼›å¦‚æœå¤åˆ¶åç§»é‡ä¸å¯ç”¨ï¼Œæˆ–è€…ä»æœåŠ¡å™¨çš„å¤åˆ¶åç§»é‡ç›¸åŒï¼Œé‚£ä¹ˆ <strong>å¸¦æœ‰æœ€å°è¿è¡Œ ID</strong> çš„é‚£ä¸ªä»æœåŠ¡å™¨æˆä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ã€‚</li></ol></li><li><strong>é…ç½®æä¾›è€…ï¼ˆConfiguration providerï¼‰ï¼š</strong> å®¢æˆ·ç«¯åœ¨åˆå§‹åŒ–æ—¶ï¼Œé€šè¿‡è¿æ¥å“¨å…µæ¥è·å¾—å½“å‰ Redis æœåŠ¡çš„ä¸»èŠ‚ç‚¹åœ°å€ã€‚</li><li><strong>é€šçŸ¥ï¼ˆNotificationï¼‰ï¼š</strong> å“¨å…µå¯ä»¥å°†æ•…éšœè½¬ç§»çš„ç»“æœå‘é€ç»™å®¢æˆ·ç«¯ã€‚</li></ul><h5 id="ä¸ºä»€ä¹ˆRedisçš„è´Ÿè½½å› å­è®¾ç½®æ¯”HashMapçš„è´Ÿè½½å› å­å¤§">ä¸ºä»€ä¹ˆRedisçš„è´Ÿè½½å› å­è®¾ç½®æ¯”HashMapçš„è´Ÿè½½å› å­å¤§</h5><p>Redisçš„è´Ÿè½½å› å­æ˜¯é”®å€¼å¯¹çš„æ•°é‡/é•¿åº¦ï¼ŒHashMapæ˜¯å·²ä½¿ç”¨çš„æ•°é‡/é•¿åº¦</p><h5 id="Redisçš„åˆ†å¸ƒå¼é”ï¼Ÿ">Redisçš„åˆ†å¸ƒå¼é”ï¼Ÿ</h5><p>æœ€ä½ä¿è¯åˆ†å¸ƒå¼é”çš„æœ‰æ•ˆæ€§åŠå®‰å…¨æ€§çš„è¦æ±‚å¦‚ä¸‹ï¼š</p><p>1.äº’æ–¥ï¼›ä»»ä½•æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªclientè·å–é”</p><p>2.é‡Šæ”¾æ­»é”ï¼›å³ä½¿é”å®šèµ„æºçš„æœåŠ¡å´©æºƒæˆ–è€…åˆ†åŒºï¼Œä»ç„¶èƒ½é‡Šæ”¾é”</p><p>3.å®¹é”™æ€§ï¼›åªè¦å¤šæ•°redisèŠ‚ç‚¹ï¼ˆä¸€åŠä»¥ä¸Šï¼‰åœ¨ä½¿ç”¨ï¼Œclientå°±å¯ä»¥è·å–å’Œé‡Šæ”¾é”</p><p><strong>é—®é¢˜</strong></p><p>å› ä¸ºredisåœ¨è¿›è¡Œä¸»ä»å¤åˆ¶æ—¶æ˜¯å¼‚æ­¥å®Œæˆçš„ï¼Œæ¯”å¦‚åœ¨clientAè·å–é”åï¼Œä¸»rediså¤åˆ¶æ•°æ®åˆ°ä»redisè¿‡ç¨‹ä¸­å´©æºƒäº†ï¼Œå¯¼è‡´æ²¡æœ‰å¤åˆ¶åˆ°ä»redisä¸­ï¼Œç„¶åä»redisé€‰ä¸¾å‡ºä¸€ä¸ªå‡çº§ä¸ºä¸»redis,é€ æˆæ–°çš„ä¸»redisæ²¡æœ‰clientA è®¾ç½®çš„é”ï¼Œè¿™æ˜¯clientBå°è¯•è·å–é”ï¼Œå¹¶ä¸”èƒ½å¤ŸæˆåŠŸè·å–é”ï¼Œå¯¼è‡´äº’æ–¥å¤±æ•ˆï¼›</p><p><strong>Redisåˆ†å¸ƒå¼é”çš„å®ç°</strong></p><p><strong>å•å®ä¾‹</strong>ä¸­çš„å®ç°ï¼š<code>SET key_name value_name NX PX 30000</code>ä¿è¯åŸå­æ€§</p><blockquote><p>NX è¡¨ç¤ºif not exist å°±è®¾ç½®å¹¶è¿”å›Trueï¼Œå¦åˆ™ä¸è®¾ç½®å¹¶è¿”å›False   PX è¡¨ç¤ºè¿‡æœŸæ—¶é—´ç”¨æ¯«ç§’çº§ï¼Œ 30000 è¡¨ç¤ºè¿™äº›æ¯«ç§’æ—¶é—´åæ­¤keyè¿‡æœŸ</p></blockquote><p>è·å–å¤±è´¥åˆ™ç­‰å¾…ä¸€æ®µæ—¶é—´é‡è¯•(å¤§äºttl)æˆ–é€€å‡º</p><p>è·å–é”ï¼Œå®Œæˆç›¸å…³æ“ä½œåï¼Œå¿…é¡»åˆ é™¤è‡ªå·±çš„é”ã€‚è¿™é‡Œè·å–å’Œåˆ é™¤éƒ½æ˜¯ç”¨luaè„šæœ¬ï¼Œä¿è¯æ“ä½œçš„åŸå­æ€§</p><p><strong>å¤šèŠ‚ç‚¹</strong>Rediså®ç°(RedLock)ï¼šæœ‰æ•ˆé˜²æ­¢å•ç‚¹æ•…éšœ</p><p>1.è·å–å½“å‰æ—¶é—´æˆ³</p><p>2.clientå°è¯•æŒ‰ç…§é¡ºåºä½¿ç”¨ç›¸åŒçš„key,valueè·å–æ‰€æœ‰redisæœåŠ¡çš„é”ï¼Œåœ¨è·å–é”çš„è¿‡ç¨‹ä¸­çš„è·å–æ—¶é—´æ¯”é”è¿‡æœŸæ—¶é—´çŸ­å¾ˆå¤šï¼Œè¿™æ˜¯ä¸ºäº†ä¸è¦è¿‡é•¿æ—¶é—´ç­‰å¾…å·²ç»å…³é—­çš„redisæœåŠ¡ã€‚å¹¶ä¸”è¯•ç€è·å–ä¸‹ä¸€ä¸ªrediså®ä¾‹ã€‚</p><p>æ¯”å¦‚ï¼šTTLä¸º5s,è®¾ç½®è·å–é”æœ€å¤šç”¨1sï¼Œæ‰€ä»¥å¦‚æœä¸€ç§’å†…æ— æ³•è·å–é”ï¼Œå°±æ”¾å¼ƒè·å–è¿™ä¸ªé”ï¼Œä»è€Œå°è¯•è·å–ä¸‹ä¸ªé”</p><p>3.clienté€šè¿‡è·å–æ‰€æœ‰èƒ½è·å–çš„é”åçš„æ—¶é—´å‡å»ç¬¬ä¸€æ­¥çš„æ—¶é—´ï¼Œè¿™ä¸ªæ—¶é—´å·®è¦å°äºTTLæ—¶é—´å¹¶ä¸”è‡³å°‘æœ‰3ä¸ªrediså®ä¾‹æˆåŠŸè·å–é”ï¼Œæ‰ç®—çœŸæ­£çš„è·å–é”æˆåŠŸ</p><p>4.å¦‚æœæˆåŠŸè·å–é”ï¼Œåˆ™é”çš„çœŸæ­£æœ‰æ•ˆæ—¶é—´æ˜¯ TTLå‡å»ç¬¬ä¸‰æ­¥çš„æ—¶é—´å·® çš„æ—¶é—´ï¼›æ¯”å¦‚ï¼šTTL æ˜¯5s,è·å–æ‰€æœ‰é”ç”¨äº†2s,åˆ™çœŸæ­£é”æœ‰æ•ˆæ—¶é—´ä¸º3s(å…¶å®åº”è¯¥å†å‡å»æ—¶é’Ÿæ¼‚ç§»);</p><p>5.å¦‚æœå®¢æˆ·ç«¯ç”±äºæŸäº›åŸå› è·å–é”å¤±è´¥ï¼Œä¾¿ä¼šå¼€å§‹è§£é”æ‰€æœ‰rediså®ä¾‹ï¼›å› ä¸ºå¯èƒ½å·²ç»è·å–äº†å°äº3ä¸ªé”ï¼Œå¿…é¡»é‡Šæ”¾ï¼Œå¦åˆ™å½±å“å…¶ä»–clientè·å–é”</p><h5 id="RedisåŒ…å«çš„æ¨¡å—">RedisåŒ…å«çš„æ¨¡å—</h5><h5 id="Redisä¸ºä»€ä¹ˆå¿«ï¼Ÿ">Redisä¸ºä»€ä¹ˆå¿«ï¼Ÿ</h5><ol><li>çº¯å†…å­˜æ“ä½œ</li><li>å•çº¿ç¨‹ï¼Œæ²¡æœ‰å„è‡ªä¹±ä¸ƒå…«ç³Ÿçš„é”</li><li>å¤šè·¯IOå¤ç”¨æ¨¡å‹ï¼Œåº•å±‚æœ‰å¾ˆå¤šä¼˜åŒ–</li><li>é«˜æ•ˆçš„æ•°æ®ç»“æ„ï¼šå¦‚ä¸åŒé•¿åº¦çš„å­—ç¬¦ä¸²ç”¨äº†ä¸åŒçš„ç»“æ„ä½“ã€HyperLogLogçš„å¯†é›†å‹å­˜å‚¨ç»“æ„ç­‰</li></ol><h5 id="Redisçš„HyperLogLog">Redisçš„HyperLogLog</h5><p>HyperLogLogæ˜¯ä¸€ç§ä¼°è®¡åŸºæ•°çš„è¿‘ä¼¼æœ€ä¼˜ç®—æ³•ã€‚åŸºæ•°ç»Ÿè®¡ï¼šç”¨æ¥ç»Ÿè®¡ä¸€ä¸ªé›†åˆä¸­ä¸é‡å¤çš„å…ƒç´ ä¸ªæ•°ï¼Œæ¯”å¦‚ç»Ÿè®¡ç½‘ç«™æ¯ä¸ªé¡µé¢çš„UV(ç‹¬ç«‹è®¿å®¢)</p><p>å¤§è‡´çš„åŸç†ï¼šä¸€ä¸ªéšæœºæ•°ï¼Œå°¾éƒ¨æœ‰1ä¸ª0çš„æ¦‚ç‡ä¸º1/2ï¼Œä¸¤ä¸ª0çš„æ¦‚ç‡ä¸º1/4ï¼Œâ€¦ï¼Œå°¾éƒ¨kä¸ª0çš„æ¦‚ç‡ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mo>âˆ’</mo><mi>k</mi></mrow></msup></mrow><annotation encoding="application/x-tex">2^{-k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span>ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡å°¾éƒ¨è¿ç»­0çš„æœ€å¤§æ•°é‡kï¼Œä¼°ç®—å‡ºæˆ‘ä»¬ç”¨äº†å¤šå°‘ä¸ªéšæœºæ•°ã€‚HyperLogLogé€šè¿‡åˆ†é…è‹¥å¹²æ¡¶(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>14</mn></msup></mrow><annotation encoding="application/x-tex">2^{14}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">14</span></span></span></span></span></span></span></span></span></span></span></span>=26384)ï¼Œå¯¹æ¯ä¸ªæ¡¶å¾—åˆ°çš„æœ€å¤§æ•°é‡kè¿›è¡Œè°ƒå’Œå¹³å‡ï¼Œå¾—åˆ°ä¸€ä¸ªk#ï¼Œk#ä¸ºä¸€ä¸ªæµ®ç‚¹æ•°ã€‚å…·ä½“è¿˜æœ‰å¾ˆå¤šä¿®æ­£å› å­ï¼Œæ¯”è¾ƒå¤æ‚</p><p>å ç”¨å†…å­˜ä»…12KBï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>14</mn></msup></mrow><annotation encoding="application/x-tex">2^{14}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">14</span></span></span></span></span></span></span></span></span></span></span></span>ä¸ªæ¡¶ï¼Œæ¯ä¸ª6bitï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>14</mn></msup><mo>âˆ—</mo><mfrac><mn>6</mn><mn>8</mn></mfrac></mrow><annotation encoding="application/x-tex">2^{14}*\frac68</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">14</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p><p>Redisçš„å®ç°ï¼šè®¡æ•°é‡å°çš„æ—¶å€™ï¼Œè½¬æ¢æˆç¨€ç–å­˜å‚¨æ–¹å¼ï¼›å¦åˆ™é‡‡ç”¨å¯†é›†å­˜å‚¨ã€‚æœ€å¤§é™åº¦èŠ‚çº¦å†…å­˜</p><p>å¯†é›†å­˜å‚¨ï¼š16384ä¸ª6bitè¿ç»­æˆä¸²ï¼Œ8bit 1å­—èŠ‚ï¼Œéœ€è¦ä¸€äº›ç§»ä½æ‹¼æ¥çš„å¤„ç†</p><p>ç¨€ç–å­˜å‚¨ï¼šå½“æŸä¸ªè®¡æ•°å€¼éœ€è¦è°ƒæ•´åˆ°å¤§äº32æ—¶ï¼Œä¼šè½¬æ¢ä¸ºå¯†é›†å­˜å‚¨</p><ul><li>00å¼€å¤´è¡¨ç¤ºå6ä½æ•´æ•°å€¼åŠ 1å°±æ˜¯é›¶å€¼è®¡æ•°å™¨çš„æ•°é‡</li><li>01å14bitæœ€å¤šå¯ä»¥è¡¨ç¤ºè¿ç»­16384ä¸ªé›¶å€¼è®¡æ•°å™¨</li><li>1vvvvvxxï¼šä¸­é—´5bitè®¡æ•°ï¼Œå2bitè¡¨ç¤ºè¿ç»­å‡ ä¸ªæ¡¶</li></ul><p>æŒ‡ä»¤ï¼š<code>pfadd</code>å’Œ<code>pfcount</code></p><p><a href="https://mp.weixin.qq.com/s/9dtGe3d_mbbxW5FpVPDNow">https://mp.weixin.qq.com/s/9dtGe3d_mbbxW5FpVPDNow</a></p><p><a href="https://cloud.tencent.com/developer/article/1349691">https://cloud.tencent.com/developer/article/1349691</a></p><h5 id="å‡å¦‚Redisé‡Œé¢æœ‰1äº¿ä¸ªkeyï¼Œå…¶ä¸­æœ‰10wä¸ªkeyæ˜¯ä»¥æŸä¸ªå›ºå®šçš„å·²çŸ¥çš„å‰ç¼€å¼€å¤´çš„ï¼Œå¦‚ä½•å°†å®ƒä»¬å…¨éƒ¨æ‰¾å‡ºæ¥ï¼Ÿ">å‡å¦‚Redisé‡Œé¢æœ‰1äº¿ä¸ªkeyï¼Œå…¶ä¸­æœ‰10wä¸ªkeyæ˜¯ä»¥æŸä¸ªå›ºå®šçš„å·²çŸ¥çš„å‰ç¼€å¼€å¤´çš„ï¼Œå¦‚ä½•å°†å®ƒä»¬å…¨éƒ¨æ‰¾å‡ºæ¥ï¼Ÿ</h5><p>ä½¿ç”¨ <code>keys</code> æŒ‡ä»¤å¯ä»¥æ‰«å‡ºæŒ‡å®šæ¨¡å¼çš„ key åˆ—è¡¨ã€‚ä½†æ˜¯è¦æ³¨æ„ keys æŒ‡ä»¤ä¼šå¯¼è‡´çº¿ç¨‹é˜»å¡ä¸€æ®µæ—¶é—´ï¼Œçº¿ä¸ŠæœåŠ¡ä¼šåœé¡¿ï¼Œç›´åˆ°æŒ‡ä»¤æ‰§è¡Œå®Œæ¯•ï¼ŒæœåŠ¡æ‰èƒ½æ¢å¤ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨ <code>scan</code> æŒ‡ä»¤ï¼Œ<code>scan</code> æŒ‡ä»¤å¯ä»¥æ— é˜»å¡çš„æå–å‡ºæŒ‡å®šæ¨¡å¼çš„ <code>key</code> åˆ—è¡¨ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€å®šçš„é‡å¤æ¦‚ç‡ï¼Œåœ¨å®¢æˆ·ç«¯åšä¸€æ¬¡å»é‡å°±å¯ä»¥äº†ï¼Œä½†æ˜¯æ•´ä½“æ‰€èŠ±è´¹çš„æ—¶é—´ä¼šæ¯”ç›´æ¥ç”¨ <code>keys</code> æŒ‡ä»¤é•¿ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®åº“ </tag>
            
            <tag> Redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JVMå­¦ä¹ éšç¬”</title>
      <link href="/2020/08/10/JVM_Note/"/>
      <url>/2020/08/10/JVM_Note/</url>
      
        <content type="html"><![CDATA[<h2 id="JVMçš„æ¶æ„æ¨¡å‹">JVMçš„æ¶æ„æ¨¡å‹</h2><p>JAVAç¼–è¯‘å™¨è¾“å…¥çš„æŒ‡ä»¤æµåŸºæœ¬æ˜¯ä¸€ç§åŸºäº<strong>æ ˆçš„æŒ‡ä»¤é›†æ¶æ„</strong>ï¼Œå¦ä¸€ç§æ¶æ„æ˜¯åŸºäºå¯„å­˜å™¨çš„ã€‚<br>ä¸¤è€…çš„åŒºåˆ«ï¼š</p><ul><li><strong>åŸºäºæ ˆå¼æ¶æ„çš„ç‰¹ç‚¹</strong><ul><li>è®¾è®¡å’Œå®ç°æ›´ç®€å•ï¼Œé€‚ç”¨äºèµ„æºå—é™çš„ç³»ç»Ÿï¼Œæ¯”å¦‚åµŒå…¥å¼ã€‚</li><li>é¿å¼€äº†å¯„å­˜å™¨çš„åˆ†é…éš¾é¢˜ï¼šé‡‡ç”¨é›¶åœ°å€æŒ‡ä»¤æ–¹å¼åˆ†é…ã€‚ï¼ˆé›¶åœ°å€å°±æ˜¯åªæœ‰æ“ä½œç ï¼Œæ²¡æœ‰åœ°å€å­—æ®µï¼Œå› ä¸ºæ ˆçš„è¯åªå¯¹æ ˆé¡¶è¿›è¡Œæ“ä½œï¼Œå°±ä¸éœ€è¦åœ°å€ï¼‰</li><li>æŒ‡ä»¤æµä¸­çš„æŒ‡ä»¤å¤§éƒ¨åˆ†æ˜¯é›¶åœ°å€æŒ‡ä»¤ï¼Œæ‰§è¡Œè¿‡ç¨‹ä¾èµ–æ“ä½œæ ˆã€‚<strong>æŒ‡ä»¤é›†æ›´å°</strong>ï¼Œç¼–è¯‘å™¨å®¹æ˜“å®ç°ã€‚</li><li>ä¸éœ€è¦ç¡¬ä»¶æ”¯æŒï¼Œå¯ç§»æ¤æ€§æ›´å¥½ï¼Œæ›´å¥½å®ç°<strong>è·¨å¹³å°</strong></li></ul></li><li><strong>åŸºäºå¯„å­˜å™¨æ¶æ„çš„ç‰¹ç‚¹</strong><ul><li>æŒ‡ä»¤é›†å®Œå…¨ä¾èµ–äºç¡¬ä»¶ï¼Œå¯ç§»æ¤æ€§å·®ã€‚</li><li>æ€§èƒ½ä¼˜ç§€ã€æ‰§è¡Œé«˜æ•ˆ</li><li>èŠ±è´¹æ›´å°‘çš„æŒ‡ä»¤æ¥å®Œæˆä¸€é¡¹æ“ä½œ</li><li>åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œé‡‡ç”¨ä¸€åœ°å€æŒ‡ä»¤ã€äºŒåœ°å€æŒ‡ä»¤å’Œåœ¨åœ°å€æŒ‡ä»¤ä¸ºä¸»ã€‚</li></ul></li></ul><h2 id="JVMçš„ç”Ÿå‘½å‘¨æœŸ">JVMçš„ç”Ÿå‘½å‘¨æœŸ</h2><ul><li>è™šæ‹Ÿæœºçš„å¯åŠ¨ï¼šJavaè™šæ‹Ÿæœºçš„å¯åŠ¨æ—¶é€šè¿‡å¼•å¯¼ç±»åŠ è½½å™¨(bootstrap class loader)åˆ›å»ºä¸€ä¸ªåˆå§‹ç±»(initial calss)æ¥å®Œæˆçš„ï¼Œè¿™ä¸ªç±»æ˜¯ç”±è™šæ‹Ÿæœºçš„å…·ä½“å®ç°æŒ‡å®šçš„ã€‚</li><li>è™šæ‹Ÿæœºçš„æ‰§è¡Œï¼š<ul><li>ä»»åŠ¡ï¼šæ‰§è¡ŒJavaç¨‹åº</li><li>ç¨‹åºå¼€å§‹æ‰§è¡Œæ—¶å®ƒæ‰è¿è¡Œï¼Œç¨‹åºç»“æŸå®ƒå°±åœæ­¢</li><li>æ‰§è¡Œä¸€ä¸ªæ‰€è°“çš„Javaç¨‹åºçš„æ—¶å€™ï¼ŒçœŸçœŸæ­£æ­£åœ¨æ‰§è¡Œçš„æ˜¯ä¸€ä¸ªå«åšJavaè™šæ‹Ÿæœºçš„è¿›ç¨‹</li></ul></li><li>è™šæ‹Ÿæœºçš„é€€å‡ºï¼š<ul><li>ç¨‹åºæ­£å¸¸æ‰§è¡Œç»“æŸ</li><li>ç¨‹åºç¢°åˆ°å¼‚å¸¸æˆ–é”™è¯¯è€Œå¼‚å¸¸ç»ˆæ­¢</li><li>ç”±äºæ“ä½œç³»ç»Ÿå‡ºé”™è€Œå¯¼è‡´Javaè™šæ‹Ÿæœºè¿›ç¨‹ç»ˆæ­¢</li><li>æŸçº¿ç¨‹è°ƒç”¨Runtimeç±»æˆ–è€…Systemç±»çš„exitæ–¹æ³•ï¼Œæˆ–Runtimeç±»çš„haltæ–¹æ³•ï¼Œå¹¶ä¸”Javaå®‰å…¨ç®¡ç†å™¨ä¹Ÿå…è®¸è¿™æ¬¡exitæˆ–haltæ“ä½œ</li><li>é™¤æ­¤ä¹‹å¤–ï¼ŒJNI(Java Native Interface)è§„èŒƒæè¿°äº†ç”¨JNI Invocation APIæ¥åŠ è½½æˆ–å¸è½½Javaè™šæ‹Ÿæœºæ—¶ï¼ŒJavaè™šæ‹Ÿæœºçš„é€€å‡ºæƒ…å†µ</li></ul></li></ul><h2 id="JVMæ•´ä½“ç»“æ„">JVMæ•´ä½“ç»“æ„</h2><p><img src="https://lqy-blog-pic.oss-cn-shanghai.aliyuncs.com/blogImg/JVM_jiegou.jpg" alt=""></p><h2 id="ç±»åŠ è½½å™¨å­ç³»ç»Ÿ">ç±»åŠ è½½å™¨å­ç³»ç»Ÿ</h2><p><img src="https://lqy-blog-pic.oss-cn-shanghai.aliyuncs.com/blogImg/JVM_leijiazaiqi.jpg" alt=""></p><ul><li>ç±»åŠ è½½å™¨å­ç³»ç»Ÿè´Ÿè´£ä»æ–‡ä»¶ç³»ç»Ÿæˆ–è€…ç½‘ç»œä¸­åŠ è½½Classæ–‡ä»¶ï¼Œclassæ–‡ä»¶åœ¨æ–‡ä»¶å¼€å¤´æœ‰ç‰¹å®šçš„æ–‡ä»¶æ ‡è¯†ã€‚</li><li>ClassLoaderåªè´Ÿè´£classæ–‡ä»¶çš„åŠ è½½ï¼Œè‡³äºå®ƒæ˜¯å¦å¯ä»¥è¿è¡Œï¼Œåˆ™ç”±Execution Engineå†³å®šã€‚</li><li>åŠ è½½çš„ç±»ä¿¡æ¯å­˜æ”¾åœ¨ä¸€å—ç§°ä¸ºæ–¹æ³•åŒºçš„å†…å­˜ç©ºé—´ã€‚é™¤äº†ç±»çš„ä¿¡æ¯å¤–ï¼Œæ–¹æ³•åŒºä¸­è¿˜ä¼šå­˜æ”¾è¿è¡Œæ—¶å¸¸é‡æ± ä¿¡æ¯ï¼Œå¯èƒ½è¿˜åŒ…æ‹¬å­—ç¬¦ä¸²å­—é¢é‡å’Œæ•°å­—å¸¸é‡ï¼ˆè¿™éƒ¨åˆ†ä¿¡æ¯æ˜¯Classæ–‡ä»¶ä¸­å¸¸é‡æ± éƒ¨åˆ†çš„å†…å­˜æ˜ å°„ï¼‰</li></ul><h3 id="ç±»çš„åŠ è½½é˜¶æ®µ">ç±»çš„åŠ è½½é˜¶æ®µ</h3><ol><li>åŠ è½½ï¼š<ol><li>é€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåå®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµ</li><li>å°†è¿™ä¸ªå­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„</li><li>åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„<strong>java.lang.Classå¯¹è±¡</strong>ï¼Œä½œä¸ºæ–¹æ³•åŒºè¿™ä¸ªç±»çš„å„ç§æ•°æ®çš„è®¿é—®å…¥å£ã€‚</li></ol></li><li>é“¾æ¥ï¼š<ol><li>éªŒè¯ï¼š<ul><li>ç›®çš„åœ¨äºç¡®ä¿classæ–‡ä»¶çš„å­—èŠ‚æµä¸­åŒ…å«ä¿¡æ¯ç¬¦åˆå½“å‰è™šæ‹Ÿæœºè¦æ±‚ï¼Œä¿è¯è¢«åŠ è½½ç±»çš„æ­£ç¡®æ€§</li><li>ä¸»è¦åŒ…æ‹¬å››ç§éªŒè¯ï¼šæ–‡ä»¶æ ¼å¼éªŒè¯ã€å…ƒæ•°æ®éªŒè¯ã€å­—èŠ‚ç éªŒè¯ã€ç¬¦å·å¼•ç”¨éªŒè¯</li></ul></li><li>å‡†å¤‡ï¼š<ul><li>ä¸ºç±»å˜é‡åˆ†é…å†…å­˜å¹¶ä¸”è®¾ç½®ç±»å˜é‡ä¸ºé»˜è®¤åˆå§‹å€¼ï¼Œå³é›¶å€¼</li><li>è¿™é‡Œä¸åŒ…å«finalä¿®é¥°çš„staticï¼Œå› ä¸ºfinalåœ¨ç¼–è¯‘çš„æ—¶å€™å°±ä¼šåˆ†é…äº†ï¼Œå‡†å¤‡é˜¶æ®µä¼šæ˜¾å¼åˆå§‹åŒ–</li><li>è¿™é‡Œä¸ä¼šä¸ºå®ä¾‹å˜é‡åˆ†é…åˆå§‹åŒ–ï¼Œç±»å˜é‡ä¼šåˆ†é…åœ¨æ–¹æ³•åŒºä¸­ï¼Œè€Œå®ä¾‹å˜é‡æ˜¯ä¼šéšç€å¯¹è±¡ä¸€èµ·åˆ†é…åˆ°Javaå †ä¸­ã€‚</li></ul></li><li>è§£æï¼š<ul><li>å°†å¸¸é‡æ± å†…çš„ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ã€‚</li><li>è§£ææ“ä½œå¾€å¾€ä¼šä¼´éšç€JVMåœ¨æ‰§è¡Œå®Œåˆå§‹åŒ–ä¹‹åå†æ‰§è¡Œã€‚</li><li>è§£æåŠ¨ä½œä¸»è¦é’ˆå¯¹ç±»æˆ–æ¥å£ã€å­—æ®µã€ç±»æ–¹æ³•ã€æ¥å£æ–¹æ³•ã€æ–¹æ³•ç±»å‹ç­‰ã€‚</li></ul></li></ol></li><li>åˆå§‹åŒ–ï¼š<ul><li>åˆå§‹åŒ–é˜¶æ®µå°±æ˜¯æ‰§è¡Œç±»æ„é€ å™¨æ–¹æ³•&lt;clinit&gt;()çš„è¿‡ç¨‹ã€‚</li><li>æ­¤æ–¹æ³•ä¸éœ€å®šä¹‰ï¼Œæ˜¯javacç¼–è¯‘å™¨è‡ªåŠ¨æ”¶é›†ç±»ä¸­çš„æ‰€æœ‰ç±»å˜é‡çš„èµ‹å€¼åŠ¨ä½œå’Œ<strong>é™æ€ä»£ç å—</strong>ä¸­çš„è¯­å¥åˆå¹¶è€Œæ¥çš„ã€‚</li><li>&lt;clinit&gt;()ä¸åŒäºç±»çš„æ„é€ å™¨ã€‚(æ„é€ å™¨æ˜¯è™šæ‹Ÿæœºè§†è§’ä¸‹çš„&lt;init&gt;())</li><li>è‹¥è¯¥ç±»å…·æœ‰çˆ¶ç±»ï¼ŒJVMä¼šä¿è¯å­ç±»çš„&lt;clinit&gt;()æ‰§è¡Œå‰ï¼Œçˆ¶ç±»&lt;clinit&gt;()å·²ç»æ‰§è¡Œå®Œæ¯•ã€‚</li><li>è™šæ‹Ÿæœºå¿…é¡»ä¿è¯ä¸€ä¸ªç±»çš„&lt;clinit&gt;()æ–¹æ³•åœ¨å¤šçº¿ç¨‹ä¸‹è¢«åŒæ­¥åŠ é”ã€‚</li></ul></li></ol><h3 id="ç±»åŠ è½½å™¨çš„åˆ†ç±»">ç±»åŠ è½½å™¨çš„åˆ†ç±»</h3><ul><li><p>JVMæ”¯æŒä¸¤ç§ç±»å‹çš„ç±»åŠ è½½å™¨ï¼š<strong>å¼•å¯¼ç±»åŠ è½½å™¨(Bootstrap ClassLoader)</strong> å’Œ<strong>è‡ªå®šä¹‰ç±»åŠ è½½å™¨(User-Defined ClassLoader)</strong></p></li><li><p>ä»æ¦‚å¿µä¸Šè®²ï¼Œè‡ªå®šä¹‰ç±»åŠ è½½å™¨ä¸€èˆ¬æŒ‡ç¨‹åºä¸­ç”±ç¨‹åºå‘˜è‡ªå®šä¹‰çš„ä¸€ç±»ç±»åŠ è½½å™¨ï¼Œä½†Javaè™šæ‹Ÿæœºè§„èŒƒæŒ‡å‡ºï¼Œå°†æ‰€æœ‰æ´¾ç”ŸäºæŠ½è±¡ç±»ClassLoaderçš„ç±»åŠ è½½å™¨éƒ½åˆ’åˆ†ä¸ºè‡ªå®šä¹‰ç±»åŠ è½½å™¨</p></li><li><p>æ— è®ºå®šä¹‰å’‹åˆ†ï¼Œæœ€å¸¸è§çš„ä¸‰ä¸ªç±»åŠ è½½å™¨å¦‚ä¸‹å›¾ï¼š<br>ï¼ˆå¼•å¯¼ç±»åŠ è½½å™¨ã€æ‰©å±•ç±»åŠ è½½å™¨å’Œç³»ç»Ÿç±»åŠ è½½å™¨ï¼‰<br><img src="https://lqy-blog-pic.oss-cn-shanghai.aliyuncs.com/blogImg/JVM_leijiazaiqifenlei.jpg" alt=""><br><strong>è¿™é‡Œçš„å››è€…ä¹‹é—´çš„å…³ç³»æ˜¯åŒ…å«å…³ç³»ã€‚ä¸æ˜¯ä¸Šä¸‹å±‚å…³ç³»ï¼Œä¹Ÿä¸æ˜¯çˆ¶ç±»çš„ç»§æ‰¿å…³ç³»ã€‚</strong><br>Demo:</p>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClassLoaderTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">  </span><br><span class="line">        <span class="comment">// è·å–ç³»ç»Ÿç±»åŠ è½½å™¨</span></span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">systemClassLoader</span> <span class="operator">=</span> ClassLoader.getSystemClassLoader();</span><br><span class="line">        System.out.println(systemClassLoader); <span class="comment">// sun.misc.Launcher$AppClassLoader@18b4aac2</span></span><br><span class="line">  </span><br><span class="line">        <span class="comment">// è·å–å…¶ä¸Šå±‚ï¼šæ‰©å±•ç±»åŠ è½½å™¨</span></span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">extClassLoader</span> <span class="operator">=</span> systemClassLoader.getParent();</span><br><span class="line">        System.out.println(extClassLoader); <span class="comment">// sun.misc.Launcher$ExtClassLoader@1b6d3586</span></span><br><span class="line">  </span><br><span class="line">        <span class="comment">// è·å–å…¶ä¸Šå±‚ï¼šè·å–ä¸åˆ°å¼•å¯¼ç±»åŠ è½½å™¨</span></span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">bootstrapClassLoader</span> <span class="operator">=</span> extClassLoader.getParent();</span><br><span class="line">        System.out.println(bootstrapClassLoader); <span class="comment">// null</span></span><br><span class="line">  </span><br><span class="line">        <span class="comment">// å¯¹äºç”¨æˆ·è‡ªå®šä¹‰ç±»æ¥è¯´ï¼šé»˜è®¤ä½¿ç”¨ç³»ç»Ÿç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½</span></span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">classLoader</span> <span class="operator">=</span> ClassLoaderTest.class.getClassLoader();</span><br><span class="line">        System.out.println(classLoader); <span class="comment">// sun.misc.Launcher$AppClassLoader@18b4aac2</span></span><br><span class="line">  </span><br><span class="line">        <span class="comment">// Stringç±»ä½¿ç”¨å¼•å¯¼ç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½ ---&gt; Javaçš„æ ¸å¿ƒç±»åº“éƒ½æ˜¯ä½¿ç”¨å¼•å¯¼ç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½</span></span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">classLoader1</span> <span class="operator">=</span> String.class.getClassLoader();</span><br><span class="line">        System.out.println(classLoader1); <span class="comment">// null</span></span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="å¯åŠ¨ç±»åŠ è½½å™¨-å¼•å¯¼ç±»åŠ è½½å™¨ï¼ŒBootstrap-ClassLoader">å¯åŠ¨ç±»åŠ è½½å™¨(å¼•å¯¼ç±»åŠ è½½å™¨ï¼ŒBootstrap ClassLoader)</h3><ul><li>è¿™ä¸ªç±»åŠ è½½å™¨ä½¿ç”¨C/C++è¯­è¨€å®ç°çš„ï¼ŒåµŒå¥—åœ¨JVMå†…éƒ¨</li><li>å®ƒç”¨æ¥åŠ è½½Javaçš„æ ¸å¿ƒåº“(JAVA_HOME/jre/lib/rt.jarã€resources.jaræˆ–sun.boot.class.pathè·¯å¾„ä¸‹çš„å†…å®¹)ï¼Œç”¨äºæä¾›JVMè‡ªèº«éœ€è¦çš„ç±»</li><li>å¹¶ä¸ç»§æ‰¿è‡ªjava.lang.ClassLoaderï¼Œæ²¡æœ‰çˆ¶åŠ è½½å™¨</li><li>åŠ è½½æ‰©å±•ç±»å’Œåº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼Œå¹¶æŒ‡å®šä¸ºä»–ä»¬çš„çˆ¶ç±»åŠ è½½å™¨</li><li>å¤„äºå®‰å…¨è€ƒè™‘ï¼ŒBootstrapå¯åŠ¨ç±»åŠ è½½å™¨åªåŠ è½½åŒ…åä¸ºjavaã€javaxã€sunç­‰å¼€å¤´çš„ç±»</li></ul><h3 id="æ‰©å±•ç±»åŠ è½½å™¨-Extension-ClassLoader">æ‰©å±•ç±»åŠ è½½å™¨(Extension ClassLoader)</h3><ul><li>Javaç¼–å†™</li><li>æ´¾ç”ŸäºClassLoaderç±»</li><li>çˆ¶ç±»åŠ è½½å™¨ä¸ºå¯åŠ¨ç±»åŠ è½½å™¨</li><li>ä»java.ext.dirsç³»ç»Ÿå±æ€§æ‰€æŒ‡å®šçš„ç›®å½•ä¸­åŠ è½½ç±»åº“ï¼Œæˆ–ä»JDKçš„å®‰è£…ç›®å½•jre/lib/extå­ç›®å½•(æ‰©å±•ç›®å½•)ä¸‹åŠ è½½ç±»åº“ã€‚å¦‚æœç”¨æˆ·åˆ›å»ºçš„JARæ”¾åœ¨æ­¤ç›®å½•ä¸‹ï¼Œä¹Ÿä¼šè‡ªåŠ¨ç”±æ‰©å±•ç±»åŠ è½½å™¨åŠ è½½</li></ul><h3 id="åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨-ç³»ç»ŸåŠ è½½å™¨ï¼ŒAppClassLoader">åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨(ç³»ç»ŸåŠ è½½å™¨ï¼ŒAppClassLoader)</h3><ul><li>Javaç¼–å†™</li><li>æ´¾ç”ŸäºClassLoaderç±»</li><li>çˆ¶ç±»åŠ è½½å™¨ä¸ºæ‰©å±•ç±»åŠ è½½å™¨</li><li>å®ƒè´Ÿè´£åŠ è½½ç¯å¢ƒå˜é‡classpathæˆ–ç³»ç»Ÿå±æ€§ java.class.path æŒ‡å®šè·¯å¾„ä¸‹çš„ç±»åº“</li><li>è¯¥ç±»åŠ è½½æ˜¯ç¨‹åºä¸­é»˜è®¤çš„ç±»åŠ è½½å™¨ï¼Œä¸€èˆ¬æ¥è¯´ï¼ŒJavaåº”ç”¨çš„ç±»éƒ½æ˜¯ç”±å®ƒå®ŒæˆåŠ è½½çš„</li><li>é€šè¿‡ClassLoader#getSystemClassLoader()æ–¹æ³•å¯ä»¥è·å–åˆ°è¯¥ç±»åŠ è½½å™¨</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClassLoaderTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;*************å¯åŠ¨ç±»åŠ è½½å™¨*************&quot;</span>);</span><br><span class="line">        <span class="comment">// è·å–BootstrapClassLoaderèƒ½å¤ŸåŠ è½½çš„apiè·¯å¾„</span></span><br><span class="line">        URL[] urls = sun.misc.Launcher.getBootstrapClassPath().getURLs();</span><br><span class="line">        <span class="keyword">for</span>(URL element : urls)&#123;</span><br><span class="line">            System.out.println(element.toExternalForm());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            *************å¯åŠ¨ç±»åŠ è½½å™¨*************</span></span><br><span class="line"><span class="comment">            file:/E:/Java/jdk8/jdk1.8.0_251/jre/lib/resources.jar</span></span><br><span class="line"><span class="comment">            file:/E:/Java/jdk8/jdk1.8.0_251/jre/lib/rt.jar</span></span><br><span class="line"><span class="comment">            file:/E:/Java/jdk8/jdk1.8.0_251/jre/lib/sunrsasign.jar</span></span><br><span class="line"><span class="comment">            file:/E:/Java/jdk8/jdk1.8.0_251/jre/lib/jsse.jar</span></span><br><span class="line"><span class="comment">            file:/E:/Java/jdk8/jdk1.8.0_251/jre/lib/jce.jar</span></span><br><span class="line"><span class="comment">            file:/E:/Java/jdk8/jdk1.8.0_251/jre/lib/charsets.jar</span></span><br><span class="line"><span class="comment">            file:/E:/Java/jdk8/jdk1.8.0_251/jre/lib/jfr.jar</span></span><br><span class="line"><span class="comment">            file:/E:/Java/jdk8/jdk1.8.0_251/jre/classes</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;**************æ‰©å±•ç±»åŠ è½½å™¨**************&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">extDirs</span> <span class="operator">=</span> System.getProperty(<span class="string">&quot;java.ext.dirs&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span>(String path : extDirs.split(<span class="string">&quot;;&quot;</span>))&#123;</span><br><span class="line">            System.out.println(path);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            **************æ‰©å±•ç±»åŠ è½½å™¨**************</span></span><br><span class="line"><span class="comment">            E:\Java\jdk8\jdk1.8.0_251\jre\lib\ext</span></span><br><span class="line"><span class="comment">            C:\Windows\Sun\Java\lib\ext</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç”¨æˆ·è‡ªå®šä¹‰ç±»åŠ è½½å™¨">ç”¨æˆ·è‡ªå®šä¹‰ç±»åŠ è½½å™¨</h3><ul><li>åœ¨Javaçš„æ—¥å¸¸åº”ç”¨ç¨‹åºå¼€å‘ä¸­ï¼Œç±»çš„åŠ è½½å‡ ä¹æ˜¯ç”±ä¸Šè¿°ä¸‰ç§ç±»åŠ è½½å™¨ç›¸äº’é…åˆæ‰§è¡Œçš„ï¼Œåœ¨å¿…è¦æ—¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Œç±»å®šåˆ¶ç±»çš„åŠ è½½æ–¹å¼ã€‚</li><li>ç›®çš„ï¼š<ul><li>éš”ç¦»åŠ è½½å™¨</li><li>ä¿®æ”¹ç±»åŠ è½½å™¨</li><li>æ‰©å±•åŠ è½½æº</li><li>é˜²æ­¢æºç æ³„éœ²</li></ul></li></ul><h3 id="è·å–ClassLoaderçš„æ–¹å¼">è·å–ClassLoaderçš„æ–¹å¼</h3><ol><li><code>class.getClassLoader()</code>ï¼šè·å–å½“å‰ç±»çš„ClassLoader</li><li><code>Thread.currentThread().getContextClassLoader()</code>ï¼šè·å–å½“å‰çº¿ç¨‹ä¸Šä¸‹æ–‡çš„ClassLoader</li><li><code>ClassLoader.getSystemClassLoader()</code>ï¼šè·å–ç³»ç»Ÿçš„ClassLoader</li><li><code>DriverManager.getCallerClassLoader()</code>ï¼šè·å–è°ƒç”¨è€…çš„ClassLoader</li></ol><h3 id="åŒäº²å§”æ´¾æœºåˆ¶">åŒäº²å§”æ´¾æœºåˆ¶</h3><ul><li>Javaè™šæ‹Ÿæœºå¯¹classæ–‡ä»¶é‡‡ç”¨æŒ‰éœ€åŠ è½½çš„æ–¹å¼ï¼ŒåŠ è½½æ—¶é‡‡ç”¨åŒäº²å§”æ´¾è®°è‡³ï¼Œå³æŠŠè¯·æ±‚äº¤ç”±çˆ¶ç±»å¤„ç†ï¼Œå®ƒæ˜¯ä¸€ç§ä»»åŠ¡å§”æ´¾æ¨¡å¼ã€‚</li><li>åŸç†ï¼š<ol><li>å¦‚æœä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°äº†ç±»åŠ è½½è¯·æ±‚ï¼Œå®ƒä¸ä¼šå…ˆè‡ªå·±åŠ è½½ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ‰˜ç»™çˆ¶ç±»çš„åŠ è½½å™¨å»æ‰§è¡Œï¼›</li><li>å¦‚æœçˆ¶ç±»åŠ è½½å™¨è¿˜å­˜åœ¨å…¶çˆ¶ç±»åŠ è½½å™¨ï¼Œåˆ™è¿›ä¸€æ­¥å‘ä¸Šå±‚å§”æ‰˜ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°è¯·æ±‚æœ€ç»ˆè¾¾åˆ°é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨ï¼›</li><li>å¦‚æœçˆ¶ç±»åŠ è½½å™¨å¯ä»¥å®ŒæˆåŠ è½½ä»»åŠ¡ï¼Œå°±æˆåŠŸè¿”å›ï¼Œå€˜è‹¥çˆ¶ç±»åŠ è½½å™¨æ— æ³•å®Œæˆæ­¤æ¬¡åŠ è½½ä»»åŠ¡ï¼Œå­åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±å»åŠ è½½<br><img src="https://lqy-blog-pic.oss-cn-shanghai.aliyuncs.com/blogImg/shuangqinweipai.jpg" alt=""></li></ol></li><li>ä¼˜åŠ¿ï¼š<ol><li>é¿å…ç±»çš„é‡å¤åŠ è½½</li><li>ä¿æŠ¤ç¨‹åºå®‰å…¨ï¼Œé˜²æ­¢æ ¸å¿ƒAPIè¢«éšæ„ç¯¡æ”¹</li></ol></li></ul><h3 id="æ²™ç®±å®‰å…¨æœºåˆ¶">æ²™ç®±å®‰å…¨æœºåˆ¶</h3><ul><li>å°†Javaä»£ç é™å®šåœ¨JVMç‰¹å®šçš„è¿è¡ŒèŒƒå›´ä¸­ï¼Œå¹¶ä¸”ä¸¥æ ¼é™åˆ¶ä»£ç å¯¹æœ¬åœ°ç³»ç»Ÿèµ„æºè®¿é—®ï¼Œé€šè¿‡è¿™æ ·çš„æªæ–½æ¥ä¿è¯ä»£ç çš„æœ‰æ•ˆéš”ç¦»ï¼Œé˜²æ­¢å¯¹æœ¬åœ°ç³»ç»Ÿé€ æˆç ´åã€‚</li><li>å¦‚æœæˆ‘ä»¬è‡ªå®šä¹‰ä¸€ä¸ªç±»åä¸ºStringçš„ç±»ï¼Œå¹¶ä¸”åŒ…ä¸ºjava.langã€‚å¦‚æœæ²¡æœ‰æ²™ç®±å®‰å…¨æœºåˆ¶ï¼Œå¯èƒ½ä¼šæ±¡æŸ“åˆ°åŸæœ¬jdkä¸­çš„Stringç±»ã€‚æ ¹æ®åŒäº²å§”æ´¾æœºåˆ¶ï¼Œå§”æ‰˜åˆ°é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨ï¼Œå°±å¯ä»¥å®ŒæˆStringçš„åŠ è½½ï¼Œé¿å…äº†ä»£ç æ±¡æŸ“ã€‚</li></ul><h3 id="çº¿ç¨‹">çº¿ç¨‹</h3><ul><li>JVMå…è®¸å¤šçº¿ç¨‹å¹¶è¡Œæ‰§è¡Œ</li><li>åœ¨Hotspot JVMä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½ä¸æ“ä½œç³»ç»Ÿçš„æœ¬åœ°çº¿ç¨‹ç›´æ¥æ˜ å°„ã€‚å½“ä¸€ä¸ªJavaçº¿ç¨‹å‡†å¤‡å¥½æ‰§è¡Œåï¼Œæ­¤æ—¶ä¸€ä¸ªæ“ä½œç³»ç»Ÿçš„æœ¬åœ°çº¿ç¨‹ä¹ŸåŒæ—¶åˆ›å»ºã€‚Javaçº¿ç¨‹æ‰§è¡Œç»ˆæ­¢åï¼Œæœ¬åœ°çº¿ç¨‹ä¹Ÿä¼šå›æ”¶ã€‚</li><li>æ“ä½œç³»ç»Ÿè´Ÿè´£æ‰€æœ‰çº¿ç¨‹çš„å®‰æ’è°ƒåº¦åˆ°ä»»ä½•ä¸€ä¸ªCPUä¸Šã€‚ä¸€æ—¦æœ¬åœ°çº¿ç¨‹åˆå§‹åŒ–æˆåŠŸï¼Œå®ƒå°±ä¼šè°ƒç”¨Javaçº¿ç¨‹ä¸­çš„run()æ–¹æ³•ã€‚</li></ul><h2 id="è¿è¡Œæ—¶æ•°æ®åŒº">è¿è¡Œæ—¶æ•°æ®åŒº</h2><p><img src="https://lqy-blog-pic.oss-cn-shanghai.aliyuncs.com/blogImg/JVM_yunxingshishujuqu.jpg" alt=""></p><p><img src="https://lqy-blog-pic.oss-cn-shanghai.aliyuncs.com/blogImg/JVM_yunxingshishujuqu2.jpg" alt=""></p><ul><li>Javaè™šæ‹Ÿæœºå®šä¹‰äº†è‹¥å¹²ç§ç¨‹åºè¿è¡ŒæœŸé—´ä¼šä½¿ç”¨åˆ°çš„è¿è¡Œæ—¶æ•°æ®åŒºï¼Œå…¶ä¸­æœ‰ä¸€äº›ä¼šéšç€è™šæ‹Ÿæœºå¯åŠ¨è€Œåˆ›å»ºï¼Œéšç€è™šæ‹Ÿæœºçš„é€€å‡ºè€Œé”€æ¯ã€‚å¦å¤–ä¸€äº›åˆ™æ˜¯ä¸çº¿ç¨‹ä¸€ä¸€å¯¹åº”ï¼Œè¿™äº›ä¸çº¿ç¨‹å¯¹åº”çš„æ•°æ®åŒºä¼šéšç€çº¿ç¨‹å¼€å§‹å’Œç»“æŸè€Œåˆ›å»ºå’Œé”€æ¯ã€‚</li><li>ä¸Šé¢ç¬¬ä¸€å¼ å›¾ä¸­ï¼Œçº¢è‰²åŒºåŸŸ(æ–¹æ³•åŒºå’Œå †)ä¸ºä¸€ä¸ªè¿›ç¨‹å…±äº«çš„åŒºåŸŸï¼Œè€Œç°è‰²éƒ¨åˆ†(PCå¯„å­˜å™¨ã€æœ¬åœ°æ–¹æ³•æ ˆå’Œè™šæ‹Ÿæœºæ ˆ)åˆ™ä¸ºä¸€ä¸ªçº¿ç¨‹ä¸€ä»½ã€‚</li><li>æ¯ä¸ªJVMåªæœ‰ä¸€ä¸ªRuntimeå®ä¾‹ã€‚å³ä¸ºè¿è¡Œæ—¶ç¯å¢ƒã€‚</li></ul><h3 id="ç¨‹åºè®¡æ•°å™¨-PCå¯„å­˜å™¨ï¼ŒProgram-Counter-Register">ç¨‹åºè®¡æ•°å™¨(PCå¯„å­˜å™¨ï¼ŒProgram Counter Register)</h3><h4 id="æ¦‚è¿°">æ¦‚è¿°</h4><ul><li>å­˜å‚¨æŒ‡ä»¤ç›¸å…³çš„ç°åœºä¿¡æ¯ï¼ŒCPUåªæœ‰æŠŠæ•°æ®è£…è½½åˆ°å¯„å­˜å™¨æ‰èƒ½å¤Ÿè¿è¡Œã€‚</li><li>è¿™é‡Œçš„PCå¯„å­˜å™¨åªæ˜¯JVMå¯¹ç‰©ç†PCå¯„å­˜å™¨çš„ä¸€ç§æŠ½è±¡æ¨¡æ‹Ÿï¼Œå¹¶ä¸æ˜¯ç‰©ç†å¯„å­˜å™¨ã€‚</li><li>ä½œç”¨ï¼šPCå¯„å­˜å™¨ç”¨æ¥å­˜å‚¨æŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼Œä¹Ÿå³å°†è¦æ‰§è¡Œçš„æŒ‡ä»¤ä»£ç ï¼Œç”±æ‰§è¡Œå¼•æ“è¯»å–ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚(å’Œè®¡ç»„å­¦çš„é‚£ä¸ªåŠŸèƒ½ç±»ä¼¼ã€‚ã€‚)</li><li>å®ƒæ˜¯ä¸€å—å¾ˆå°çš„å†…å­˜ç©ºé—´ï¼Œè¿è¡Œé€Ÿåº¦æœ€å¿«çš„å­˜å‚¨åŒºåŸŸ</li><li>åœ¨JVMè§„èŒƒä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰å®ƒè‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨ï¼Œæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸä¿æŒä¸€è‡´ã€‚</li><li>ä»»ä½•æ—¶é—´ä¸€ä¸ªçº¿ç¨‹éƒ½åªæœ‰ä¸€ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„å½“å‰æ–¹æ³•ã€‚ç¨‹åºè®¡æ•°å™¨ä¼šå­˜å‚¨å½“å‰çº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„Javaæ–¹æ³•çš„JVMæŒ‡ä»¤åœ°å€ï¼›æˆ–è€…ï¼Œå¦‚æœæ˜¯åœ¨æ‰§è¡Œnativeæ–¹æ³•ï¼Œåˆ™æ˜¯æœªæŒ‡å®šå€¼(undefined)</li><li>å®ƒæ˜¯ç¨‹åºæ§åˆ¶æµçš„æŒ‡ç¤ºå™¨ï¼Œåˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸å¤„ç†ã€çº¿ç¨‹æ¢å¤ç­‰åŸºç¡€åŠŸèƒ½éƒ½éœ€è¦ä¾èµ–å®ƒæ¥å®Œæˆã€‚</li><li>å­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œæ—¶æ˜¯é€šè¿‡æ”¹å˜ç¨‹åºè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ã€‚</li><li>å®ƒæ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨Javaè™šæ‹Ÿæœºè§„èŒƒä¸­æ²¡æœ‰è§„å®šä»»ä½•OutOfMemoryErroræƒ…å†µçš„åŒºåŸŸã€‚</li></ul><h4 id="é—®é¢˜">é—®é¢˜</h4><ol><li>ä½¿ç”¨PCå¯„å­˜å™¨å­˜å‚¨å­—èŠ‚ç æŒ‡ä»¤åœ°å€æœ‰ä»€ä¹ˆç”¨ï¼Ÿ(ä¸ºä»€ä¹ˆä½¿ç”¨PCå¯„å­˜å™¨è®°å½•å½“å‰çº¿ç¨‹çš„æ‰§è¡Œåœ°å€å‘¢ï¼Ÿ)<br>å› ä¸ºCPUéœ€è¦ä¸åœåœ°åˆ‡æ¢å„ä¸ªçº¿ç¨‹ï¼Œè¿™æ—¶å€™åˆ‡æ¢å›æ¥ä»¥åï¼Œå°±éœ€è¦çŸ¥é“æ¥ç€ä»å“ªå¼€å§‹ç»§ç»­æ‰§è¡Œã€‚JVMçš„å­—èŠ‚ç è§£é‡Šå™¨å°±éœ€è¦é€šè¿‡æ”¹å˜PCå¯„å­˜å™¨çš„å€¼æ¥æ˜ç¡®ä¸‹ä¸€æ¡åº”è¯¥æ‰§è¡Œä»€ä¹ˆæ ·çš„å­—èŠ‚ç æŒ‡ä»¤ã€‚</li><li>PCå¯„å­˜å™¨ä¸ºä»€ä¹ˆä¼šè¢«è®¾å®šä¸ºçº¿ç¨‹ç§æœ‰ï¼Ÿ<br>å¤šçº¿ç¨‹å°±æ˜¯åœ¨ä¸€ä¸ªç‰¹å®šçš„æ—¶é—´å†…åªä¼šæ‰§è¡Œå…¶ä¸­æŸä¸€ä¸ªçº¿ç¨‹ï¼ŒCPUä¼šä¸åœåœ°åšä»»åŠ¡åˆ‡æ¢ï¼Œå› æ­¤å°±ä¼šæ¶‰åŠåˆ°ä¸­æ–­å’Œæ¢å¤ã€‚ä¸ºäº†èƒ½å¤Ÿå‡†ç¡®åœ°è®°å½•æ¯ä¸ªçº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„å½“å‰å­—èŠ‚ç æŒ‡ä»¤åœ°å€ï¼Œå°±å¿…é¡»ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ†é…ä¸€ä¸ªPCå¯„å­˜å™¨ã€‚</li></ol><h3 id="è™šæ‹Ÿæœºæ ˆ">è™šæ‹Ÿæœºæ ˆ</h3><h4 id="æ¦‚è¿°-2">æ¦‚è¿°</h4><ul><li>æ ˆæ˜¯è¿è¡Œæ—¶çš„å•ä½ï¼Œå †æ˜¯å­˜å‚¨çš„å•ä½</li><li>ç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ä¸€è‡´ã€‚å³æ¯ä¸ªçº¿ç¨‹åœ¨åˆ›å»ºæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæœºæ ˆï¼Œå…¶å†…éƒ¨ä¿å­˜ä¸€ä¸ªä¸ªçš„æ ˆå¸§(Stack Frame)ï¼Œå¯¹åº”ç€ä¸€æ¬¡æ¬¡çš„Javaæ–¹æ³•è°ƒç”¨ã€‚æ˜¯çº¿ç¨‹ç§æœ‰çš„ã€‚</li><li>ä½œç”¨ï¼šç®¡Javaç¨‹åºçš„è¿è¡Œï¼Œä¿å­˜æ–¹æ³•çš„å±€éƒ¨å˜é‡ã€éƒ¨åˆ†ç»“æœã€‚å¹¶å‚ä¸æ–¹æ³•çš„è°ƒç”¨å’Œè¿”å›ã€‚</li><li>å¯¹äºæ ˆæ¥è¯´ï¼Œä¸å­˜åœ¨åƒåœ¾å›æ”¶é—®é¢˜ã€‚</li><li>æ ˆä¸­å¯èƒ½å‡ºç°çš„å¼‚å¸¸ï¼š<ul><li>å¦‚æœé‡‡ç”¨å›ºå®šå¤§å°çš„Javaè™šæ‹Ÿæœºæ ˆï¼Œé‚£æ¯ä¸€ä¸ªçº¿ç¨‹çš„Javaè™šæ‹Ÿæœºæ ˆå®¹é‡å¯ä»¥åœ¨çº¿ç¨‹åˆ›å»ºçš„æ—¶å€™ç‹¬ç«‹é€‰å®šã€‚å¦‚æœçº¿ç¨‹è¯·æ±‚åˆ†é…çš„å®¹é‡è¶…è¿‡Javaè™šæ‹Ÿæœºæ ˆå…è®¸çš„æœ€å¤§å®¹é‡ï¼ŒJavaè™šæ‹Ÿæœºå°†ä¼šæŠ›å‡º<strong>StackOverflowError</strong>å¼‚å¸¸ã€‚</li><li>å¦‚æœJavaè™šæ‹Ÿæœºæ ˆå¯ä»¥åŠ¨æ€æ‰©å±•ï¼Œå¹¶ä¸”åœ¨å°è¯•æ‰©å±•çš„æ—¶å€™æ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿçš„å†…å­˜ï¼Œæˆ–è€…åœ¨åˆ›å»ºæ–°çš„çº¿ç¨‹æ—¶æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜åŒºåˆ›å»ºå¯¹åº”çš„è™šæ‹Ÿæœºæ ˆï¼Œé‚£Javaè™šæ‹Ÿæœºå°†ä¼šæŠ›å‡ºä¸€ä¸ª<strong>OutOfMemoryError</strong>å¼‚å¸¸ã€‚</li></ul></li><li>è®¾ç½®æ ˆå†…å­˜å¤§å°ï¼š<code>-Xss</code></li></ul><h4 id="æ ˆçš„å­˜å‚¨å•ä½">æ ˆçš„å­˜å‚¨å•ä½</h4><ul><li>æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„æ ˆï¼Œæ ˆä¸­çš„æ•°æ®éƒ½æ˜¯ä»¥**æ ˆå¸§(Stack Frame)**çš„æ ¼å¼å­˜åœ¨</li><li>åœ¨è¿™ä¸ªçº¿ç¨‹ä¸Šæ­£åœ¨æ‰§è¡Œçš„æ¯ä¸ªæ–¹æ³•éƒ½å„è‡ªå¯¹åº”ä¸€ä¸ªæ ˆå¸§</li><li>æ ˆå¸§æ˜¯ä¸€ä¸ªå†…å­˜åŒºå—ï¼Œæ˜¯ä¸€ä¸ªæ•°æ®é›†ï¼Œç»´ç³»ç€æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­çš„å„ç§æ•°æ®ä¿¡æ¯</li><li>JVMå¯¹Javaæ ˆçš„æ“ä½œï¼šå‹æ ˆå’Œå‡ºæ ˆ</li><li>å½“å‰æ‰§è¡Œçš„æ–¹æ³•çš„æ ˆå¸§ï¼šå½“å‰æ ˆå¸§-&gt;å½“å‰æ–¹æ³•-&gt;å½“å‰ç±»</li><li>ä¸åŒçº¿ç¨‹ä¸­æ‰€åŒ…å«çš„æ ˆå¸§æ˜¯ä¸å…è®¸å­˜åœ¨äº’ç›¸å¼•ç”¨çš„</li><li>Javaæ–¹æ³•çš„ä¸¤ç§è¿”å›æ–¹å¼ï¼šä¸€æ˜¯æ­£å¸¸æ”¾å›ï¼Œreturnï¼›å¦ä¸€ç§æ˜¯æŠ›å‡ºå¼‚å¸¸ã€‚ä¸ç®¡ä½¿ç”¨å“ªç§æ–¹å¼ï¼Œéƒ½ä¼šå¯¼è‡´æ ˆå¸§è¢«å¼¹å‡ºã€‚</li></ul><h4 id="æ ˆå¸§çš„å†…éƒ¨ç»“æ„">æ ˆå¸§çš„å†…éƒ¨ç»“æ„</h4><ul><li>å±€éƒ¨å˜é‡è¡¨(Local Variables)</li><li>æ“ä½œæ•°æ ˆ(Operand Stack)(æˆ–è¡¨è¾¾å¼æ ˆ)</li><li>åŠ¨æ€é“¾æ¥(Dynamic Linking)(æˆ–æŒ‡å‘è¿è¡Œæ—¶å¸¸é‡æ± çš„æ–¹æ³•å¼•ç”¨)</li><li>æ–¹æ³•è¿”å›åœ°å€(Return Address)(æˆ–æ–¹æ³•æ­£å¸¸é€€å‡ºæˆ–è€…å¼‚å¸¸é€€å‡ºçš„å®šä¹‰)</li><li>ä¸€äº›é™„åŠ ä¿¡æ¯<br>PSï¼šæ–¹æ³•è¿”å›åœ°å€ã€åŠ¨æ€é“¾æ¥å’Œä¸€äº›é™„åŠ ä¿¡æ¯ä¹Ÿç§°ä½œå¸§æ•°æ®åŒº</li></ul><h5 id="å±€éƒ¨å˜é‡è¡¨-Local-Variables">å±€éƒ¨å˜é‡è¡¨(Local Variables)</h5><ul><li><p>ä¹Ÿç§°å±€éƒ¨å˜é‡æ•°ç»„æˆ–æœ¬åœ°å˜é‡è¡¨</p></li><li><p>å®šä¹‰ä¸€ä¸ª<strong>æ•°å­—æ•°ç»„</strong>ï¼Œä¸»è¦ç”¨äºå­˜å‚¨æ–¹æ³•å‚æ•°å’Œå®šä¹‰åœ¨æ–¹æ³•ä½“å†…çš„å±€éƒ¨å˜é‡(å„ç±»åŸºæœ¬æ•°æ®ç±»å‹ã€å¯¹è±¡å¼•ç”¨(reference)ã€returnAddressç±»å‹)</p></li><li><p>å±€éƒ¨å˜é‡è¡¨å»ºç«‹åœ¨çº¿ç¨‹çš„æ ˆä¸Šï¼Œæ˜¯çº¿ç¨‹ç§æœ‰çš„æ•°æ®ï¼Œå› æ­¤ä¸å­˜åœ¨æ•°æ®å®‰å…¨é—®é¢˜</p></li><li><p>å±€éƒ¨å˜é‡è¡¨æ‰€éœ€çš„å®¹é‡å¤§å°æ˜¯åœ¨<strong>ç¼–è¯‘æœŸ</strong>ç¡®å®šçš„ï¼Œå¹¶ä¿å­˜åœ¨æ–¹æ³•çš„Codeå±æ€§çš„maximum local variablesæ•°æ®é¡¹ä¸­ã€‚åœ¨æ–¹æ³•è¿è¡ŒæœŸé—´æ˜¯ä¸ä¼šæ”¹å˜å±€éƒ¨å˜é‡è¡¨çš„å¤§å°çš„ã€‚</p></li><li><p>æ–¹æ³•åµŒå¥—è°ƒç”¨çš„æ¬¡æ•°ç”±æ ˆçš„å¤§å°å†³å®šã€‚ç«™è¶Šå¤§ï¼Œæ–¹æ³•åµŒå¥—è°ƒç”¨æ¬¡æ•°è¶Šå¤šã€‚</p></li><li><p>å±€éƒ¨å˜é‡è¡¨ä¸­çš„å˜é‡åªåœ¨å½“å‰æ–¹æ³•è°ƒç”¨ä¸­æœ‰æ•ˆã€‚åœ¨æ–¹æ³•æ‰§è¡Œæ—¶ï¼Œè™šæ‹Ÿæœºé€šè¿‡ä½¿ç”¨å±€éƒ¨å˜é‡è¡¨å®Œæˆå‚æ•°å€¼åˆ°å‚æ•°å˜é‡åˆ—è¡¨çš„ä¼ é€’è¿‡ç¨‹ã€‚å½“æ–¹æ³•è°ƒç”¨ç»“æŸåï¼Œéšç€æ–¹æ³•æ ˆå¸§çš„é”€æ¯ï¼Œå±€éƒ¨å˜é‡è¡¨ä¹Ÿä¼šéšä¹‹é”€æ¯ã€‚</p></li><li><p>Slot:</p><ul><li>å±€éƒ¨å˜é‡è¡¨ï¼Œæœ€åŸºæœ¬çš„å­˜å‚¨å•å…ƒæ˜¯Slot(å˜é‡æ§½)</li><li>32ä½ä»¥å†…çš„ç±»å‹åªå ç”¨ä¸€ä¸ªslot(åŒ…æ‹¬returnAddressç±»å‹)ï¼›64ä½çš„ç±»å‹(longå’Œdouble)å ç”¨ä¸¤ä¸ªslot<blockquote><p>byteã€shortã€charåœ¨å­˜å‚¨å‰è¢«è½¬æ¢ä¸ºintï¼Œbooleanä¹Ÿè¢«è½¬æ¢ä¸ºint(0ä¸ºfalseï¼Œ1ä¸ºtrue)</p></blockquote></li><li>JVMä¼šä¸ºå±€éƒ¨å˜é‡è¡¨ä¸­çš„æ¯ä¸€ä¸ªSlotéƒ½åˆ†é…ä¸€ä¸ªè®¿é—®ç´¢å¼•ï¼Œé€šè¿‡è¿™ä¸ªç´¢å¼•å³å¯è®¿é—®åˆ°å±€éƒ¨å˜é‡è¡¨ä¸­æŒ‡å®šçš„å±€éƒ¨å˜é‡å€¼</li><li>å±€éƒ¨å˜é‡æŒ‰ç…§å£°æ˜çš„é¡ºåºè¢«å¤åˆ¶åˆ°å±€éƒ¨å˜é‡è¡¨çš„æ¯ä¸€ä¸ªSlotä¸Š</li><li>å¦‚æœå½“å‰å¸§æ˜¯ç”±æ„é€ æ–¹æ³•æˆ–è€…å®ä¾‹æ–¹æ³•åˆ›å»ºçš„ï¼Œé‚£ä¹ˆ<strong>è¯¥å¯¹è±¡å¼•ç”¨thiså°†ä¼šå­˜æ”¾åœ¨indexä¸º0çš„slotå¤„</strong>ï¼Œå…¶ä½™çš„å‚æ•°æŒ‰ç…§å‚æ•°è¡¨é¡ºåºç»§ç»­æ’åˆ—</li></ul><p>Demo:</p>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LocalVariablesTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">LocalVariablesTest</span> <span class="variable">test</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LocalVariablesTest</span>();</span><br><span class="line">        <span class="type">double</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">9.6</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">6</span>;</span><br><span class="line">        test.add(a, b);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">add</span><span class="params">(<span class="type">double</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;a = &quot;</span> + a);</span><br><span class="line">        System.out.println(<span class="string">&quot;b = &quot;</span> + b);</span><br><span class="line">        System.out.println(<span class="string">&quot;a + b = &quot;</span> + (a + b));</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://lqy-blog-pic.oss-cn-shanghai.aliyuncs.com/blogImg/JVM_jububianliangbiao.jpg" alt=""></p><ul><li>æ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡è¡¨ä¸­çš„æ§½ä½æ˜¯å¯ä»¥é‡å¤åˆ©ç”¨çš„ã€‚å¦‚æœä¸€ä¸ªå±€éƒ¨å˜é‡è¿‡äº†å…¶ä½œç”¨åŸŸï¼Œé‚£ä¹ˆåœ¨å…¶ä½œç”¨åŸŸä¹‹åç”³æ˜çš„æ–°çš„å±€éƒ¨å˜é‡å°±å¾ˆå¯èƒ½ä¼šæœç”¨è¿‡æœŸå±€éƒ¨å˜é‡çš„æ§½ä½ï¼Œä»è€ŒèŠ‚çœèµ„æº</li></ul>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        b = a + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> a + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶ä¸Šè¿°æ–¹æ³•æœ‰å››ä¸ªå˜é‡ï¼Œä½†æ˜¯å±€éƒ¨å˜é‡è¡¨çš„æ§½ä½åªæœ‰ä¸‰ä¸ªã€‚å˜é‡båœ¨å‡ºäº†æ‹¬å·åï¼Œè¿‡äº†å…¶ä½œç”¨åŸŸã€‚å› æ­¤ä¹‹åå£°æ˜çš„å˜é‡cå äº†ä¹‹å‰bçš„slotçš„ä½ç½®ã€‚è¿™æ ·å°±èŠ‚çœäº†èµ„æºã€‚<br><img src="https://lqy-blog-pic.oss-cn-shanghai.aliyuncs.com/blogImg/JVM_jububianliangbiao2.jpg" alt=""></p></li></ul><p>å˜é‡çš„åˆ†ç±»ï¼š</p><ul><li>æŒ‰ç…§æ•°æ®ç±»å‹åˆ†ï¼š1. åŸºæœ¬æ•°æ®ç±»å‹ 2. å¼•ç”¨æ•°æ®ç±»å‹</li><li>æŒ‰ç…§åœ¨ç±»ä¸­å£°æ˜çš„ä½ç½®åˆ†ï¼š<ol><li>æˆå‘˜å˜é‡ï¼šåœ¨ä½¿ç”¨å‰ï¼Œéƒ½ç»å†è¿‡é»˜è®¤åˆå§‹åŒ–èµ‹å€¼<ul><li>ç±»å˜é‡ï¼šlinkingçš„prepareé˜¶æ®µï¼šç»™ç±»å˜é‡é»˜è®¤èµ‹å€¼ â€”&gt; initialé˜¶æ®µï¼šç»™ç±»å˜é‡æ˜¾å¼èµ‹å€¼å³é™æ€ä»£ç å—èµ‹å€¼</li><li>å®ä¾‹å˜é‡ï¼šéšç€å¯¹è±¡çš„åˆ›å»ºï¼Œä¼šåœ¨å¯¹ç©ºé—´ä¸­åˆ†é…å®ä¾‹å˜é‡ç©ºé—´ï¼Œå¹¶è¿›è¡Œé»˜è®¤èµ‹å€¼</li></ul></li><li>å±€éƒ¨å˜é‡ï¼šåœ¨ä½¿ç”¨å‰ï¼Œå¿…é¡»è¿›è¡Œæ˜¾å¼èµ‹å€¼ã€‚å¦åˆ™ç¼–è¯‘ä¸é€šè¿‡</li></ol></li></ul><ol><li>åœ¨æ ˆå¸§ä¸­ï¼Œä¸æ€§èƒ½è°ƒä¼˜å…³ç³»æœ€å¯†åˆ‡çš„éƒ¨åˆ†å°±æ˜¯å±€éƒ¨å˜é‡è¡¨ã€‚åœ¨æ–¹æ³•æ‰§è¡Œæ—¶ï¼Œè™šæ‹Ÿæœºä½¿ç”¨å±€éƒ¨å˜é‡è¡¨å®Œæˆæ–¹æ³•çš„ä¼ é€’ã€‚å¦‚æœå±€éƒ¨å˜é‡è¡¨ä¸­çš„å˜é‡ä¸å­˜åœ¨äº†ï¼ŒæŒ‡å‘å †ç©ºé—´çš„æŒ‡é’ˆä¹Ÿå°±ä¸å­˜åœ¨äº†ï¼Œé‚£ä¹ˆå †ä¸­åƒåœ¾å°±éœ€è¦è¢«å›æ”¶</li><li>å±€éƒ¨å˜é‡è¡¨ä¸­çš„å˜é‡ä¹Ÿæ˜¯é‡è¦çš„åƒåœ¾å›æ”¶æ ¹èŠ‚ç‚¹ï¼Œåªè¦è¢«å±€éƒ¨å˜é‡è¡¨ä¸­ç›´æ¥æˆ–é—´æ¥å¼•ç”¨çš„å¯¹è±¡éƒ½ä¸ä¼šè¢«å›æ”¶</li></ol><h5 id="æ“ä½œæ•°æ ˆ-Operand-Stack">æ“ä½œæ•°æ ˆ(Operand Stack)</h5><ul><li>æ¯ä¸ªç‹¬ç«‹çš„æ ˆå¸§ä¸­é™¤äº†åŒ…å«å±€éƒ¨å˜é‡è¡¨ä»¥å¤–ï¼Œè¿˜åŒ…å«ä¸€ä¸ªåè¿›å…ˆå‡ºçš„æ“ä½œæ•°æ ˆï¼Œä¹Ÿå¯ä»¥æˆä¸ºè¡¨è¾¾å¼æ ˆã€‚</li><li>ä¸»è¦ç”¨äºä¿å­˜è®¡ç®—è¿‡ç¨‹çš„ä¸­é—´ç»“æœï¼ŒåŒæ—¶ä½œä¸ºè®¡ç®—è¿‡ç¨‹ä¸­å˜é‡ä¸´æ—¶çš„å­˜å‚¨ç©ºé—´ã€‚</li><li>å¦‚æœè¢«è°ƒç”¨çš„æ–¹æ³•å¸¦æœ‰è¿”å›å€¼ï¼Œå…¶è¿”å›å€¼å°†ä¼šè¢«å‹å…¥å½“å‰æ ˆå¸§çš„æ“ä½œæ•°æ ˆä¸­ï¼Œå¹¶æ›´æ–°PCå¯„å­˜å™¨ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ã€‚</li><li>ä¸€ä¸ªæ–¹æ³•åˆšå¼€å§‹æ‰§è¡Œæ—¶ï¼Œæ ˆå¸§è¢«åˆ›å»ºï¼Œéšä¹‹è¿™ä¸ªæ–¹æ³•çš„æ“ä½œæ•°æ ˆä¹Ÿè¢«åˆ›å»ºï¼Œä½†ä¸ºç©ºã€‚ä¸”æœ€å¤§æ·±åº¦åœ¨ç¼–è¯‘æœŸå°±å®šä¹‰å¥½äº†ã€‚</li><li>æ“ä½œæ•°æ ˆ<strong>å¹¶éé‡‡ç”¨è®¿é—®ç´¢å¼•çš„æ–¹å¼æ¥è¿›è¡Œæ•°æ®è®¿é—®</strong>ï¼Œåªèƒ½é€šè¿‡pushå’Œpopæ¥æ“ä½œï¼Œå› ä¸ºå®ƒæ˜¯ä¸ª<strong>æ ˆ</strong>ï¼Œä½†æ˜¯å®ƒæ˜¯ç”±æ•°ç»„å®ç°çš„ã€‚</li><li>Javaè™šæ‹Ÿæœºçš„å±Šæ—¶å¼•æ“æ˜¯åŸºäºæ ˆçš„æ‰§è¡Œå¼•æ“ï¼Œå…¶ä¸­æ ˆæŒ‡çš„å°±æ˜¯æ“ä½œæ•°æ ˆã€‚</li></ul><h4 id="æ ˆé¡¶ç¼“å­˜æŠ€æœ¯-ToS-Top-of-Stack-Cashing">æ ˆé¡¶ç¼“å­˜æŠ€æœ¯(ToS, Top-of-Stack Cashing)</h4><p>åŸºäºæ ˆå¼æ¶æ„çš„è™šæ‹Ÿæœºæ‰€ä½¿ç”¨çš„é›¶åœ°å€æŒ‡ä»¤æ›´åŠ ç´§å‡‘ï¼Œä½†å®Œæˆä¸€é¡¹æ“ä½œçš„æ—¶å€™å¿…ç„¶éœ€è¦ä½¿ç”¨æ›´å¤šçš„å…¥æ ˆå’Œå‡ºæ ˆæ“ä½œï¼Œä½¿å¾—éœ€è¦æ›´å¤šçš„æŒ‡ä»¤åˆ†æ´¾æ¬¡æ•°å’Œå†…å­˜è¯»å†™æ­¤æ—¶ã€‚<br>HotSpot JVMæå‡ºæ ˆé¡¶ç¼“å­˜æŠ€æœ¯(ToS, Top-of-Stack Cashing)ï¼Œ<strong>å°†æ ˆé¡¶å…ƒç´ å…¨éƒ¨ç¼“å­˜åœ¨ç‰©ç†CPUçš„å¯„å­˜å™¨ä¸­ï¼Œä»¥æ­¤é™ä½å¯¹å†…å­˜çš„è¯»å†™æ¬¡æ•°ï¼Œæå‡æ‰§è¡Œå¼•æ“çš„æ‰§è¡Œæ•ˆç‡</strong>ã€‚</p><h4 id="åŠ¨æ€é“¾æ¥">åŠ¨æ€é“¾æ¥</h4><ul><li>æ¯ä¸€ä¸ªæ ˆå¸§å†…éƒ¨éƒ½åŒ…å«ä¸€ä¸ªæŒ‡å‘<strong>è¿è¡Œæ—¶å¸¸é‡æ± </strong>ä¸­<strong>è¯¥æ ˆå¸§æ‰€å±æ–¹æ³•çš„å¼•ç”¨</strong>ã€‚åŒ…å«è¿™ä¸ªå¼•ç”¨çš„ç›®çš„å°±æ˜¯ä¸ºäº†æ”¯æŒå½“å‰æ–¹æ³•çš„ä»£ç èƒ½å¤Ÿå®ç°<strong>åŠ¨æ€é“¾æ¥(Dynamic Linking)</strong>ã€‚æ¯”å¦‚invokedynamicæŒ‡ä»¤</li><li>åœ¨Javaæºæ–‡ä»¶è¢«ç¼–è¯‘åˆ°å­—èŠ‚ç æ–‡ä»¶ä¸­æ—¶ï¼Œæ‰€æœ‰çš„å˜é‡å’Œæ–¹æ³•å¼•ç”¨éƒ½ä½œä¸ºç¬¦å·å¼•ç”¨(Symbolic Reference)ä¿å­˜åœ¨classæ–‡ä»¶çš„å¸¸é‡æ± é‡Œã€‚æ¯”å¦‚ï¼šæè¿°ä¸€ä¸ªæ–¹æ³•è°ƒç”¨å¦å¤–çš„å…¶ä»–æ–¹æ³•æ—¶ï¼Œå°±æ˜¯é€šè¿‡å¸¸é‡æ± ä¸­æŒ‡å‘æ–¹æ³•çš„ç¬¦å·å¼•ç”¨æ¥è¡¨ç¤ºçš„ï¼Œé‚£ä¹ˆ<strong>åŠ¨æ€é“¾æ¥çš„ä½œç”¨å°±æ˜¯ä¸ºäº†å°†è¿™äº›ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºè°ƒç”¨æ–¹æ³•çš„ç›´æ¥å¼•ç”¨</strong>ã€‚<br><img src="https://lqy-blog-pic.oss-cn-shanghai.aliyuncs.com/blogImg/JVM_dataDynamicLinking.jpg" alt=""></li></ul><h4 id="æ–¹æ³•çš„è°ƒç”¨">æ–¹æ³•çš„è°ƒç”¨</h4><p>åœ¨JVMä¸­ï¼Œå°†<strong>ç¬¦å·å¼•ç”¨</strong>è½¬æ¢ä¸ºè°ƒç”¨æ–¹æ³•çš„<strong>ç›´æ¥å¼•ç”¨</strong>ä¸æ–¹æ³•çš„ç»‘å®šæœºåˆ¶ç›¸å…³ã€‚</p><ul><li>é™æ€é“¾æ¥ï¼š<br>å½“ä¸€ä¸ªå­—èŠ‚ç æ–‡ä»¶è¢«è£…è¿›JVMå†…éƒ¨æ—¶ï¼Œå¦‚æœè¢«è°ƒç”¨çš„<strong>ç›®æ ‡æ–¹æ³•åœ¨ç¼–è¯‘æœŸå¯çŸ¥</strong>ï¼Œä¸”è¿è¡ŒæœŸä¿æŒä¸å˜æ—¶ã€‚è¿™ç§æƒ…å†µä¸‹å°†è°ƒç”¨æ–¹æ³•çš„ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ï¼Œç§°ä¹‹ä¸ºé™æ€é“¾æ¥ã€‚</li><li>åŠ¨æ€é“¾æ¥ï¼š<br>å¦‚æœ<strong>è¢«è°ƒç”¨çš„æ–¹æ³•åœ¨ç¼–è¯‘æœŸæ— æ³•è¢«ç¡®å®šä¸‹æ¥</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªèƒ½å¤Ÿåœ¨ç¨‹åºè¿è¡ŒæœŸé—´å°†æ–¹æ³•çš„ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨ï¼Œç”±äºè¿™ç§å¼•ç”¨è½¬æ¢è¿‡ç¨‹å…·å¤‡åŠ¨æ€æ€§ï¼Œå› æ­¤ç§°ä¹‹ä¸ºåŠ¨æ€é“¾æ¥ã€‚</li></ul><hr><p>å¯¹åº”çš„æ–¹æ³•çš„ç»‘å®šæœºåˆ¶ä¸ºï¼šæ—©æœŸç»‘å®š(Early Binding)å’Œæ™šæœŸç»‘å®š(Late Binding)ã€‚ç»‘å®šæ˜¯ä¸€ä¸ªå­—æ®µã€æ–¹æ³•æˆ–è€…ç±»åœ¨ç¬¦å·å¼•ç”¨è¢«æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ï¼Œè¿™ä»…ä»…å‘ç”Ÿä¸€æ¬¡ã€‚</p><ul><li>æ—©æœŸç»‘å®šï¼š<br>å°±æ˜¯æŒ‡è¢«è°ƒç”¨çš„<strong>ç›®æ ‡æ–¹æ³•å¦‚æœåœ¨ç¼–è¯‘æœŸå¯çŸ¥ï¼Œä¸”è¿è¡Œæ—¶ä¿æŒä¸å˜</strong>æ—¶ï¼Œå³å¯å°†è¿™ä¸ªæ–¹æ³•ä¸æ‰€å±çš„ç±»å‹è¿›è¡Œç»‘å®šï¼Œè¿™æ ·ä¸€æ¥ï¼Œç”±äºæ˜ç¡®äº†è¢«è°ƒç”¨çš„ç›®æ ‡æ–¹æ³•ç©¶ç«Ÿæ˜¯å“ªä¸€ä¸ªï¼Œå› æ­¤å°±å¯ä»¥ä½¿ç”¨é™æ€é“¾æ¥çš„æ–¹å¼å°†ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨ã€‚</li><li>æ™šæœŸç»‘å®šï¼š<br>å¦‚æœ<strong>è¢«è°ƒç”¨çš„æ–¹æ³•åœ¨ç¼–è¯‘æœŸæ— æ³•è¢«ç¡®å®šä¸‹æ¥ï¼Œåªèƒ½å¤Ÿåœ¨ç¨‹åºè¿è¡ŒæœŸæ ¹æ®å®é™…çš„ç±»å‹ç»‘å®šç›¸å…³çš„æ–¹æ³•</strong>ï¼Œè¿™ç§ç»‘å®šæ–¹å¼ä¹Ÿå°±è¢«ç§°ä¸ºæ™šæœŸç»‘å®šã€‚</li></ul><h4 id="è™šæ–¹æ³•ä¸éè™šæ–¹æ³•">è™šæ–¹æ³•ä¸éè™šæ–¹æ³•</h4><ul><li>éè™šæ–¹æ³•ï¼š<ul><li>å¦‚æœæ–¹æ³•åœ¨ç¼–è¯‘æœŸå°±ç¡®å®šäº†å…·ä½“çš„è°ƒç”¨ç‰ˆæœ¬ï¼Œè¿™ä¸ªç‰ˆæœ¬åœ¨è¿è¡Œæ—¶æ˜¯ä¸å¯å˜çš„ã€‚</li><li>é™æ€æ–¹æ³•ã€ç§æœ‰æ–¹æ³•ã€finalæ–¹æ³•ã€å®ä¾‹æ„é€ å™¨ã€çˆ¶ç±»æ–¹æ³•ç­‰</li><li>å…¶ä»–æ–¹æ³•ç§°ä¸ºè™šæ–¹æ³•</li></ul></li><li>å­ç±»å¯¹è±¡çš„å¤šæ€æ€§çš„ä½¿ç”¨å‰æï¼š1. ç±»çš„ç»§æ‰¿å…³ç³» 2. æ–¹æ³•çš„é‡å†™</li><li>è™šæ‹Ÿæœºä¸­æä¾›äº†ä¸€ä¸‹å‡ æ¡æ–¹æ³•è°ƒç”¨æŒ‡ä»¤ï¼š<ul><li>æ™®é€šè°ƒç”¨æŒ‡ä»¤ï¼š<ol><li>invokestaticï¼šè°ƒç”¨é™æ€æ–¹æ³•ï¼Œè§£æé˜¶æ®µç¡®å®šå”¯ä¸€æ–¹æ³•ç‰ˆæœ¬</li><li>invokespecialï¼šè°ƒç”¨<init>æ–¹æ³•ã€ç§æœ‰åŠçˆ¶ç±»æ–¹æ³•ï¼Œè§£æé˜¶æ®µç¡®å®šå”¯ä¸€æ–¹æ³•ç‰ˆæœ¬</li><li>invokevirtualï¼šè°ƒç”¨æ‰€æœ‰è™šæ–¹æ³•</li><li>invokeinterfaceï¼šè°ƒç”¨æ¥å£æ–¹æ³•</li></ol></li><li>åŠ¨æ€è°ƒç”¨æŒ‡ä»¤ï¼š<br>5. invokedynamicï¼šåŠ¨æ€è§£æå‡ºéœ€è¦è°ƒç”¨çš„æ–¹æ³•ï¼Œç„¶åæ‰§è¡Œ</li><li>å‰å››æ¡æŒ‡ä»¤å›ºåŒ–åœ¨è™šæ‹Ÿæœºå†…éƒ¨ï¼Œæ–¹æ³•çš„è°ƒç”¨æ‰§è¡Œä¸å¯è®¤ä¸ºå¹²é¢„ï¼Œè€ŒinvokedynamicæŒ‡ä»¤åˆ™æ”¯æŒç”±ç”¨æˆ·ç¡®å®šæ–¹æ³•ç‰ˆæœ¬ï¼Œå…¶ä¸­invokestaticæŒ‡ä»¤å’ŒinvokespecialæŒ‡ä»¤è°ƒç”¨çš„æ–¹æ³•ç§°ä¸ºè™šæ–¹æ³•ï¼Œå…¶ä½™çš„ï¼ˆfinalä¿®é¥°çš„é™¤å¤–ï¼‰ç§°ä¸ºè™šæ–¹æ³•ã€‚</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
          <category> JVM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> JVM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaåŸºç¡€</title>
      <link href="/2020/07/08/Java_Basic/"/>
      <url>/2020/07/08/Java_Basic/</url>
      
        <content type="html"><![CDATA[<hr><blockquote><p>é‡æ–°çœ‹çœ‹JavaåŸºç¡€<br>é¡ºä¾¿éšä¾¿è®°ä¸€äº›åŸºç¡€çš„ä¸œè¥¿ã€‚ã€‚ğŸ˜ƒ</p></blockquote><hr><h2 id="æ•°æ®ç±»å‹">æ•°æ®ç±»å‹</h2><p>åŸºæœ¬ç±»å‹ï¼š4ç§æ•´å‹ã€ä¸¤ç§æµ®ç‚¹ç±»å‹ã€1ä¸­ç”¨äºè¡¨ç¤ºUnicodeç¼–ç çš„å­—ç¬¦å‹charå’Œbooleanå‹</p><ol><li>æ•´å‹ï¼šintã€shortã€longã€byte</li><li>æµ®ç‚¹å‹ï¼šfloatã€double<blockquote><p>æ³¨æ„ï¼šæµ®ç‚¹å‹å­˜åœ¨èˆå…¥è¯¯å·®ï¼Œæœ‰äº›å°æ•°æ— æ³•ç²¾ç¡®è¡¨ç¤ºï¼Œå¦‚æœåœ¨æ•°å€¼è®¡ç®—æ—¶ä¸å…è®¸æœ‰è¯¯å·®ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨BigDecimalç±»</p></blockquote></li><li>charç±»å‹ï¼šç”¨å•å¼•å·æ‹¬èµ·æ¥</li><li>booleanï¼šä¸¤ä¸ªå€¼ï¼štrueå’Œfalse<blockquote><p>åœ¨c++ä¸­ï¼Œå¯ä»¥ä½¿ç”¨æ•°å€¼0è¡¨ç¤ºå¸ƒå°”å€¼falseï¼Œé0ç›¸å½“äºå¸ƒå°”å€¼trueï¼›ä½†Javaä¸­ä¸è¡Œï¼Œç¼–è¯‘ä¸èƒ½é€šè¿‡</p></blockquote></li></ol><h2 id="final">final</h2><ol><li>å…³é”®å­—finalæŒ‡ç¤ºå¸¸é‡ã€‚</li><li>finalè¡¨ç¤ºè¿™ä¸ªå˜é‡åªèƒ½è¢«èµ‹å€¼ä¸€æ¬¡ã€‚ä¸€æ—¦è¢«èµ‹å€¼åï¼Œå°±ä¸èƒ½æ”¹å˜ã€‚</li><li>å¸¸é‡åä¸€èˆ¬ä½¿ç”¨å…¨å¤§å†™ã€‚</li><li>ç±»å¸¸é‡å¯ä»¥ä½¿ç”¨<code>static final</code>æ¥è®¾ç½®ï¼Œå®šä¹‰ä½äºmainæ–¹æ³•å¤–ï¼ŒåŒä¸€ä¸ªç±»ä¸­çš„æ–¹æ³•éƒ½å¯ä»¥ä½¿ç”¨ã€‚</li></ol><h2 id="æšä¸¾ç±»å‹">æšä¸¾ç±»å‹</h2><h2 id="Scannerç±»">Scannerç±»</h2><p>ä»é”®ç›˜è¾“å…¥æ•°æ®ã€‚</p><ol><li>å¯¼åŒ…ï¼š<code>import java.util.Scanner</code></li><li>åˆ›å»ºå¯¹è±¡ï¼š<code>Scanner sc = new Scanner(System.in)</code></li><li>ä½¿ç”¨ï¼šå‚æ•°ç±»å‹ å˜é‡å = sc.æˆå‘˜æ–¹æ³•å<code>   ä»é”®ç›˜è·å–ä¸€ä¸ªintï¼š</code>int num = sc.nextInt()<code>    ä»é”®ç›˜è·å–ä¸€ä¸ªStringï¼š</code>String str = sc.next()`</li></ol><h2 id="ArrayList">ArrayList</h2><ol><li>åˆ›å»ºï¼š<code>ArrayList&lt;E&gt; list = new ArrayList&lt;&gt;();</code>ã€‚Eè¡¨ç¤ºæ³›å‹ã€‚</li><li><code>System.out.print(list)</code>æ‰“å°çš„æ˜¯listçš„å†…å®¹ï¼Œä¸æ˜¯åœ°å€ã€‚</li><li>public boolean add(E e)ï¼šå‘é›†åˆæ·»åŠ å…ƒç´ ï¼Œå‚æ•°ç±»å‹ä¸åˆ›å»ºé›†åˆçš„æ³›å‹ä¸€è‡´ã€‚</li><li>public int size()ï¼šè·å–listé•¿åº¦ã€‚</li><li>public E remove(int index)ï¼šä»é›†åˆåˆ é™¤ç´¢å¼•ä¸ºindexçš„å…ƒç´ ï¼Œè¿”å›è¢«åˆ é™¤çš„å…ƒç´ ã€‚</li><li>public E get(int index)ï¼šè·å–ä¸‹æ ‡ä¸ºindexçš„å…ƒç´ ï¼Œå¹¶è¿”å›è¯¥å…ƒç´ ã€‚</li><li>æ³›å‹åªèƒ½ä¸ºå¼•ç”¨ç±»å‹ï¼Œä¸èƒ½ä¸ºåŸºæœ¬ç±»å‹ã€‚å¿…é¡»ä½¿ç”¨åŸºæœ¬ç±»å‹çš„åŒ…è£…ç±»ã€‚</li></ol><table><thead><tr><th style="text-align:center">åŸºæœ¬ç±»å‹</th><th style="text-align:center">åŒ…è£…ç±»</th></tr></thead><tbody><tr><td style="text-align:center">byte</td><td style="text-align:center">Byte</td></tr><tr><td style="text-align:center">int</td><td style="text-align:center">Integer</td></tr><tr><td style="text-align:center">short</td><td style="text-align:center">Short</td></tr><tr><td style="text-align:center">long</td><td style="text-align:center">Long</td></tr><tr><td style="text-align:center">float</td><td style="text-align:center">Float</td></tr><tr><td style="text-align:center">double</td><td style="text-align:center">Double</td></tr><tr><td style="text-align:center">char</td><td style="text-align:center">Character</td></tr><tr><td style="text-align:center">boolean</td><td style="text-align:center">Boolean</td></tr></tbody></table><h2 id="String">String</h2><ol><li><p>å­—ç¬¦ä¸²çš„æ„é€ æ–¹æ³•</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoString</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>();</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²:&quot;</span> + str1);   <span class="comment">// ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²:</span></span><br><span class="line"></span><br><span class="line">        <span class="type">char</span>[] c = &#123;<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>&#125;;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(c);</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¬¬äºŒä¸ªå­—ç¬¦ä¸²ï¼š&quot;</span> + str2);   <span class="comment">// ç¬¬äºŒä¸ªå­—ç¬¦ä¸²ï¼šABC</span></span><br><span class="line"></span><br><span class="line">        <span class="type">byte</span>[] b = &#123;<span class="number">97</span>, <span class="number">98</span>, <span class="number">99</span>&#125;;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(b);</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¬¬ä¸‰ä¸ªå­—ç¬¦ä¸²ï¼š&quot;</span> + str3);   <span class="comment">// ç¬¬ä¸‰ä¸ªå­—ç¬¦ä¸²ï¼šabc</span></span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">str4</span> <span class="operator">=</span> <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¬¬å››ä¸ªå­—ç¬¦ä¸²ï¼š&quot;</span> + str4);   <span class="comment">// ç¬¬å››ä¸ªå­—ç¬¦ä¸²ï¼šHello</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å­—ç¬¦ä¸²å¸¸é‡æ± <br>ç¨‹åºä¸­ç›´æ¥ç”¨åŒå¼•å·è¡¨ç¤ºçš„å­—ç¬¦ä¸²ï¼Œå°±åœ¨å­—ç¬¦ä¸²æ± ä¸­ã€‚<br>å­—ç¬¦ä¸²å¸¸é‡æ± å­˜åœ¨å †ä¸­ã€‚å› ä¸ºå¼•å·è¡¨ç¤ºçš„å­—ç¬¦ä¸²ï¼Œæ˜¯ä¸èƒ½æ›´æ”¹çš„ï¼Œç›¸å½“äºä¸€ä¸ªå¸¸é‡ã€‚è€Œé€šè¿‡å­—ç¬¦æ•°ç»„ï¼ˆæˆ–è€…å­—èŠ‚æ•°ç»„ï¼‰åˆ›å»ºçš„å­—ç¬¦ä¸²çš„å†…å®¹ï¼Œæ ¹æ®å­—ç¬¦æ•°ç»„çš„æ”¹å˜è€Œæ”¹å˜ï¼Œå®ƒå­˜çš„åœ°å€æ˜¯æ•°ç»„åœ°å€ã€‚</p><blockquote><p>å¯¹äºåŸºæœ¬ç±»å‹æ¥è¯´ï¼Œ== æ˜¯è¿›è¡Œ<em><strong>æ•°å€¼</strong></em>çš„æ¯”è¾ƒï¼›<br>å¯¹äºå¼•ç”¨ç±»å‹æ¥è¯´ï¼Œ== æ˜¯è¿›è¡Œ<em><strong>åœ°å€å€¼</strong></em>çš„æ¯”è¾ƒã€‚</p></blockquote> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoStringPool</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str1</span> <span class="operator">=</span> <span class="string">&quot;abc&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str2</span> <span class="operator">=</span> <span class="string">&quot;abc&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">char</span>[] c = &#123;<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>&#125;;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(c);</span><br><span class="line"></span><br><span class="line">        System.out.println(str1 == str2);   <span class="comment">//true</span></span><br><span class="line">        System.out.println(str1 == str3);   <span class="comment">//false</span></span><br><span class="line">        System.out.println(str3 == str2);   <span class="comment">//false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å­—ç¬¦ä¸²å¸¸ç”¨æ–¹æ³•</p></li></ol><ul><li><p>equals<br><code>public boolean equals(object obj)</code>ï¼šå‚æ•°å¯ä»¥æ˜¯ä»»æ„å¯¹è±¡ï¼Œåªæœ‰å‚æ•°ä¸ºå­—ç¬¦ä¸²å¹¶ä¸”å†…å®¹æƒ³åˆ°æ‰è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚</p>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoStringEquals</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str1</span> <span class="operator">=</span> <span class="string">&quot;LeLe&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str2</span> <span class="operator">=</span> <span class="string">&quot;LeLe&quot;</span>;</span><br><span class="line">        <span class="type">char</span>[] c = &#123;<span class="string">&#x27;L&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;L&#x27;</span>,<span class="string">&#x27;e&#x27;</span>&#125;;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(c);</span><br><span class="line">        <span class="type">String</span> <span class="variable">str4</span> <span class="operator">=</span> <span class="string">&quot;lele&quot;</span>;</span><br><span class="line"></span><br><span class="line">        System.out.println(str1.equals(str2));  <span class="comment">//true</span></span><br><span class="line">        System.out.println(str2.equals(str3));  <span class="comment">//true</span></span><br><span class="line">        System.out.println(str1.equals(str3));  <span class="comment">//true</span></span><br><span class="line">        System.out.println(str1.equals(str4));  <span class="comment">//false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>equalsIgnoreCase<br><code>public boolean equalsIgnoreCase(String str)</code>ï¼šå¿½ç•¥å¤§å°å†™ï¼Œæ¯”è¾ƒå†…å®¹ã€‚<br>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼š<br><code>System.out.println(str1.equalsIgnoreCase(str4));    // true</code></p></li><li><p>length<br><code>str1.length()</code>ï¼šè·å–å­—ç¬¦ä¸²å­—ç¬¦ä¸ªæ•°ã€‚</p></li><li><p>concat<br><code>public String concat(String str)</code>ï¼šå°†å½“å‰å­—ç¬¦ä¸²å’Œå‚æ•°å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œå¹¶è¿”å›æ–°çš„å­—ç¬¦ä¸²ã€‚</p></li><li><p>charAt<br><code>public char charAt(int index)</code>ï¼šè·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„å•ä¸ªå­—ç¬¦ã€‚ç´¢å¼•ä»0å¼€å§‹ã€‚</p></li><li><p>indexOf<br><code>public int indexOf(String str)</code>ï¼šæŸ¥æ‰¾å‚æ•°å­—ç¬¦ä¸²åœ¨æœ¬å­—ç¬¦ä¸²å½“ä¸­é¦–æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰ï¼Œè¿”å›-1ã€‚<br><strong>ä¸Šé¢å››ä¸ªæ–¹æ³•çš„ç¤ºä¾‹å¦‚ä¸‹ï¼š</strong></p>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoStringGet</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str1</span> <span class="operator">=</span> <span class="string">&quot;LeLe&quot;</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;str1çš„é•¿åº¦ä¸ºï¼š&quot;</span> + str1.length());    <span class="comment">// str1çš„é•¿åº¦ä¸ºï¼š4</span></span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">str2</span> <span class="operator">=</span> <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;str1 + str2ä¸ºï¼š&quot;</span> + str1.concat(str2));    <span class="comment">// str1 + str2ä¸ºï¼šLeLeHello</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;str2çš„ç¬¬3ä¸ªå­—ç¬¦ä¸ºï¼š&quot;</span> + str2.charAt(<span class="number">1</span>));    <span class="comment">// str2çš„ç¬¬3ä¸ªå­—ç¬¦ä¸ºï¼še</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Leåœ¨str1ä¸­é¦–æ¬¡å‡ºç°çš„ç´¢å¼•ä¸º:&quot;</span> + str1.indexOf(<span class="string">&quot;Le&quot;</span>));   <span class="comment">// Leåœ¨str1ä¸­é¦–æ¬¡å‡ºç°çš„ç´¢å¼•ä¸º:0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>substring<br><code>public String substring(int index):</code>ï¼šæˆªå–ä»å‚æ•°ä½ç½®ä¸€ç›´åˆ°å­—ç¬¦ä¸²ç»“å°¾ã€‚è¿”å›æ–°å­—ç¬¦ä¸²ã€‚<br><code>public String substring(int begin, int end)</code>ï¼šæˆªå–ä»beginåˆ°endä¸­é—´çš„å­—ç¬¦ä¸²ã€‚<strong>å·¦é—­å³å¼€[begin,end)</strong></p>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoSubString</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str1</span> <span class="operator">=</span> <span class="string">&quot;Hello,LeLe&quot;</span>;</span><br><span class="line"></span><br><span class="line">        System.out.println(str1.substring(<span class="number">6</span>));  <span class="comment">// LeLe</span></span><br><span class="line">        System.out.println(str1.substring(<span class="number">0</span>,<span class="number">5</span>));    <span class="comment">// Hello</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>toCharArray<br><code>public char[] toCharArray()</code>ï¼šå°†å½“å‰å­—ç¬¦ä¸²æ‹†åˆ†æˆå­—ç¬¦æ•°ç»„ä½œä¸ºè¿”å›å€¼ã€‚</p></li><li><p>getBytes<br><code>public byte[] getBytes()</code>ï¼šè·å–å½“å‰å­—ç¬¦ä¸²åº•å±‚çš„å­—èŠ‚æ•°ç»„ã€‚</p></li><li><p>replace<br><code>public String replace(CharSequence oldString,CharSequence newString)</code>ï¼šå°†æ‰€æœ‰å‡ºç°çš„è€å­—ç¬¦ä¸²æ›¿æ¢æˆæ–°çš„å­—ç¬¦ä¸²ï¼Œè¿”å›æ›¿æ¢ä¹‹åçš„æ–°çš„å­—ç¬¦ä¸²ã€‚</p>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoStringConvert</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str1</span> <span class="operator">=</span> <span class="string">&quot;LeLe&quot;</span>;</span><br><span class="line">        <span class="type">char</span>[] c = str1.toCharArray();</span><br><span class="line">        System.out.println(c[<span class="number">1</span>]);   <span class="comment">// e</span></span><br><span class="line"></span><br><span class="line">        <span class="type">byte</span>[] b = str1.getBytes();</span><br><span class="line">        System.out.println(b[<span class="number">2</span>]);   <span class="comment">// 76</span></span><br><span class="line"></span><br><span class="line">        System.out.println(str1.replace(<span class="string">&quot;Le&quot;</span>, <span class="string">&quot;Ba&quot;</span>));</span><br><span class="line">        <span class="comment">// BaBa</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>split<br><code>public String[] split(String regex)</code>ï¼šæŒ‰ç…§å‚æ•°çš„è§„åˆ™ï¼Œå°†å­—ç¬¦ä¸²åˆ‡åˆ†æˆè‹¥å¹²éƒ¨åˆ†ã€‚</p>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoStringSplit</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str1</span> <span class="operator">=</span> <span class="string">&quot;Hello,LeLe,HaHa,Zhang San&quot;</span>;</span><br><span class="line">        String[] array1 = str1.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; array1.length; i++) &#123;</span><br><span class="line">            System.out.println(array1[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Hello</span></span><br><span class="line">        <span class="comment">// LeLe</span></span><br><span class="line">        <span class="comment">// HaHa</span></span><br><span class="line">        <span class="comment">// Zhang San</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šsplitæ–¹æ³•çš„å‚æ•°å…¶å®æ˜¯ä¸€ä¸ª<strong>æ­£åˆ™è¡¨è¾¾å¼</strong>ã€‚éœ€è¦æ³¨æ„è½¬ä¹‰ã€‚å¦‚æŒ‰ç…§è‹±æ–‡å¥ç‚¹&quot;.â€œæ¥åˆ‡åˆ†ï¼Œå¿…é¡»å†™â€ \\. &quot;</p></blockquote></li></ul><ol start="4"><li>æ‹¼æ¥ï¼š<ul><li>å¯ä»¥ç›´æ¥ä½¿ç”¨ â€œ+â€å· å°†ä¸¤ä¸ªå­—ç¬¦ä¸²è¿›è¡Œæ‹¼æ¥ï¼›</li><li>å­—ç¬¦ä¸²ä¸éå­—ç¬¦ä¸²ç”¨â€œ+â€å·æ‹¼æ¥æ—¶ï¼Œéå­—ç¬¦ä¼šè¢«è½¬æˆå­—ç¬¦ä¸²ï¼Œè¾“å‡ºä¸­å¸¸ç”¨</li><li>å¤šä¸ªå­—ç¬¦ä¸²æ‹¼æ¥å¯ä»¥ä½¿ç”¨joinæ–¹æ³•ï¼š<code>String s = String.join(&quot;/&quot;,&quot;good&quot;,&quot;bad&quot;,&quot;haha&quot;) // good/bad/haha</code></li></ul></li><li>ä¸å¯å˜å­—ç¬¦ä¸²ï¼šStringç±»æ²¡æœ‰æä¾›ä¿®æ”¹å­—ç¬¦ä¸²çš„æ–¹æ³•ï¼Œåœ¨Javaä¸­ï¼Œå­—ç¬¦ä¸²ç›¸å½“äºå­˜æ”¾åœ¨ä¸€ä¸ªå…¬å…±çš„å­˜å‚¨æ± ä¸­ï¼Œå­—ç¬¦ä¸²å˜é‡æŒ‡å‘å­˜å‚¨æ± ä¸­ç›¸åº”çš„ä½ç½®ï¼Œç¼–è¯‘æœŸå¯ä»¥è®©å­—ç¬¦ä¸²å…±äº«ã€‚å½“å­—ç¬¦ä¸²å˜é‡ä¸ä½¿ç”¨åï¼ŒJavaä¼šè¿›è¡Œåƒåœ¾å›æ”¶ã€‚</li><li>ç©ºä¸²ä¸nullï¼šç©ºä¸²æ˜¯é•¿åº¦ä¸º0ï¼Œå†…å®¹ä¸ºç©ºçš„å­—ç¬¦ä¸²ï¼Œåˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºï¼š<code>if(str.length() == 0)</code>æˆ–è€…<code>if(str.equals(&quot;&quot;))</code>ï¼›nullè¡¨ç¤ºæ²¡æœ‰ä»»ä½•å¯¹è±¡ä¸è¯¥å˜é‡å…³è”ï¼Œåˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ä¸ºnullï¼š<code>if(str == null)</code></li><li>å­—ç¬¦ä¸²çš„æ„å»ºï¼šç”±è¾ƒçŸ­çš„å­—ç¬¦ä¸²æ„å»ºå­—ç¬¦ä¸²æ—¶ï¼Œé‡‡ç”¨å­—ç¬¦ä¸²è¿æ¥çš„æ–¹å¼æ•ˆç‡æ¯”è¾ƒåœ°ä¸‹ã€‚æ¯æ¬¡è¿æ¥å­—ç¬¦ä¸²ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„Stringå¯¹è±¡ï¼Œè€—æ—¶è€—ç©ºé—´ã€‚å› æ­¤å¯ä»¥ä½¿ç”¨StringBuilderç±»ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">public</span> String <span class="title function_">implicit</span><span class="params">(String[] fields)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">res</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; fields.length; i++) &#123;</span><br><span class="line">            res += fields[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">explicit</span><span class="params">(String[] fields)</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">res</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; fields.length; i++) &#123;</span><br><span class="line">            res.append(fields[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä¸Šé¢ä¸¤ä¸ªæ–¹æ³•å„è‡ªå®ç°äº†å­—ç¬¦ä¸²çš„æ‹¼æ¥ï¼Œæˆ‘ä»¬é€šè¿‡ç¼–è¯‘ï¼Œå¾—åˆ°å­—èŠ‚ç ï¼Œå¦‚ä¸‹å›¾ï¼š<br><img src="https://lqy-blog-pic.oss-cn-shanghai.aliyuncs.com/blogImg/datastringBuilderTest01.jpg" alt=""><br>å­—èŠ‚ç çš„8-35è¡Œæ„æˆä¸€ä¸ªå¾ªç¯ä½“ï¼Œå¾ªç¯ä½“å†…newäº†ä¸€ä¸ªStringBuilderå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯æ¬¡å¾ªç¯éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„StringBuilderå¯¹è±¡ã€‚<br><img src="https://lqy-blog-pic.oss-cn-shanghai.aliyuncs.com/blogImg/datastringBuilderTest02.jpg" alt=""><br>è€Œç¬¬äºŒä¸ªæ–¹æ³•ï¼Œå®ƒåªåˆ›å»ºäº†ä¸€ä¸ªStringBuilderå¯¹è±¡ã€‚</p><h2 id="switchè¯­å¥">switchè¯­å¥</h2><ol><li>ç”¨æ³•ï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span>(choice) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>switchè¯­å¥å°†ä»ä¸é€‰é¡¹å€¼åŒ¹é…çš„caseæ ‡ç­¾å¤„å¼€å§‹æ‰§è¡Œï¼Œç›´åˆ°ç¢°åˆ°breakè¯­å¥ï¼Œæˆ–è€…ä¸€ç›´æ‰§è¡Œåˆ°switchè¯­å¥çš„ç»“æŸå¤„ã€‚å¦‚æœæ²¡æœ‰åŒ¹é…çš„caseï¼Œå¹¶æœ‰defaultè¯­å¥ï¼Œå°±æ‰§è¡Œdefaultè¯­å¥</li></ol><blockquote><p><strong>æ³¨æ„</strong>ï¼šå¦‚æœcaseç»“å°¾æ²¡æœ‰breakï¼Œç¨‹åºä¼šç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ªcaseåˆ†æ”¯è¯­å¥</p></blockquote><ol start="3"><li>caseçš„æ ‡ç­¾å¯ä»¥æ˜¯ï¼šcharã€byteã€shortã€intçš„å¸¸é‡è¡¨è¾¾å¼ï¼Œä¹Ÿå¯ä»¥ä¸ºæšä¸¾æˆ–è€…å­—ç¬¦ä¸²å­—é¢é‡</li><li>switchä½¿ç”¨æšä¸¾æ—¶,ä¸å¿…åœ¨æ¯ä¸ªæ ‡ç­¾ä¸­æŒ‡æ˜æšä¸¾åï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Size</span> <span class="variable">sz</span> <span class="operator">=</span> ...;</span><br><span class="line"><span class="keyword">switch</span>(sz) &#123;</span><br><span class="line">    <span class="keyword">case</span> SMALL: <span class="comment">// no need to use Size.SMALL</span></span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤§æ•°å€¼">å¤§æ•°å€¼</h2><ol><li>java.mathåŒ…ä¸­çš„ï¼šBigIntegerå’ŒBigDecimalã€‚è¿™ä¸¤ä¸ªç±»å¯ä»¥å¤„ç†åŒ…å«ä»»æ„é•¿åº¦æ•°å­—åºåˆ—çš„æ•°å€¼ï¼Œå‰è€…å®ç°äº†ä»»æ„ç²¾åº¦çš„æ•´æ•°è¿ç®—ï¼Œåè€…åˆ™å®ç°äº†ä»»æ„ç²¾åº¦çš„æµ®ç‚¹æ•°è®¡ç®—ã€‚</li><li>å¯ä»¥ä½¿ç”¨valueOfæ–¹æ³•å°†æ™®é€šæ•°å€¼è½¬æ¢ä¸ºå¤§æ•°å€¼ï¼š<code>BigInteger num = BigInteger.valueOf(100)</code></li><li>å¤§æ•°å€¼çš„è¿ç®—ä¸èƒ½ä½¿ç”¨ç®—æ•°è¿ç®—ç¬¦ï¼Œéœ€è¦ä½¿ç”¨å¤§æ•°å€¼ç±»ä¸­çš„addã€subtractã€multiplyã€divideã€modæ–¹æ³•</li><li>å¤§æ•°å€¼çš„divideæ–¹æ³•éœ€è¦ç»™å‡ºèˆå…¥æ–¹å¼ï¼ŒRoundingMode.HALF_UPä¸ºå››èˆäº”å…¥</li></ol><h2 id="Arrays-sort">Arrays.sort()</h2><ol><li>é»˜è®¤ä¸ºå‡åºæ’åº</li><li>é‡‡ç”¨äº†åŒåŸºå‡†å¿«æ’(DualPivotQuicksort)ã€‚å¿«æ’é‡‡ç”¨åˆ†æ²»çš„æ€æƒ³ï¼Œç”¨ä¸€ä¸ªpivotå°†åŸæ•°ç»„åˆ†æˆä¸¤ä¸ªå­æ•°ç»„ï¼Œç„¶åé€’å½’ã€‚åŒåŸºå‡†å¿«æ’åˆ™æ˜¯é‡‡ç”¨ä¸¤ä¸ªpivotï¼Œå°†åŸæ•°ç»„åˆ†æˆä¸‰éƒ¨åˆ†ï¼ˆx &lt; pivot1 ; pivot1 &lt;= x &lt;= pivot2 ; x &gt; pivot3ï¼‰,ç„¶åé€’å½’ã€‚</li><li>Arrays.sort()é‡‡ç”¨äº†å¾ˆå¤šæ’åºæ–¹æ³•ï¼Œä¸åŒçš„æƒ…å†µåˆ™ä½¿ç”¨ä¸åŒçš„æ’åºæ–¹æ³•ã€‚æˆ‘ä»¬å‡è®¾åŸæ•°ç»„é•¿åº¦ä¸ºlength<ul><li>length &lt;= 47 ï¼šä½¿ç”¨æ’å…¥æ’åº</li><li>47 &lt; length &lt;= 286 ï¼šä½¿ç”¨å¿«é€Ÿæ’åº</li><li>length &gt; 286 å¹¶ä¸” æ•°ç»„é«˜åº¦ç»“æ„åŒ–(åŸºæœ¬æœ‰åº) ï¼šå½’å¹¶æ’åº</li><li>length &gt; 286 å¹¶ä¸” åŸºæœ¬æ— åºæˆ–é€†åº ï¼š å¿«é€Ÿæ’åº</li></ul></li><li>åŒåŸºå‡†å¿«æ’çš„ç»†èŠ‚ï¼š<ul><li>åœ¨é€‰å–pivotæ—¶ï¼Œé¦–å…ˆé€šè¿‡ä½è¿ç®—ï¼Œè·å–æ•°ç»„é•¿åº¦çš„1/7å·¦å³</li></ul> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Inexpensive approximation of length / 7</span></span><br><span class="line"><span class="type">int</span> <span class="variable">seventh</span> <span class="operator">=</span> (length &gt;&gt; <span class="number">3</span>) + (length &gt;&gt; <span class="number">6</span>) + <span class="number">1</span>;</span><br></pre></td></tr></table></figure><ul><li>ç„¶åé€‰å–æ•°ç»„çš„ä¸­é—´ä½ç½®e3,ä»¥åŠe3å·¦å³1/7ã€2/7çš„ä½ç½®ï¼Œåˆ†åˆ«ä¸ºe1ã€e2å’Œe4ã€e5</li></ul> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Sort five evenly spaced elements around (and including) the</span></span><br><span class="line"><span class="comment"> * center element in the range. These elements will be used for</span></span><br><span class="line"><span class="comment"> * pivot selection as described below. The choice for spacing</span></span><br><span class="line"><span class="comment"> * these elements was empirically determined to work well on</span></span><br><span class="line"><span class="comment"> * a wide variety of inputs.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">e3</span> <span class="operator">=</span> (left + right) &gt;&gt;&gt; <span class="number">1</span>; <span class="comment">// The midpoint</span></span><br><span class="line"><span class="type">int</span> <span class="variable">e2</span> <span class="operator">=</span> e3 - seventh;</span><br><span class="line"><span class="type">int</span> <span class="variable">e1</span> <span class="operator">=</span> e2 - seventh;</span><br><span class="line"><span class="type">int</span> <span class="variable">e4</span> <span class="operator">=</span> e3 + seventh;</span><br><span class="line"><span class="type">int</span> <span class="variable">e5</span> <span class="operator">=</span> e4 + seventh;</span><br></pre></td></tr></table></figure><ul><li>ç„¶åå¯¹5ä¸ªç´¢å¼•è¿›è¡Œæ’åºï¼Œè¿™é‡Œç”¨çš„æ˜¯æ’å…¥æ’åºã€‚æ’å®Œåæ”¾å›5ä¸ªä½ç½®ä¸­</li></ul> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Sort these elements using insertion sort</span></span><br><span class="line"><span class="keyword">if</span> (a[e2] &lt; a[e1]) &#123; <span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> a[e2]; a[e2] = a[e1]; a[e1] = t; &#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> (a[e3] &lt; a[e2]) &#123; <span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> a[e3]; a[e3] = a[e2]; a[e2] = t;</span><br><span class="line">    <span class="keyword">if</span> (t &lt; a[e1]) &#123; a[e2] = a[e1]; a[e1] = t; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (a[e4] &lt; a[e3]) &#123; <span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> a[e4]; a[e4] = a[e3]; a[e3] = t;</span><br><span class="line">    <span class="keyword">if</span> (t &lt; a[e2]) &#123; a[e3] = a[e2]; a[e2] = t;</span><br><span class="line">        <span class="keyword">if</span> (t &lt; a[e1]) &#123; a[e2] = a[e1]; a[e1] = t; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (a[e5] &lt; a[e4]) &#123; <span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> a[e5]; a[e5] = a[e4]; a[e4] = t;</span><br><span class="line">    <span class="keyword">if</span> (t &lt; a[e3]) &#123; a[e4] = a[e3]; a[e3] = t;</span><br><span class="line">        <span class="keyword">if</span> (t &lt; a[e2]) &#123; a[e3] = a[e2]; a[e2] = t;</span><br><span class="line">            <span class="keyword">if</span> (t &lt; a[e1]) &#123; a[e2] = a[e1]; a[e1] = t; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Pointers</span></span><br><span class="line"><span class="type">int</span> <span class="variable">less</span>  <span class="operator">=</span> left;  <span class="comment">// The index of the first element of center part</span></span><br><span class="line"><span class="type">int</span> <span class="variable">great</span> <span class="operator">=</span> right; <span class="comment">// The index before the first element of right part</span></span><br></pre></td></tr></table></figure><ul><li>å¦‚æœ5ä¸ªå…ƒç´ éƒ½ä¸ç›¸åŒï¼Œåˆ™e2ä¸ºpivot1ï¼Œe4ä¸ºpivot3ï¼Œç„¶åç»§ç»­åŒåŸºå‡†å¿«æ’</li><li>å¦‚æœ5ä¸ªå…ƒç´ å­˜åœ¨ç›¸åŒçš„ï¼Œåˆ™ä»¥e3ä¸ºpivotè¿›è¡Œæ™®é€šå¿«æ’</li></ul></li></ol><h2 id=""></h2><h2 id="HashMapï¼ˆå¾…è¡¥å……ï¼‰">HashMapï¼ˆå¾…è¡¥å……ï¼‰</h2><ol><li>åº•å±‚ï¼Ÿ<ul><li>åˆå§‹å¤§å°16ï¼Œé»˜è®¤è´Ÿè½½å› å­0.75ï¼ˆå¯è‡ªå®šä¹‰ï¼‰ï¼Œ12æ—¶æ‰©å®¹ï¼Œæ‰©å®¹ä¸€å€å³32</li><li>HashMapå­˜çš„æ˜¯NodeèŠ‚ç‚¹ï¼ŒNodeèŠ‚ç‚¹é‡ŒåŒ…å«keyå’Œvalue</li><li>HashMapç”±æ•°ç»„+å•å‘é“¾è¡¨</li></ul></li></ol><h2 id="Javaå†…å­˜ç»“æ„æ¦‚è¿°">Javaå†…å­˜ç»“æ„æ¦‚è¿°</h2><ol><li>æ ˆ(Stack): å­˜æ”¾æ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡ã€‚ä¸€æ—¦è¶…å‡ºä½œç”¨åŸŸï¼Œjavaä¼šè‡ªåŠ¨é‡Šæ”¾å®ƒçš„å†…å­˜ç©ºé—´ã€‚</li><li>å †(Heap): å‡¡æ˜¯newå‡ºæ¥çš„ä¸œä¸œï¼ˆå¯¹è±¡ã€æ•°ç»„ç­‰ç­‰ï¼‰ï¼Œéƒ½å­˜æ”¾åœ¨å †ä¸­ã€‚<br>å †ä¸­çš„ä¸œè¥¿éƒ½æœ‰ä¸€ä¸ªå†…å­˜åœ°å€å€¼ï¼ˆ16è¿›åˆ¶ï¼‰ï¼Œä¸”éƒ½æœ‰ä¸€ä¸ªé»˜è®¤åˆå§‹å€¼ã€‚è§„åˆ™å¦‚ä¸‹ï¼š<br>inté»˜è®¤ä¸º0ï¼›doubleé»˜è®¤ä¸º0.0ï¼›å­—ç¬¦é»˜è®¤ä¸ºâ€™\u0000â€™ï¼›å¸ƒå°”é»˜è®¤ä¸ºfalseï¼›å¼•ç”¨ç±»å‹é»˜è®¤ä¸ºnullã€‚<br>å®ä½“ä¸å†è¢«ä½¿ç”¨åï¼Œä¼šåœ¨ä¸ç¡®å®šçš„æ—¶é—´å†…è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚</li><li>æ–¹æ³•åŒº(Method Area)ï¼šåŒ…å«classå’Œstaticå˜é‡ã€‚</li><li>æœ¬åœ°æ–¹æ³•æ ˆ(Native Method Stack)ï¼šä¸æ“ä½œç³»ç»Ÿç›¸å…³ã€‚</li><li>å¯„å­˜å™¨(pc Register)ï¼šCPUç›¸å…³ã€‚CPUè®¿é—®å¯„å­˜å™¨æ‰§è¡Œé€Ÿåº¦è¿œå¤§äºåœ¨ä¸»å­˜ä¸Šçš„æ‰§è¡Œé€Ÿåº¦ã€‚</li></ol><h2 id="é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹å¾">é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹å¾</h2><ol><li><p>å°è£…ï¼šå°†å®ç°çš„ç»†èŠ‚éšè—ï¼Œå¯¹å¤–ç•Œä¸å¯è§ã€‚éœ€è¦çš„æ—¶å€™ç›´æ¥è°ƒç”¨å³å¯ï¼Œä¸éœ€è¦çŸ¥é“å®ç°ç»†èŠ‚ã€‚<br>ï¼ˆ1ï¼‰ æ–¹æ³•å°±æ˜¯ä¸€ç§å°è£…<br>ï¼ˆ2ï¼‰ å…³é”®å­—privateä¹Ÿæ˜¯ä¸€ç§å°è£…ï¼šä½¿ç”¨privateä¿®é¥°åï¼Œåªèƒ½åœ¨ç±»çš„å†…éƒ¨è¿›è¡Œè®¿é—®ã€‚åœ¨æœ¬ç±»èŒƒå›´å¤–åˆ™ä¸èƒ½ç›´æ¥è®¿é—®ï¼Œä¸èƒ½å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚é—´æ¥è®¿é—®staticæˆå‘˜å˜é‡ï¼Œå¯ä»¥å®šä¹‰ä¸€ç»„getter/setteræ–¹æ³•ã€‚</p></li><li><p>ç»§æ‰¿ï¼šå°†å…±æ€§æå–åˆ°çˆ¶ç±»ä¸­ã€‚ç»§æ‰¿æ˜¯å¤šæ€çš„å‰æã€‚<br>Javaæ˜¯<strong>å•ç»§æ‰¿</strong>çš„ã€‚å¯ä»¥<strong>å¤šçº§ç»§æ‰¿</strong>ã€‚</p></li><li><p>å¤šæ€ï¼š</p></li></ol><h2 id="thiså…³é”®å­—">thiså…³é”®å­—</h2><p>æ–¹æ³•çš„å±€éƒ¨å˜é‡å’Œç±»çš„æˆå‘˜å˜é‡é‡åæ—¶ï¼Œä¼šå°±è¿‘ä½¿ç”¨æ–¹æ³•çš„å±€éƒ¨å˜é‡ã€‚å¦‚æœè¦è®¿é—®ç±»çš„æˆå‘˜å˜é‡ï¼Œéœ€è¦ä½¿ç”¨thisã€‚æ ¼å¼ï¼šthis.æˆå‘˜å˜é‡åã€‚</p><blockquote><p>psï¼šè°è°ƒç”¨çš„æ–¹æ³•ï¼Œè°å°±æ˜¯thisã€‚ä¹Ÿå°±æ˜¯å½“å‰çš„å¯¹è±¡ã€‚</p></blockquote><h2 id="æ„é€ æ–¹æ³•">æ„é€ æ–¹æ³•</h2><p>æ„é€ æ–¹æ³•æ˜¯ç”¨æ¥åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•ã€‚ä¸€èˆ¬é€šè¿‡newå…³é”®å­—æ¥åˆ›å»ºå¯¹è±¡æ—¶è°ƒç”¨çš„ã€‚æ ¼å¼ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> ç±»åç§°(å‚æ•°ç±»å‹ å‚æ•°åç§°, ...)&#123;</span><br><span class="line">    æ–¹æ³•ä½“</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨ï¼š</p><ol><li>æ„é€ æ–¹æ³•çš„åç§°å¿…é¡»å’Œç±»åç§°å®Œå…¨ä¸€æ ·ã€‚</li><li>æ„é€ æ–¹æ³•æ— è¿”å›å€¼ã€‚</li><li>å¦‚æœæ— æ„é€ æ–¹æ³•ï¼Œé»˜è®¤ä¸€ä¸ªæ— å‚æ„é€ æ–¹æ³•ï¼Œæ–¹æ³•ä½“å•¥éƒ½ä¸åšã€‚</li><li>æ„é€ æ–¹æ³•å¯ä»¥é‡è½½ï¼ˆæ–¹æ³•åç›¸åŒï¼Œå‚æ•°åˆ—è¡¨ä¸åŒï¼‰ã€‚</li></ol><h2 id="static">static</h2><ol><li>ä½¿ç”¨staticå…³é”®å­—ä¿®é¥°çš„æˆå‘˜å˜é‡ï¼Œä¸å†å±äºå¯¹è±¡è‡ªå·±ï¼Œè€Œæ˜¯å±äºç±»çš„ã€‚æ‰€æœ‰çš„å¯¹è±¡å…±äº«åŒä¸€ä»½ã€‚</li><li>ä½¿ç”¨staticå…³é”®å­—ä¿®é¥°çš„æˆå‘˜æ–¹æ³•ï¼Œå°±æ˜¯é™æ€æ–¹æ³•ï¼Œå®ƒä¸å†å±äºå¯¹è±¡ï¼Œè€Œæ˜¯å±äºç±»çš„ã€‚</li><li>å¦‚æœæ²¡æœ‰staticå…³é”®å­—ï¼Œå¿…é¡»å…ˆåˆ›å»ºå¯¹è±¡ï¼Œç„¶åé€šè¿‡å¯¹è±¡æ¥ä½¿ç”¨ã€‚<br>å¦‚æœæœ‰staticå…³é”®å­—ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ç±»åç§°æ¥ä½¿ç”¨ã€‚<br>æ— è®ºæ˜¯æˆå‘˜å˜é‡è¿˜æ˜¯æˆå‘˜æ–¹æ³•ï¼Œå¦‚æœæœ‰äº†staticå…³é”®å­—ä¿®é¥°ï¼Œéƒ½æ¨èä½¿ç”¨ç±»åç§°è¿›è¡Œä½¿ç”¨ã€‚</li><li>é™æ€ä»£ç å—ï¼šå½“ç¬¬ä¸€æ¬¡ç”¨åˆ°æœ¬ç±»æ—¶ï¼Œé™æ€ä»£ç å¿«æ‰§è¡Œå”¯ä¸€çš„ä¸€æ¬¡ã€‚<br>é™æ€å†…å®¹æ€»æ˜¯ä¼˜å…ˆäºéé™æ€ï¼Œæ‰€ä»¥é™æ€ä»£ç å¿«æ¯”æ„é€ æ–¹æ³•å…ˆæ‰§è¡Œã€‚<br>ä¸€èˆ¬ç”¨æ¥ä¸€æ¬¡æ€§å¯¹é™æ€æˆå‘˜å˜é‡è¿›è¡Œèµ‹å€¼ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> class ç±»åç§°&#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="comment">// é™æ€ä»£ç å—çš„å†…å®¹</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><ol><li>é™æ€ä¸èƒ½ç›´æ¥è®¿é—®éé™æ€ã€‚å› ä¸ºå†…å­˜ä¸­æ˜¯å…ˆæœ‰çš„é™æ€å†…å®¹ï¼Œåæœ‰çš„éé™æ€å†…å®¹ã€‚</li><li>é™æ€æ–¹æ³•ä¸­ä¸èƒ½ä½¿ç”¨thisã€‚thisä»£è¡¨å½“å‰å¯¹è±¡ã€‚</li><li>é™æ€å˜é‡å­˜åœ¨å†…å­˜ä¸­çš„æ–¹æ³•åŒºé‡Œçš„é™æ€åŒºä¸­ã€‚æ ¹æ®ç±»åç§°è®¿é—®é™æ€æˆå‘˜å˜é‡çš„æ—¶å€™ï¼Œå’Œå¯¹è±¡ï¼ˆå­˜åœ¨å†…å­˜çš„å †ä¸­ï¼‰æ²¡å…³ç³»ï¼Œåªå’Œç±»æœ‰å…³ç³»ã€‚</li></ol></blockquote><p>Demo01</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">idCounter</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> String room;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String name, <span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">        <span class="built_in">this</span>.id = ++idCounter;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoStaticField</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Student</span> <span class="variable">one</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="number">20</span>);</span><br><span class="line">        Student.room = <span class="string">&quot;Room 101&quot;</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;id:&quot;</span> + one.getId() + <span class="string">&quot;,name:&quot;</span> + one.getName()</span><br><span class="line">                + <span class="string">&quot;,age:&quot;</span> + one.getAge() + <span class="string">&quot;,room:&quot;</span> + Student.room);</span><br><span class="line"></span><br><span class="line">        <span class="type">Student</span> <span class="variable">two</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å‘†å­&quot;</span>, <span class="number">10</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;id:&quot;</span> + two.getId() + <span class="string">&quot;,name:&quot;</span> + two.getName()</span><br><span class="line">                + <span class="string">&quot;,age:&quot;</span> + two.getAge() + <span class="string">&quot;,room:&quot;</span> + Student.room);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// output:</span></span><br><span class="line">    <span class="comment">//  id:1,name:å¼ ä¸‰,age:20,room:Room 101</span></span><br><span class="line">    <span class="comment">//  id:2,name:å‘†å­,age:10,room:Room 101</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Demo02</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">numStatic</span> <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æˆå‘˜æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸€ä¸ªæ™®é€šçš„æˆå‘˜æ–¹æ³•ã€‚&quot;</span>);</span><br><span class="line">        <span class="comment">// æˆå‘˜æ–¹æ³•å¯ä»¥è®¿é—®æˆå‘˜å˜é‡ï¼Œä¹Ÿå¯ä»¥è®¿é—®é™æ€å˜é‡</span></span><br><span class="line">        System.out.println(num);</span><br><span class="line">        System.out.println(numStatic);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é™æ€æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">methodStatic</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è¿™æ˜¯ä¸€ä¸ªstaticæ–¹æ³•ã€‚&quot;</span>);</span><br><span class="line">        <span class="comment">// é™æ€æ–¹æ³•åªèƒ½è®¿é—®é™æ€å˜é‡</span></span><br><span class="line">        System.out.println(numStatic);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo01StaticField</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">MyClass</span> <span class="variable">obj</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyClass</span>();</span><br><span class="line">        obj.method();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é™æ€æ–¹æ³•å¯ä»¥ä½¿ç”¨å¯¹è±¡åæ¥è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡ç±»åç§°æ¥è°ƒç”¨</span></span><br><span class="line">        obj.methodStatic(); <span class="comment">// ä¸æ¨èï¼Œè¿™ç§å†™æ³•ç¼–è¯‘åä»ä¼šè¢«ç¿»è¯‘æˆâ€œç±»åç§°.é™æ€æ–¹æ³•åâ€</span></span><br><span class="line">        MyClass.methodStatic();  <span class="comment">// æ¨è</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é‡å†™">é‡å†™</h2><ol><li>é‡å†™ï¼šåœ¨ç»§æ‰¿å…³ç³»ä¸­ï¼Œæ–¹æ³•åä¸€æ ·ï¼Œå‚æ•°ä¸€æ ·ã€‚<br>é‡è½½ï¼šæ–¹æ³•åä¸€æ ·ï¼Œå‚æ•°ä¸ä¸€æ ·ã€‚</li><li>@overrideå†™åœ¨æ–¹æ³•å‰ï¼Œæ£€æµ‹æ˜¯å¦æ˜¯æœ‰æ•ˆçš„æ­£ç¡®çš„é‡å†™ã€‚</li></ol><h2 id="çˆ¶å­ç±»æ„é€ æ–¹æ³•çš„è®¿é—®">çˆ¶å­ç±»æ„é€ æ–¹æ³•çš„è®¿é—®</h2><ol><li>å­ç±»æ„é€ æ–¹æ³•ä¸­ï¼Œé»˜è®¤ä¸€ä¸ª<code>super();</code>è°ƒç”¨ï¼Œå¿…é¡»å…ˆè°ƒç”¨çˆ¶ç±»æ„é€ ï¼Œå†è°ƒç”¨å­ç±»æ„é€ ã€‚</li><li>å­ç±»æ„é€ å¯ä»¥é€šè¿‡superå…³é”®å­—æ¥è°ƒç”¨çˆ¶ç±»é‡è½½æ„é€ ã€‚</li><li>superçš„çˆ¶ç±»æ„é€ è°ƒç”¨å¿…é¡»æ˜¯å­ç±»æ„é€ æ–¹æ³•ä¸­çš„ç¬¬ä¸€ä¸ªè¯­å¥ï¼Œä¸”åªèƒ½æœ‰ä¸€ä¸ªsuperè°ƒç”¨ã€‚</li></ol><h2 id="superå…³é”®å­—">superå…³é”®å­—</h2><ol><li>åœ¨å­ç±»æˆå‘˜æ–¹æ³•ä¸­è®¿é—®çˆ¶ç±»çš„æˆå‘˜å˜é‡ã€‚<code>super.xxx</code></li><li>åœ¨å­ç±»çš„æˆå‘˜æ–¹æ³•ä¸­è®¿é—®çˆ¶ç±»çš„æˆå‘˜æ–¹æ³•ã€‚<code>super.xxx()</code></li><li>åœ¨å­ç±»çš„æ„é€ æ–¹æ³•ä¸­è®¿é—®çˆ¶ç±»çš„æ„é€ æ–¹æ³•ã€‚<code>super()</code></li></ol><h2 id="thiså…³é”®å­—-2">thiså…³é”®å­—</h2><ol><li>åœ¨æœ¬ç±»çš„æˆå‘˜æ–¹æ³•ä¸­ï¼Œè®¿é—®æœ¬ç±»çš„æˆå‘˜å˜é‡ã€‚<code>this.xxx</code></li><li>åœ¨æœ¬ç±»çš„æˆå‘˜æ–¹æ³•ä¸­ï¼Œè®¿é—®æœ¬ç±»çš„å¦ä¸€ä¸ªæˆå‘˜æ–¹æ³•ã€‚<code>this.xxx()</code></li><li>åœ¨æœ¬ç±»çš„æ„é€ æ–¹æ³•ä¸­ï¼Œè®¿é—®æœ¬ç±»çš„å¦ä¸€ä¸ªæ„é€ æ–¹æ³•ã€‚<code>this(...)</code></li></ol><blockquote><p>æ³¨æ„ï¼šåœ¨ç¬¬ä¸‰ç§ç”¨æ³•ä¸­ï¼Œ<code>this(...)</code>è°ƒç”¨å¿…é¡»ä¹Ÿæ˜¯æ„é€ æ–¹æ³•çš„ç¬¬ä¸€ä¸ªä¸”å”¯ä¸€çš„è¯­å¥ã€‚superå’Œthisä¸¤ç§æ„é€ è°ƒç”¨ï¼Œä¸èƒ½åŒæ—¶ä½¿ç”¨ã€‚</p></blockquote><h2 id="æŠ½è±¡ç±»">æŠ½è±¡ç±»</h2><ol><li>æŠ½è±¡ç±»ä¸èƒ½åˆ›å»ºå¯¹è±¡ã€‚</li><li>æŠ½è±¡ç±»å¯ä»¥æœ‰æ„é€ æ–¹æ³•ï¼Œæ˜¯ä¾›å­ç±»åˆ›å»ºå¯¹è±¡æ—¶ï¼Œåˆå§‹åŒ–çˆ¶ç±»æˆå‘˜ä½¿ç”¨çš„ã€‚</li><li>æŠ½è±¡ç±»ä¸ä¸€å®šåŒ…å«æŠ½è±¡æ–¹æ³•ï¼Œæœ‰æŠ½è±¡æ–¹æ³•ä¸€å®šæ˜¯æŠ½è±¡ç±»ã€‚</li><li>æŠ½è±¡ç±»çš„å­ç±»ï¼Œå¿…é¡»é‡å†™æŠ½è±¡çˆ¶ç±»ä¸­æ‰€æœ‰çš„æŠ½è±¡æ–¹æ³•ã€‚</li></ol><h2 id="æ¥å£">æ¥å£</h2><ul><li>æ¥å£æ²¡æœ‰é™æ€ä»£ç å—æˆ–è€…æ„é€ æ–¹æ³•ã€‚</li><li>ä¸€ä¸ªç±»çš„ç›´æ¥çˆ¶ç±»æ˜¯å”¯ä¸€çš„ï¼Œå•ä¸€ä¸ªç±»å¯ä»¥åŒæ—¶å®ç°å¤šä¸ªæ¥å£ã€‚</li><li>å¦‚æœå®ç°ç±»æ‰€å®ç°çš„å¤šä¸ªæ¥å£ä¸­ï¼Œå­˜åœ¨é‡å¤çš„æŠ½è±¡æ–¹æ³•ï¼Œåªéœ€è¦è¦†ç›–é‡å†™ä¸€æ¬¡å³å¯ã€‚</li><li>å¦‚æœå®ç°ç±»æ²¡æœ‰è¦†ç›–é‡å†™æ‰€æœ‰æ¥å£çš„æ‰€æœ‰æŠ½è±¡æ–¹æ³•ï¼Œé‚£ä¹ˆå®ç°ç±»å¿…é¡»ä¸ºä¸€ä¸ªæŠ½è±¡ç±»ã€‚</li><li>å¦‚æœå®ç°ç±»æ‰€å®ç°çš„å¤šä¸ªæ¥å£ä¸­ï¼Œå­˜åœ¨é‡å¤çš„é»˜è®¤æ–¹æ³•ï¼Œé‚£ä¹ˆå®ç°ç±»ä¸€å®šè¦å¯¹å†²çªçš„é»˜è®¤æ–¹æ³•è¿›è¡Œè¦†ç›–é‡å†™ã€‚</li><li>ä¸€ä¸ªç±»å¦‚æœçˆ¶ç±»ä¸­çš„æ–¹æ³•ï¼Œå’Œæ¥å£ä¸­çš„é»˜è®¤æ–¹æ³•äº§ç”Ÿå†²çªï¼Œä¼˜å…ˆç”¨çˆ¶ç±»å½“ä¸­çš„æ–¹æ³•ã€‚</li></ul><h3 id="æˆå‘˜å˜é‡">æˆå‘˜å˜é‡</h3><p>æ ¼å¼ï¼š <code>[public] [static] [final] æ•°æ®ç±»å‹ å¸¸é‡åç§° = æ•°æ®å€¼;</code></p><blockquote><p>å¸¸é‡å¿…é¡»è¿›è¡Œèµ‹å€¼ï¼Œä¸€æ—¦èµ‹å€¼ï¼Œä¸èƒ½æ”¹å˜ã€‚<br>å¸¸é‡å‘½åå»ºè®®å…¨å¤§å†™ï¼Œç”¨ä¸‹åˆ’çº¿åˆ†éš”ã€‚</p></blockquote><h3 id="æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•">æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•</h3><p>æ ¼å¼ï¼š  <code>[public] [abstract] è¿”å›å€¼ç±»å‹ æ–¹æ³•åç§°(å‚æ•°åˆ—è¡¨);</code></p><blockquote><p>å®ç°ç±»å¿…é¡»è¦†ç›–é‡å†™æ¥å£æ‰€æœ‰çš„æŠ½è±¡æ–¹æ³•ï¼Œé™¤éå®ç°ç±»ä¹Ÿæ˜¯æŠ½è±¡ç±»ã€‚</p></blockquote><h3 id="æ¥å£çš„é»˜è®¤æ–¹æ³•">æ¥å£çš„é»˜è®¤æ–¹æ³•</h3><p>æ ¼å¼ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">public</span>] <span class="keyword">default</span> è¿”å›å€¼ç±»å‹ æ–¹æ³•åç§°(å‚æ•°åˆ—è¡¨)&#123;</span><br><span class="line">    æ–¹æ³•ä½“</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><ol><li>æ¥å£ä¸­çš„é»˜è®¤æ–¹æ³•ï¼Œå¯ä»¥è§£å†³æ¥å£å‡çº§çš„é—®é¢˜ã€‚å¦‚æœæ¥å£éœ€è¦æ·»åŠ ä¸€ä¸ªæ–°çš„æŠ½è±¡æ–¹æ³•ï¼Œä½†ä¸èƒ½å½±å“ä»¥åŠè¿è¡Œçš„å®ç°ç±»ï¼Œåˆ™å¯ä»¥ä½¿ç”¨é»˜è®¤æ–¹æ³•ã€‚</li><li>æ¥å£çš„é»˜è®¤æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡æ¥å£å®ç°ç±»çš„å¯¹è±¡ç›´æ¥è°ƒç”¨ã€‚</li><li>æ¥å£çš„é»˜è®¤æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥è¢«æ¥å£å®ç°ç±»è¿›è¡Œè¦†ç›–é‡å†™ã€‚</li></ol></blockquote><h3 id="æ¥å£çš„é™æ€æ–¹æ³•">æ¥å£çš„é™æ€æ–¹æ³•</h3><p>æ ¼å¼ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> è¿”å›å€¼ç±»å‹ æ–¹æ³•åç§°(å‚æ•°åˆ—è¡¨)&#123;</span><br><span class="line">    æ–¹æ³•ä½“</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>é™æ€æ–¹æ³•ä¸èƒ½é€šè¿‡æ¥å£å®ç°ç±»çš„å¯¹è±¡æ¥è°ƒç”¨ï¼Œå¿…é¡»é€šè¿‡æ¥å£åç§°æ¥è°ƒç”¨ã€‚<br>æ ¼å¼ï¼šæ¥å£åç§°.é™æ€æ–¹æ³•å(å‚æ•°);</p></blockquote><h3 id="ç§æœ‰æ–¹æ³•">ç§æœ‰æ–¹æ³•</h3><p>ï¼ˆJava 9ä¹‹åï¼‰æ ¼å¼ï¼š</p><ol><li>æ™®é€šç§æœ‰æ–¹æ³•ï¼š<code>public è¿”å›å€¼ç±»å‹ æ–¹æ³•åç§°(å‚æ•°åˆ—è¡¨) &#123; æ–¹æ³•ä½“ &#125;</code></li><li>é™æ€ç§æœ‰æ–¹æ³•ï¼š<code>public static è¿”å›å€¼ç±»å‹ æ–¹æ³•åç§°(å‚æ•°åˆ—è¡¨) &#123; æ–¹æ³•ä½“ &#125;</code></li></ol><blockquote><p>privateçš„æ–¹æ³•åªæœ‰æ¥å£è‡ªå·±ä½¿ç”¨ã€‚</p></blockquote><h2 id="Iteratorè¿­ä»£å™¨">Iteratorè¿­ä»£å™¨</h2><p>å¯¹é›†åˆè¿›è¡Œéå†ã€‚ä¸¤ä¸ªå¸¸ç”¨æ–¹æ³•ï¼š</p><ol><li>boolean hasNext():å¦‚æœä»ç„¶æœ‰å…ƒç´ å¯ä»¥è¿­ä»£ï¼Œåˆ™è¿”å›trueï¼›åˆ¤æ–­é›†åˆæ˜¯å¦è¿˜æœ‰ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œæœ‰åˆ™è¿”å›trueï¼Œæ— åˆ™è¿”å›falseã€‚</li><li>E next():è¿”å›è¿­ä»£çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼›å–å‡ºé›†åˆä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚<br>Iteratoræ˜¯ä¸€ä¸ªæ¥å£ï¼Œæ— æ³•ç›´æ¥ç”¨ï¼Œéœ€è¦ä½¿ç”¨Iteratoræ¥å£çš„å®ç°ç±»å¯¹è±¡ã€‚<br>Collectionæ¥å£ä¸­çš„iterator()æ–¹æ³•ï¼Œè¿”å›çš„å°±æ˜¯è¿­ä»£å™¨çš„å®ç°ç±»å¯¹è±¡<br><code>Iterator&lt;E&gt; iterator()</code> è¿”å›åœ¨æ­¤collectionçš„å…ƒç´ ä¸Šè¿›è¡Œè¿­ä»£çš„è¿­ä»£å™¨ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoIterator</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Collection&lt;String&gt; coll = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        coll.add(<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">        coll.add(<span class="string">&quot;é©¬äº‘&quot;</span>);</span><br><span class="line">        coll.add(<span class="string">&quot;AAA&quot;</span>);</span><br><span class="line">        coll.add(<span class="string">&quot;BBB&quot;</span>);</span><br><span class="line">        Iterator&lt;String&gt; it = coll.iterator();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(it.hasNext())&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">e</span> <span class="operator">=</span> it.next();</span><br><span class="line">            System.out.println(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="foréå†">foréå†</h2><p>ä½¿ç”¨çš„Iteratorè¿­ä»£å™¨ï¼Œå½¢å¼ä¸Šæ˜¯forã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoFor</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        ArrayList&lt;Integer&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) &#123;</span><br><span class="line">            list.add(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i:list) &#123;</span><br><span class="line">            System.out.println(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ³›å‹">æ³›å‹</h2><p>æœªçŸ¥æ•°æ®ç±»å‹ï¼Œå½“åˆ›å»ºå¯¹è±¡æˆ–è€…å…·ä½“ä½¿ç”¨çš„æ—¶å€™ï¼Œå†ç¡®å®šæ³›å‹çš„æ•°æ®ç±»å‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GenericClass</span>&lt;E&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> E name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(E name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoFanxing</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        GenericClass&lt;Integer&gt; gc = <span class="keyword">new</span> <span class="title class_">GenericClass</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        gc.setName(<span class="number">6</span>);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">gcName</span> <span class="operator">=</span> gc.getName();</span><br><span class="line">        System.out.println(gcName); <span class="comment">// 6</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åå°„">åå°„</h2><ul><li>åå°„æœºåˆ¶ï¼šå°†ç±»çš„å„ä¸ªç»„æˆéƒ¨åˆ†å°è£…ä¸ºå…¶ä»–<strong>å¯¹è±¡</strong>ã€‚</li><li>javaä»£ç ç»å†çš„ä¸‰ä¸ªé˜¶æ®µï¼š<ul><li><p>Sourceæºä»£ç é˜¶æ®µ(å­˜åœ¨ç¡¬ç›˜)ï¼šæºç (xxx.java),ç¼–è¯‘åï¼Œå­—èŠ‚ç æ–‡ä»¶(xxx.class)ã€‚å­—èŠ‚ç æ–‡ä»¶å­˜æ”¾æˆå‘˜å˜é‡ã€æ„é€ æ–¹æ³•ã€æˆå‘˜æ–¹æ³•ç­‰ç­‰ã€‚</p></li><li><p>Classç±»å¯¹è±¡é˜¶æ®µï¼šé€šè¿‡ç±»åŠ è½½å™¨(ClassLoader)å°†å­—èŠ‚ç æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­å»ã€‚<br>åœ¨å†…å­˜ä¸­å¦‚ä½•è¡¨è¿°å­—èŠ‚ç æ–‡ä»¶çš„å†…å®¹ï¼ŸClassç±»å¯¹è±¡ã€‚<br>Classç±»å¯¹è±¡åŒ…æ‹¬ç”¨æ¥æè¿°æˆå‘˜å˜é‡ã€æ„é€ æ–¹æ³•ã€æˆå‘˜æ–¹æ³•çš„è‹¥å¹²å¯¹è±¡ã€‚<br>å¦‚æˆå‘˜å˜é‡ï¼Œä½¿ç”¨<code>Field[] fields</code>è¿™æ ·ä¸€ä¸ªæ•°ç»„æ¥è¡¨ç¤ºæ‰€æœ‰çš„æˆå‘˜å˜é‡ã€‚<br>å¦‚æ„é€ æ–¹æ³•ï¼Œä½¿ç”¨<code>Constructor[] cons</code>æ¥è¡¨ç¤ºæ‰€æœ‰çš„æ„é€ å™¨ã€‚<br>æˆå‘˜æ–¹æ³•ï¼Œä½¿ç”¨<code>Method[] methods</code>æ¥è¡¨ç¤ºæ‰€æœ‰æˆå‘˜æ–¹æ³•ã€‚<br>ä¹‹åå¯ä»¥é€šè¿‡Classç±»å¯¹è±¡çš„è¡Œä¸ºï¼Œæ¥newå¯¹è±¡å•Šã€‚ã€‚ç­‰ç­‰</p></li><li><p>Runtimeè¿è¡Œæ—¶é˜¶æ®µ:xxxå¯¹è±¡ï¼Œnew xxx()ã€‚</p></li></ul></li></ul><h3 id="è·å–Classç±»å¯¹è±¡çš„æ–¹å¼">è·å–Classç±»å¯¹è±¡çš„æ–¹å¼</h3><ol><li><p>Class.forName(â€œå…¨ç±»åâ€)ï¼šå°†å­—èŠ‚ç æ–‡ä»¶åŠ è½½è¿›å†…å­˜ï¼Œè¿”å›Classå¯¹è±¡ã€‚</p><ul><li>å¤šç”¨äºé…ç½®æ–‡ä»¶ï¼Œå°†ç±»åå®šä¹‰åœ¨é…ç½®æ–‡ä»¶ä¸­ã€‚è¯»å–æ–‡ä»¶ï¼ŒåŠ è½½ç±»ã€‚</li></ul></li><li><p>ç±»å.classï¼šé€šè¿‡ç±»åçš„å±æ€§classè·å–ã€‚</p><ul><li>å¤šç”¨äºå‚æ•°çš„ä¼ é€’ã€‚</li></ul></li><li><p>å¯¹è±¡.getClass()ï¼šgetClass()æ–¹æ³•åœ¨Objectç±»ä¸­å®šä¹‰ã€‚</p><ul><li>å¤šç”¨äºå¯¹è±¡çš„è·å–å­—èŠ‚ç çš„æ–¹å¼ã€‚</li></ul><p>Demoï¼š</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    </span><br><span class="line">        <span class="comment">// 1. Class.forName(&quot;å…¨ç±»å&quot;)</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">cls1</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.demo.person.Person&quot;</span>);</span><br><span class="line">        System.out.println(cls1);   <span class="comment">// class com.demo.person.Person</span></span><br><span class="line">    </span><br><span class="line">        <span class="comment">// 2. ç±»å.class</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">cls2</span> <span class="operator">=</span> Person.class;</span><br><span class="line">        System.out.println(cls2);   <span class="comment">// class com.demo.person.Person</span></span><br><span class="line">        <span class="comment">// 3. å¯¹è±¡.getClass();</span></span><br><span class="line">        <span class="type">Person</span> <span class="variable">p</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">        <span class="type">Class</span> <span class="variable">cls3</span> <span class="operator">=</span> p.getClass();</span><br><span class="line">        System.out.println(cls3);   <span class="comment">// class com.demo.person.Person</span></span><br><span class="line">    </span><br><span class="line">        <span class="comment">// ==æ¯”è¾ƒä¸‰ä¸ªå¯¹è±¡</span></span><br><span class="line">        System.out.println(cls1==cls2); <span class="comment">// true</span></span><br><span class="line">        System.out.println(cls1==cls3); <span class="comment">// true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><ul><li>ç»“è®ºï¼šåŒä¸€ä¸ªå­—èŠ‚ç æ–‡ä»¶(*.class)åœ¨ä¸€æ¬¡ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œåªè¢«åŠ è½½ä¸€æ¬¡ï¼Œä¸è®ºé€šè¿‡å“ªä¸€ç§æ–¹å¼è·å–çš„Classå¯¹è±¡éƒ½æ˜¯åŒä¸€ä¸ªã€‚</li></ul><h3 id="Classå¯¹è±¡çš„åŠŸèƒ½">Classå¯¹è±¡çš„åŠŸèƒ½</h3><ul><li>è·å–åŠŸèƒ½ï¼š<ol><li><p>è·å–æˆå‘˜å˜é‡</p><ul><li>Field[] getFields()ï¼šè·å–æ‰€æœ‰<strong>public</strong>ä¿®é¥°çš„æˆå‘˜å˜é‡</li><li>Field getField(String name)ï¼šè·å–æŒ‡å®šåç§°çš„<strong>public</strong>ä¿®é¥°çš„æˆå‘˜å˜é‡</li><li>Field[] getDeclaredFields():è·å–æ‰€æœ‰çš„æˆå‘˜å˜é‡ï¼Œä¸è€ƒè™‘ä¿®é¥°ç¬¦</li><li>Field getDeclaredFields(String name)</li><li>Fieldæ“ä½œï¼š<ol><li>è®¾ç½®å€¼ï¼š<code>void set(object obj, boject value)</code></li><li>è·å–å€¼ï¼š<code>get(object obj)</code></li><li>å¿½ç•¥è®¿é—®æƒé™ä¿®é¥°ç¬¦çš„å®‰å…¨æ£€æŸ¥(æš´åŠ›åå°„)ï¼šsetAccessible(true)</li></ol></li></ul><p>personç±»ï¼š</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">public</span> String public_a;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">int</span> protected_b;</span><br><span class="line">    <span class="type">int</span> c;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> private_d;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name, <span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Person&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&quot;, public_a=&#x27;&quot;</span> + public_a + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, protected_b=&quot;</span> + protected_b +</span><br><span class="line">                <span class="string">&quot;, c=&quot;</span> + c +</span><br><span class="line">                <span class="string">&quot;, private_d=&quot;</span> + private_d +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;eating...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">(String food)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;eating...&quot;</span> + food);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Demoï¼š</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectDemo02</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// 0. è·å–person.Classå¯¹è±¡</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">personClass</span> <span class="operator">=</span> Person.class;</span><br><span class="line">        <span class="comment">// 1. Field[] getFields()</span></span><br><span class="line">        Field[] fields = personClass.getFields();</span><br><span class="line">        <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">            System.out.println(field);  <span class="comment">// public int com.demo.classDemo.Person.public_a</span></span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;-----------------&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. Field getField(String name)</span></span><br><span class="line">        <span class="type">Field</span> <span class="variable">a</span> <span class="operator">=</span> personClass.getField(<span class="string">&quot;public_a&quot;</span>);</span><br><span class="line">        <span class="comment">// è·å–æˆå‘˜å˜é‡açš„å€¼</span></span><br><span class="line">        <span class="type">Person</span> <span class="variable">p</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> a.get(p);</span><br><span class="line">        System.out.println(value);  <span class="comment">// null</span></span><br><span class="line">        <span class="comment">// è®¾ç½®å€¼</span></span><br><span class="line">        a.set(p, <span class="string">&quot;å¼ ä¸‰&quot;</span>); <span class="comment">// Person&#123;name=&#x27;null&#x27;, age=0, public_a=&#x27;å¼ ä¸‰&#x27;, protected_b=0, c=0, private_d=0&#125;</span></span><br><span class="line">        System.out.println(p);</span><br><span class="line">        System.out.println(<span class="string">&quot;-------------------&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3.Field[] getDeclaredFields()</span></span><br><span class="line">        Field[] declaredFields = personClass.getDeclaredFields();</span><br><span class="line">        <span class="keyword">for</span>(Field declaredField : declaredFields)&#123;</span><br><span class="line">            System.out.println(declaredField);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        private java.lang.String com.demo.classDemo.Person.name</span></span><br><span class="line"><span class="comment">        private int com.demo.classDemo.Person.age</span></span><br><span class="line"><span class="comment">        ...å…±6ä¸ª...</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="comment">// 4. Field getDeclaredFields(String name)</span></span><br><span class="line">        <span class="type">Field</span> <span class="variable">d</span> <span class="operator">=</span> personClass.getDeclaredField(<span class="string">&quot;private_d&quot;</span>);</span><br><span class="line">        <span class="comment">// å¿½ç•¥è®¿é—®æƒé™ä¿®é¥°ç¬¦çš„å®‰å…¨æ£€æŸ¥ï¼Œå¦åˆ™ä¼šæŠ¥é”™</span></span><br><span class="line">        d.setAccessible(<span class="literal">true</span>);  <span class="comment">// æš´åŠ›åå°„</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">value2</span> <span class="operator">=</span> d.get(p);</span><br><span class="line">        System.out.println(value2); <span class="comment">// 0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>è·å–æ„é€ æ–¹æ³•</p><ul><li>Constructor&lt;?&gt;[] getConstructors()</li><li>Constructor&lt;T&gt; getConstructor(ç±»&lt;?&gt;â€¦ parameterTypes)</li><li>Constructor&lt;T&gt; getDeclaredConstructors()</li><li>Constructor<?>[] getDeclaredConstructor(ç±»<?>â€¦ parameterTypes)</li><li>Constructor:æ„é€ æ–¹æ³•<ul><li>åˆ›å»ºå¯¹è±¡ï¼š<code>T newInstance(object... initargs)</code></li></ul></li></ul><p>Demoï¼š</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectDemo03</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">personClass</span> <span class="operator">=</span> Person.class;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Constructor&lt;?&gt;[] getConstructors()</span></span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor1</span> <span class="operator">=</span> personClass.getConstructor(String.class, <span class="type">int</span>.class);</span><br><span class="line">        System.out.println(constructor1);  <span class="comment">// public com.demo.classDemo.Person(java.lang.String,int)</span></span><br><span class="line">        <span class="comment">// åˆ›å»ºå¯¹è±¡</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">person</span> <span class="operator">=</span> constructor1.newInstance(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="number">18</span>);</span><br><span class="line">        System.out.println(person); <span class="comment">// Person&#123;name=&#x27;å¼ ä¸‰&#x27;, age=18, public_a=&#x27;null&#x27;, protected_b=0, c=0, private_d=0&#125;</span></span><br><span class="line">        System.out.println(<span class="string">&quot;---------------------&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>è·å–æˆå‘˜æ–¹æ³•</p><ul><li>Method[] getMethods()</li><li>Method getMethod(String name, ç±»&lt;?&gt;â€¦ parameterTypes)</li><li>Method[] getDeclaredMethods()</li><li>Method getDeclaredMethod(String name, ç±»&lt;?&gt;â€¦ parameterTypes)</li><li>Method:æ–¹æ³•å¯¹è±¡<ul><li>æ‰§è¡Œæ–¹æ³•:<code>object invoke(object obj, object...args)</code></li><li>è·å–æ–¹æ³•åç§°:<code>String getName</code></li></ul></li></ul><p>Demo:</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectDemo04</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">personClass</span> <span class="operator">=</span> Person.class;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å–æŒ‡å®šåç§°çš„æ–¹æ³•</span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">eat_method</span> <span class="operator">=</span> personClass.getMethod(<span class="string">&quot;eat&quot;</span>);</span><br><span class="line">        <span class="type">Person</span> <span class="variable">p</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">        <span class="comment">// æ‰§è¡Œæ–¹æ³•</span></span><br><span class="line">        eat_method.invoke(p);   <span class="comment">// eating...</span></span><br><span class="line"></span><br><span class="line">        <span class="type">Method</span> <span class="variable">eat_method2</span> <span class="operator">=</span> personClass.getMethod(<span class="string">&quot;eat&quot;</span>, String.class);</span><br><span class="line">        eat_method2.invoke(p,<span class="string">&quot;apple&quot;</span>);  <span class="comment">// eating...apple</span></span><br><span class="line">        System.out.println(<span class="string">&quot;----------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–æ‰€æœ‰publicä¿®é¥°çš„æ–¹æ³•</span></span><br><span class="line">        Method[] methods = personClass.getMethods();</span><br><span class="line">        <span class="keyword">for</span>(Method method:methods)&#123;</span><br><span class="line">            System.out.println(method); <span class="comment">// é™¤äº†Personçš„æ–¹æ³•ï¼Œè¿˜æœ‰Objecté‡Œçš„æ–¹æ³•</span></span><br><span class="line">        <span class="comment">//method.setAccessible(true);</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>è·å–ç±»å</p><ul><li>String getName()</li></ul></li></ol></li></ul><h3 id="æ¡ˆä¾‹">æ¡ˆä¾‹</h3><ul><li>éœ€æ±‚:å¯ä»¥åˆ›å»ºä»»æ„ç±»çš„å¯¹è±¡ï¼Œå¹¶ä¸”æ‰§è¡Œå…¶ä¸­ä»»æ„çš„æ–¹æ³•ã€‚</li><li>å®ç°ï¼š<ol><li>é…ç½®æ–‡ä»¶</li><li>åå°„</li></ol></li><li>æ­¥éª¤ï¼š<ol><li>å°†éœ€è¦åˆ›å»ºçš„å¯¹è±¡çš„å…¨ç±»åå’Œéœ€è¦æ‰§è¡Œçš„æ–¹æ³•å®šä¹‰åœ¨é…ç½®æ–‡ä»¶ä¸­</li><li>åœ¨ç¨‹åºä¸­åŠ è½½è¯»å–é…ç½®æ–‡ä»¶</li><li>ä½¿ç”¨åå°„æŠ€æœ¯æ¥åŠ è½½ç±»æ–‡ä»¶è¿›å†…å­˜</li><li>åˆ›å»ºå¯¹è±¡</li><li>æ‰§è¡Œæ–¹æ³•<br>é…ç½®æ–‡ä»¶ï¼ˆpro.propertiesï¼‰ï¼šæ³¨æ„ï¼šé…ç½®æ–‡ä»¶æ”¾åœ¨srcç›®å½•ä¸‹<br><code>className=com.demo.classDemo.Person</code><br><code>methodName=eat</code></li></ol></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            å‰æï¼šä¸èƒ½æ”¹å˜æ”¹ç±»çš„ä»»ä½•ä»£ç ï¼Œå¯ä»¥åˆ›å»ºä»»æ„çš„å¯¹è±¡ï¼Œå¯ä»¥æ‰§è¡Œä»»æ„æ–¹æ³•</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="comment">// 1. åŠ è½½é…ç½®æ–‡ä»¶</span></span><br><span class="line">        <span class="comment">// 1.1 åˆ›å»ºPropertieså¯¹è±¡</span></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">pro</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        <span class="comment">// 1.2 åŠ è½½é…ç½®æ–‡ä»¶ï¼Œè½¬æ¢ä¸ºä¸€ä¸ªé›†åˆ</span></span><br><span class="line">        <span class="comment">// 1.2.1 è·å–classç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶</span></span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">classLoader</span> <span class="operator">=</span> ReflectTest.class.getClassLoader();</span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> classLoader.getResourceAsStream(<span class="string">&quot;pro.properties&quot;</span>);</span><br><span class="line">        pro.load(is);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. è·å–é…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„æ•°æ®</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> pro.getProperty(<span class="string">&quot;className&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">methodName</span> <span class="operator">=</span> pro.getProperty(<span class="string">&quot;methodName&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3.åŠ è½½è¯¥ç±»è¿›å†…å­˜</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">cls</span> <span class="operator">=</span> Class.forName(className);</span><br><span class="line">        <span class="comment">// 4.åˆ›å»ºå¯¹è±¡</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> cls.newInstance();</span><br><span class="line">        <span class="comment">//5.è·å–æ–¹æ³•å¯¹è±¡</span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> cls.getMethod(methodName);</span><br><span class="line">        <span class="comment">//6.æ‰§è¡Œæ–¹æ³•</span></span><br><span class="line">        method.invoke(obj);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ³¨è§£">æ³¨è§£</h2><ul><li><p>æ¦‚å¿µï¼šè¯´æ˜ç¨‹åºçš„ã€‚ç»™è®¡ç®—æœºçœ‹çš„ã€‚</p></li><li><p>ä½¿ç”¨ï¼š<code>@æ³¨è§£åç§°</code></p></li><li><p>åˆ†ç±»ï¼š</p><ol><li>ç”Ÿæˆjavadocæ–‡æ¡£</li><li>ç¼–è¯‘æ£€æŸ¥ï¼ˆå¦‚<code>@Override</code>ï¼‰</li><li>ä»£ç åˆ†æï¼ˆç”¨åå°„ï¼‰</li></ol></li><li><p>JDKä¸­é¢„å®šä¹‰çš„ä¸€äº›æ³¨è§£</p><ul><li><code>@Override</code>:æ£€æµ‹è¢«è¯¥æ³¨è§£æ ‡æ³¨çš„æ–¹æ³•æ˜¯å¦ç»§æ‰¿è‡ªçˆ¶ç±»ï¼ˆæ¥å£ï¼‰çš„</li><li><code>@Deprecated</code>ï¼šè¯¥æ³¨è§£æ ‡æ³¨çš„å†…å®¹è¡¨ç¤ºå·²è¿‡æ—¶</li><li><code>@SuppressWarnings(&quot;all&quot;)</code>ï¼šå‹åˆ¶è­¦å‘Š</li></ul></li><li><p>è‡ªå®šä¹‰æ³¨è§£</p><ul><li>æ ¼å¼ï¼š<ul><li>å…ƒæ³¨è§£</li><li><code>public @interface æ³¨è§£åç§°&#123; å±æ€§åˆ—è¡¨; &#125;</code></li></ul></li><li>æœ¬è´¨ï¼šæ³¨è§£æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ¥å£ï¼Œè¯¥æ¥å£é»˜è®¤ç»§æ‰¿Annotationæ¥å£<br><code>public interface Myanno extends java.lang.annotation.Annotation &#123;&#125;</code></li><li>å±æ€§ï¼šæ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•<ul><li>è¦æ±‚ï¼š<ol><li>å±æ€§çš„è¿”å›å€¼ç±»å‹æœ‰ä»¥ä¸‹å–å€¼<ul><li>åŸºæœ¬æ•°æ®ç±»å‹</li><li>å­—ç¬¦ä¸²</li><li>æšä¸¾</li><li>æ³¨è§£</li><li>ä»¥ä¸Šç±»å‹çš„æ•°ç»„</li></ul></li><li>å®šä¹‰äº†å±æ€§ï¼Œåœ¨ä½¿ç”¨æ—¶éœ€è¦ç»™å±æ€§èµ‹å€¼ã€‚<ul><li>å®šä¹‰å±æ€§æ—¶å¯ä»¥ä½¿ç”¨<strong>default</strong>è®¾ç½®é»˜è®¤å€¼ã€‚</li><li>Ifåªæœ‰ä¸€ä¸ªå±æ€§éœ€è¦èµ‹å€¼ï¼Œå¹¶ä¸”å±æ€§çš„åç§°æ˜¯<strong>value</strong>ï¼Œåˆ™<strong>value</strong>å¯ä»¥çœç•¥ã€‚</li><li>æ•°ç»„èµ‹å€¼æ—¶ï¼Œå€¼ä½¿ç”¨{ }ã€‚å¦‚æœæ•°ç»„ä¸­åªæœ‰ä¸€ä¸ªå€¼ï¼Œå¯çœç•¥{ }ã€‚</li></ul></li></ol></li></ul></li><li>å…ƒæ³¨è§£ï¼šç”¨äºæè¿°æ³¨è§£çš„æ³¨è§£ã€‚<ul><li><code>@Target</code>ï¼šæè¿°æ³¨è§£èƒ½å¤Ÿä½œç”¨çš„ä½ç½®<ul><li>ElementTypeå–å€¼ï¼š<ul><li>TYPEï¼šå¯ä»¥ä½œç”¨äºç±»ä¸Š</li><li>METHODï¼šå¯ä»¥ä½œç”¨äºæ–¹æ³•ä¸Š</li><li>FIELDï¼šå¯ä»¥ä½œç”¨äºæˆå‘˜å˜é‡ä¸Š</li></ul></li></ul></li><li><code>@Retention</code>ï¼šæè¿°æ³¨è§£è¢«ä¿ç•™çš„é˜¶æ®µ<ul><li><code>@Retention(RetentionPolicy.RUNTIME)</code>ï¼šå½“å‰è¢«æè¿°çš„æ³¨è§£ï¼Œä¼šä¿ç•™åˆ°Classå­—èŠ‚ç æ–‡ä»¶ä¸­ï¼Œå¹¶è¢«JVMè¯»å–åˆ°ã€‚</li></ul></li><li><code>@Documented</code>ï¼šæè¿°æ³¨è§£æ˜¯å¦è¢«æŠ½å–åˆ°APIæ–‡æ¡£ä¸­</li><li><code>@Inherited</code>ï¼šæè¿°æ³¨è§£æ˜¯å¦è¢«å­ç±»ç»§æ‰¿</li></ul></li></ul></li><li><p>åœ¨ç¨‹åºä½¿ç”¨ï¼ˆè§£æï¼‰æ³¨è§£ï¼šè·å–æ³¨è§£ä¸­å®šä¹‰çš„å±æ€§å€¼</p><ol><li>è·å–æ³¨è§£å®šä¹‰çš„ä½ç½®ï¼ˆç±»ã€æ–¹æ³•ç­‰ç­‰ï¼‰çš„å¯¹è±¡ã€‚ï¼ˆClassã€Methodã€Fieldï¼‰</li><li>è·å–æŒ‡å®šçš„æ³¨è§£ã€‚<code>getAnnotation(Class)</code></li><li>ä½¿ç”¨æ³¨è§£ä¸­çš„æŠ½è±¡æ–¹æ³•è·å–é…ç½®çš„å±æ€§å€¼ã€‚</li></ol><p>æ³¨è§£ï¼š</p>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line">    </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* æè¿°éœ€è¦æ‰§è¡Œçš„ç±»åå’Œæ–¹æ³•å</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE&#125;)</span> <span class="comment">// ä½œç”¨åœ¨ç±»ä¸Šé¢</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Pro &#123;</span><br><span class="line">    </span><br><span class="line">    String <span class="title function_">className</span><span class="params">()</span>;</span><br><span class="line">    String <span class="title function_">methodName</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Demo:</p>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pro(className = &quot;com.demo.annotation.China&quot;,methodName = &quot;show&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        å‰æï¼šä¸èƒ½æ”¹å˜æ”¹ç±»çš„ä»»ä½•ä»£ç ï¼Œå¯ä»¥åˆ›å»ºä»»æ„çš„å¯¹è±¡ï¼Œå¯ä»¥æ‰§è¡Œä»»æ„æ–¹æ³•</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    </span><br><span class="line">        <span class="comment">// 1. è§£ææ³¨è§£</span></span><br><span class="line">        <span class="comment">// 1.1 è·å–è¯¥ç±»çš„å­—èŠ‚ç æ–‡ä»¶å¯¹è±¡</span></span><br><span class="line">        Class&lt;ReflectTest&gt; reflectTestClass = ReflectTest.class;</span><br><span class="line">        <span class="comment">// 2. è·å–ä¸Šé¢çš„æ³¨è§£å¯¹è±¡</span></span><br><span class="line">        <span class="comment">// åœ¨å†…å­˜ä¸­ç”Ÿæˆäº†ä¸€ä¸ªè¯¥æ³¨è§£æ¥å£çš„å­ç±»å®ç°å¯¹è±¡</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            public class ProImpl implements Pro&#123;</span></span><br><span class="line"><span class="comment">                public String className()&#123;</span></span><br><span class="line"><span class="comment">                    return &quot;com.demo.annotation.China&quot;;</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">                public String methodName()&#123;</span></span><br><span class="line"><span class="comment">                    return &quot;show&quot;;</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="type">Pro</span> <span class="variable">annotation</span> <span class="operator">=</span> reflectTestClass.getAnnotation(Pro.class);</span><br><span class="line">        <span class="comment">// 3. è°ƒç”¨æ³¨è§£å¯¹è±¡ä¸­å®šä¹‰çš„æŠ½è±¡æ–¹æ³•ï¼Œè·å–è¿”å›å€¼</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> annotation.className();</span><br><span class="line">        <span class="type">String</span> <span class="variable">methodName</span> <span class="operator">=</span> annotation.methodName();</span><br><span class="line">        System.out.println(className);  <span class="comment">// com.demo.annotation.China</span></span><br><span class="line">        System.out.println(methodName); <span class="comment">// show</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
          <category> åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> ç¼–ç¨‹åŸºç¡€çŸ¥è¯† </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
